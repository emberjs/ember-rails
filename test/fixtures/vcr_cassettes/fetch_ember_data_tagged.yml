---
http_interactions:
- request:
    method: get
    uri: http://builds.emberjs.com/tags/v1.0.0-beta.1/ember-data.js
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      X-Amz-Id-2:
      - MoSgGW97SSMwyts//ypp9E3+B56nYWen8wKq8CzjeJC8CWqFrVFreHoRH9kG5Rnd
      X-Amz-Request-Id:
      - 68656DC64011384E
      Date:
      - Thu, 31 Oct 2013 20:27:15 GMT
      Last-Modified:
      - Sun, 01 Sep 2013 07:45:26 GMT
      Etag:
      - '"5829a6a7e731efc80e1d5677513e2d24"'
      Content-Type:
      - text/javascript
      Content-Length:
      - '184834'
      Server:
      - AmazonS3
    body:
      encoding: ASCII-8BIT
      string: !binary |-
        Ly8gVmVyc2lvbjogdjEuMC4wLWJldGEuMQovLyBMYXN0IGNvbW1pdDogY2Fm
        YWI5ZCAoMjAxMy0wOS0wMSAwMDo0MjozOSAtMDcwMCkKCgooZnVuY3Rpb24o
        KSB7CnZhciBkZWZpbmUsIHJlcXVpcmVNb2R1bGU7CgooZnVuY3Rpb24oKSB7
        CiAgdmFyIHJlZ2lzdHJ5ID0ge30sIHNlZW4gPSB7fTsKCiAgZGVmaW5lID0g
        ZnVuY3Rpb24obmFtZSwgZGVwcywgY2FsbGJhY2spIHsKICAgIHJlZ2lzdHJ5
        W25hbWVdID0geyBkZXBzOiBkZXBzLCBjYWxsYmFjazogY2FsbGJhY2sgfTsK
        ICB9OwoKICByZXF1aXJlTW9kdWxlID0gZnVuY3Rpb24obmFtZSkgewogICAg
        aWYgKHNlZW5bbmFtZV0pIHsgcmV0dXJuIHNlZW5bbmFtZV07IH0KICAgIHNl
        ZW5bbmFtZV0gPSB7fTsKCiAgICB2YXIgbW9kLCBkZXBzLCBjYWxsYmFjaywg
        cmVpZmllZCAsIGV4cG9ydHM7CgogICAgbW9kID0gcmVnaXN0cnlbbmFtZV07
        CgogICAgaWYgKCFtb2QpIHsKICAgICAgdGhyb3cgbmV3IEVycm9yKCJNb2R1
        bGUgJyIgKyBuYW1lICsgIicgbm90IGZvdW5kLiIpOwogICAgfQoKICAgIGRl
        cHMgPSBtb2QuZGVwczsKICAgIGNhbGxiYWNrID0gbW9kLmNhbGxiYWNrOwog
        ICAgcmVpZmllZCA9IFtdOwogICAgZXhwb3J0czsKCiAgICBmb3IgKHZhciBp
        PTAsIGw9ZGVwcy5sZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgIGlmIChkZXBz
        W2ldID09PSAnZXhwb3J0cycpIHsKICAgICAgICByZWlmaWVkLnB1c2goZXhw
        b3J0cyA9IHt9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZWlmaWVkLnB1
        c2gocmVxdWlyZU1vZHVsZShkZXBzW2ldKSk7CiAgICAgIH0KICAgIH0KCiAg
        ICB2YXIgdmFsdWUgPSBjYWxsYmFjay5hcHBseSh0aGlzLCByZWlmaWVkKTsK
        ICAgIHJldHVybiBzZWVuW25hbWVdID0gZXhwb3J0cyB8fCB2YWx1ZTsKICB9
        Owp9KSgpOwooZnVuY3Rpb24oKSB7CkVtYmVyLlN0cmluZy5wbHVyYWxpemUg
        PSBmdW5jdGlvbih3b3JkKSB7CiAgcmV0dXJuIEVtYmVyLkluZmxlY3Rvci5p
        bmZsZWN0b3IucGx1cmFsaXplKHdvcmQpOwp9OwoKRW1iZXIuU3RyaW5nLnNp
        bmd1bGFyaXplID0gZnVuY3Rpb24od29yZCkgewogIHJldHVybiBFbWJlci5J
        bmZsZWN0b3IuaW5mbGVjdG9yLnNpbmd1bGFyaXplKHdvcmQpOwp9OwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgQkxBTktfUkVHRVggPSAvXlxzKiQv
        OwoKZnVuY3Rpb24gbG9hZFVuY291bnRhYmxlKHJ1bGVzLCB1bmNvdW50YWJs
        ZSkgewogIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSB1bmNvdW50YWJsZS5s
        ZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgcnVsZXMudW5jb3VudGFi
        bGVbdW5jb3VudGFibGVbaV1dID0gdHJ1ZTsKICB9Cn0KCmZ1bmN0aW9uIGxv
        YWRJcnJlZ3VsYXIocnVsZXMsIGlycmVndWxhclBhaXJzKSB7CiAgdmFyIHBh
        aXI7CgogIGZvciAodmFyIGkgPSAwLCBsZW5ndGggPSBpcnJlZ3VsYXJQYWly
        cy5sZW5ndGg7IGkgPCBsZW5ndGg7IGkrKykgewogICAgcGFpciA9IGlycmVn
        dWxhclBhaXJzW2ldOwoKICAgIHJ1bGVzLmlycmVndWxhcltwYWlyWzBdXSA9
        IHBhaXJbMV07CiAgICBydWxlcy5pcnJlZ3VsYXJJbnZlcnNlW3BhaXJbMV1d
        ID0gcGFpclswXTsKICB9Cn0KCmZ1bmN0aW9uIEluZmxlY3RvcihydWxlU2V0
        KSB7CiAgcnVsZVNldCA9IHJ1bGVTZXQgfHwge307CiAgcnVsZVNldC51bmNv
        dW50YWJsZSA9IHJ1bGVTZXQudW5jb3VudGFibGUgfHwge307CiAgcnVsZVNl
        dC5pcnJlZ3VsYXJQYWlycz0gcnVsZVNldC5pcnJlZ3VsYXJQYWlyc3x8IHt9
        OwoKICB2YXIgcnVsZXMgPSB0aGlzLnJ1bGVzID0gewogICAgcGx1cmFsczog
        IHJ1bGVTZXQucGx1cmFscyB8fCBbXSwKICAgIHNpbmd1bGFyOiBydWxlU2V0
        LnNpbmd1bGFyIHx8IFtdLAogICAgaXJyZWd1bGFyOiB7fSwKICAgIGlycmVn
        dWxhckludmVyc2U6IHt9LAogICAgdW5jb3VudGFibGU6IHt9CiAgfTsKCiAg
        bG9hZFVuY291bnRhYmxlKHJ1bGVzLCBydWxlU2V0LnVuY291bnRhYmxlKTsK
        ICBsb2FkSXJyZWd1bGFyKHJ1bGVzLCBydWxlU2V0LmlycmVndWxhclBhaXJz
        KTsKfQoKSW5mbGVjdG9yLnByb3RvdHlwZSA9IHsKICBwbHVyYWxpemU6IGZ1
        bmN0aW9uKHdvcmQpIHsKICAgIHJldHVybiB0aGlzLmluZmxlY3Qod29yZCwg
        dGhpcy5ydWxlcy5wbHVyYWxzKTsKICB9LAoKICBzaW5ndWxhcml6ZTogZnVu
        Y3Rpb24od29yZCkgewogICAgcmV0dXJuIHRoaXMuaW5mbGVjdCh3b3JkLCB0
        aGlzLnJ1bGVzLnNpbmd1bGFyKTsKICB9LAoKICBpbmZsZWN0OiBmdW5jdGlv
        bih3b3JkLCB0eXBlUnVsZXMpIHsKICAgIHZhciBpbmZsZWN0aW9uLCBzdWJz
        dGl0dXRpb24sIHJlc3VsdCwgbG93ZXJjYXNlLCBpc0JsYW5rLAogICAgaXNV
        bmNvdW50YWJsZSwgaXNJcnJlZ3VsYXIsIGlzSXJyZWd1bGFySW52ZXJzZSwg
        cnVsZTsKCiAgICBpc0JsYW5rID0gQkxBTktfUkVHRVgudGVzdCh3b3JkKTsK
        CiAgICBpZiAoaXNCbGFuaykgewogICAgICByZXR1cm4gd29yZDsKICAgIH0K
        CiAgICBsb3dlcmNhc2UgPSB3b3JkLnRvTG93ZXJDYXNlKCk7CgogICAgaXNV
        bmNvdW50YWJsZSA9IHRoaXMucnVsZXMudW5jb3VudGFibGVbbG93ZXJjYXNl
        XTsKCiAgICBpZiAoaXNVbmNvdW50YWJsZSkgewogICAgICByZXR1cm4gd29y
        ZDsKICAgIH0KCiAgICBpc0lycmVndWxhciA9IHRoaXMucnVsZXMuaXJyZWd1
        bGFyW2xvd2VyY2FzZV07CgogICAgaWYgKGlzSXJyZWd1bGFyKSB7CiAgICAg
        IHJldHVybiBpc0lycmVndWxhcjsKICAgIH0KCiAgICBpc0lycmVndWxhcklu
        dmVyc2UgPSB0aGlzLnJ1bGVzLmlycmVndWxhckludmVyc2VbbG93ZXJjYXNl
        XTsKCiAgICBpZiAoaXNJcnJlZ3VsYXJJbnZlcnNlKSB7CiAgICAgIHJldHVy
        biBpc0lycmVndWxhckludmVyc2U7CiAgICB9CgogICAgZm9yICh2YXIgaSA9
        IHR5cGVSdWxlcy5sZW5ndGgsIG1pbiA9IDA7IGkgPiBtaW47IGktLSkgewog
        ICAgICAgaW5mbGVjdGlvbiA9IHR5cGVSdWxlc1tpLTFdOwogICAgICAgcnVs
        ZSA9IGluZmxlY3Rpb25bMF07CgogICAgICBpZiAocnVsZS50ZXN0KHdvcmQp
        KSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgIH0KCiAgICBpbmZsZWN0
        aW9uID0gaW5mbGVjdGlvbiB8fCBbXTsKCiAgICBydWxlID0gaW5mbGVjdGlv
        blswXTsKICAgIHN1YnN0aXR1dGlvbiA9IGluZmxlY3Rpb25bMV07CgogICAg
        cmVzdWx0ID0gd29yZC5yZXBsYWNlKHJ1bGUsIHN1YnN0aXR1dGlvbik7Cgog
        ICAgcmV0dXJuIHJlc3VsdDsKICB9Cn07CgpFbWJlci5JbmZsZWN0b3IgPSBJ
        bmZsZWN0b3I7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7CkVtYmVyLkluZmxl
        Y3Rvci5kZWZhdWx0UnVsZXMgPSB7CiAgcGx1cmFsczogWwogICAgWy8kLywg
        J3MnXSwKICAgIFsvcyQvaSwgJ3MnXSwKICAgIFsvXihheHx0ZXN0KWlzJC9p
        LCAnJDFlcyddLAogICAgWy8ob2N0b3B8dmlyKXVzJC9pLCAnJDFpJ10sCiAg
        ICBbLyhvY3RvcHx2aXIpaSQvaSwgJyQxaSddLAogICAgWy8oYWxpYXN8c3Rh
        dHVzKSQvaSwgJyQxZXMnXSwKICAgIFsvKGJ1KXMkL2ksICckMXNlcyddLAog
        ICAgWy8oYnVmZmFsfHRvbWF0KW8kL2ksICckMW9lcyddLAogICAgWy8oW3Rp
        XSl1bSQvaSwgJyQxYSddLAogICAgWy8oW3RpXSlhJC9pLCAnJDFhJ10sCiAg
        ICBbL3NpcyQvaSwgJ3NlcyddLAogICAgWy8oPzooW15mXSlmZXwoW2xyXSlm
        KSQvaSwgJyQxJDJ2ZXMnXSwKICAgIFsvKGhpdmUpJC9pLCAnJDFzJ10sCiAg
        ICBbLyhbXmFlaW91eV18cXUpeSQvaSwgJyQxaWVzJ10sCiAgICBbLyh4fGNo
        fHNzfHNoKSQvaSwgJyQxZXMnXSwKICAgIFsvKG1hdHJ8dmVydHxpbmQpKD86
        aXh8ZXgpJC9pLCAnJDFpY2VzJ10sCiAgICBbL14obXxsKW91c2UkL2ksICck
        MWljZSddLAogICAgWy9eKG18bClpY2UkL2ksICckMWljZSddLAogICAgWy9e
        KG94KSQvaSwgJyQxZW4nXSwKICAgIFsvXihveGVuKSQvaSwgJyQxJ10sCiAg
        ICBbLyhxdWl6KSQvaSwgJyQxemVzJ10KICBdLAoKICBzaW5ndWxhcjogWwog
        ICAgWy9zJC9pLCAnJ10sCiAgICBbLyhzcykkL2ksICckMSddLAogICAgWy8o
        billd3MkL2ksICckMWV3cyddLAogICAgWy8oW3RpXSlhJC9pLCAnJDF1bSdd
        LAogICAgWy8oKGEpbmFseXwoYilhfChkKWlhZ25vfChwKWFyZW50aGV8KHAp
        cm9nbm98KHMpeW5vcHwodCloZSkoc2lzfHNlcykkL2ksICckMXNpcyddLAog
        ICAgWy8oXmFuYWx5KShzaXN8c2VzKSQvaSwgJyQxc2lzJ10sCiAgICBbLyhb
        XmZdKXZlcyQvaSwgJyQxZmUnXSwKICAgIFsvKGhpdmUpcyQvaSwgJyQxJ10s
        CiAgICBbLyh0aXZlKXMkL2ksICckMSddLAogICAgWy8oW2xyXSl2ZXMkL2ks
        ICckMWYnXSwKICAgIFsvKFteYWVpb3V5XXxxdSlpZXMkL2ksICckMXknXSwK
        ICAgIFsvKHMpZXJpZXMkL2ksICckMWVyaWVzJ10sCiAgICBbLyhtKW92aWVz
        JC9pLCAnJDFvdmllJ10sCiAgICBbLyh4fGNofHNzfHNoKWVzJC9pLCAnJDEn
        XSwKICAgIFsvXihtfGwpaWNlJC9pLCAnJDFvdXNlJ10sCiAgICBbLyhidXMp
        KGVzKT8kL2ksICckMSddLAogICAgWy8obyllcyQvaSwgJyQxJ10sCiAgICBb
        LyhzaG9lKXMkL2ksICckMSddLAogICAgWy8oY3Jpc3x0ZXN0KShpc3xlcykk
        L2ksICckMWlzJ10sCiAgICBbL14oYSl4W2llXXMkL2ksICckMXhpcyddLAog
        ICAgWy8ob2N0b3B8dmlyKSh1c3xpKSQvaSwgJyQxdXMnXSwKICAgIFsvKGFs
        aWFzfHN0YXR1cykoZXMpPyQvaSwgJyQxJ10sCiAgICBbL14ob3gpZW4vaSwg
        JyQxJ10sCiAgICBbLyh2ZXJ0fGluZClpY2VzJC9pLCAnJDFleCddLAogICAg
        Wy8obWF0cilpY2VzJC9pLCAnJDFpeCddLAogICAgWy8ocXVpeil6ZXMkL2ks
        ICckMSddLAogICAgWy8oZGF0YWJhc2UpcyQvaSwgJyQxJ10KICBdLAoKICBp
        cnJlZ3VsYXJQYWlyczogWwogICAgWydwZXJzb24nLCAncGVvcGxlJ10sCiAg
        ICBbJ21hbicsICdtZW4nXSwKICAgIFsnY2hpbGQnLCAnY2hpbGRyZW4nXSwK
        ICAgIFsnc2V4JywgJ3NleGVzJ10sCiAgICBbJ21vdmUnLCAnbW92ZXMnXSwK
        ICAgIFsnY293JywgJ2tpbmUnXSwKICAgIFsnem9tYmllJywgJ3pvbWJpZXMn
        XQogIF0sCgogIHVuY291bnRhYmxlOiBbCiAgICAnZXF1aXBtZW50JywKICAg
        ICdpbmZvcm1hdGlvbicsCiAgICAncmljZScsCiAgICAnbW9uZXknLAogICAg
        J3NwZWNpZXMnLAogICAgJ3NlcmllcycsCiAgICAnZmlzaCcsCiAgICAnc2hl
        ZXAnLAogICAgJ2plYW5zJywKICAgICdwb2xpY2UnCiAgXQp9OwoKfSkoKTsK
        CgoKKGZ1bmN0aW9uKCkgewppZiAoRW1iZXIuRVhURU5EX1BST1RPVFlQRVMp
        IHsNCiAgLyoqDQogICAgU2VlIHt7I2Nyb3NzTGluayAiRW1iZXIuU3RyaW5n
        L3BsdXJhbGl6ZSJ9fXt7L2Nyb3NzTGlua319DQoNCiAgICBAbWV0aG9kIHBs
        dXJhbGl6ZQ0KICAgIEBmb3IgU3RyaW5nDQogICovDQogIFN0cmluZy5wcm90
        b3R5cGUucGx1cmFsaXplID0gZnVuY3Rpb24oKSB7DQogICAgcmV0dXJuIEVt
        YmVyLlN0cmluZy5wbHVyYWxpemUodGhpcyk7DQogIH07DQoNCiAgLyoqDQog
        ICAgU2VlIHt7I2Nyb3NzTGluayAiRW1iZXIuU3RyaW5nL3Npbmd1bGFyaXpl
        In19e3svY3Jvc3NMaW5rfX0NCg0KICAgIEBtZXRob2Qgc2luZ3VsYXJpemUN
        CiAgICBAZm9yIFN0cmluZw0KICAqLw0KICBTdHJpbmcucHJvdG90eXBlLnNp
        bmd1bGFyaXplID0gZnVuY3Rpb24oKSB7DQogICAgcmV0dXJuIEVtYmVyLlN0
        cmluZy5zaW5ndWxhcml6ZSh0aGlzKTsNCiAgfTsNCn0NCgp9KSgpOwoKCgoo
        ZnVuY3Rpb24oKSB7CkVtYmVyLkluZmxlY3Rvci5pbmZsZWN0b3IgPSBuZXcg
        RW1iZXIuSW5mbGVjdG9yKEVtYmVyLkluZmxlY3Rvci5kZWZhdWx0UnVsZXMp
        Ow0KCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKCn0pKCk7CgoKfSkoKTsKLy8g
        VmVyc2lvbjogdjEuMC4wLWJldGEuMQovLyBMYXN0IGNvbW1pdDogY2FmYWI5
        ZCAoMjAxMy0wOS0wMSAwMDo0MjozOSAtMDcwMCkKCgooZnVuY3Rpb24oKSB7
        Ci8qKgogIEBtb2R1bGUgZW1iZXItZGF0YQoqLwoKLyoqCiAgQWxsIEVtYmVy
        IERhdGEgbWV0aG9kcyBhbmQgZnVuY3Rpb25zIGFyZSBkZWZpbmVkIGluc2lk
        ZSBvZiB0aGlzIG5hbWVzcGFjZS4KCiAgQGNsYXNzIERTCiAgQHN0YXRpYwoq
        LwoKaWYgKCd1bmRlZmluZWQnID09PSB0eXBlb2YgRFMpIHsKICBEUyA9IEVt
        YmVyLk5hbWVzcGFjZS5jcmVhdGUoewogICAgVkVSU0lPTjogJzEuMC4wLWJl
        dGEuMScKICB9KTsKCiAgaWYgKCd1bmRlZmluZWQnICE9PSB0eXBlb2Ygd2lu
        ZG93KSB7CiAgICB3aW5kb3cuRFMgPSBEUzsKICB9Cn0KfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewovKioKICBAbW9kdWxlIGVtYmVyLWRhdGEKKi8KCnZhciBp
        c05vbmUgPSBFbWJlci5pc05vbmUsIGlzRW1wdHkgPSBFbWJlci5pc0VtcHR5
        OwoKLyoqCiAgRFMuSlNPTlRyYW5zZm9ybXMgaXMgYSBoYXNoIG9mIHRyYW5z
        Zm9ybXMgdXNlZCBieSBEUy5TZXJpYWxpemVyLgoKICBAY2xhc3MgSlNPTlRy
        YW5zZm9ybXMKICBAc3RhdGljCiAgQG5hbWVzcGFjZSBEUwoqLwpEUy5KU09O
        VHJhbnNmb3JtcyA9IHsKICBzdHJpbmc6IHsKICAgIGRlc2VyaWFsaXplOiBm
        dW5jdGlvbihzZXJpYWxpemVkKSB7CiAgICAgIHJldHVybiBpc05vbmUoc2Vy
        aWFsaXplZCkgPyBudWxsIDogU3RyaW5nKHNlcmlhbGl6ZWQpOwogICAgfSwK
        CiAgICBzZXJpYWxpemU6IGZ1bmN0aW9uKGRlc2VyaWFsaXplZCkgewogICAg
        ICByZXR1cm4gaXNOb25lKGRlc2VyaWFsaXplZCkgPyBudWxsIDogU3RyaW5n
        KGRlc2VyaWFsaXplZCk7CiAgICB9CiAgfSwKCiAgbnVtYmVyOiB7CiAgICBk
        ZXNlcmlhbGl6ZTogZnVuY3Rpb24oc2VyaWFsaXplZCkgewogICAgICByZXR1
        cm4gaXNFbXB0eShzZXJpYWxpemVkKSA/IG51bGwgOiBOdW1iZXIoc2VyaWFs
        aXplZCk7CiAgICB9LAoKICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24oZGVzZXJp
        YWxpemVkKSB7CiAgICAgIHJldHVybiBpc0VtcHR5KGRlc2VyaWFsaXplZCkg
        PyBudWxsIDogTnVtYmVyKGRlc2VyaWFsaXplZCk7CiAgICB9CiAgfSwKCiAg
        Ly8gSGFuZGxlcyB0aGUgZm9sbG93aW5nIGJvb2xlYW4gaW5wdXRzOgogIC8v
        ICJUclVlIiwgInQiLCAiZiIsICJGQUxTRSIsIDAsIChub24temVybyksIG9y
        IGJvb2xlYW4gdHJ1ZS9mYWxzZQogICdib29sZWFuJzogewogICAgZGVzZXJp
        YWxpemU6IGZ1bmN0aW9uKHNlcmlhbGl6ZWQpIHsKICAgICAgdmFyIHR5cGUg
        PSB0eXBlb2Ygc2VyaWFsaXplZDsKCiAgICAgIGlmICh0eXBlID09PSAiYm9v
        bGVhbiIpIHsKICAgICAgICByZXR1cm4gc2VyaWFsaXplZDsKICAgICAgfSBl
        bHNlIGlmICh0eXBlID09PSAic3RyaW5nIikgewogICAgICAgIHJldHVybiBz
        ZXJpYWxpemVkLm1hdGNoKC9edHJ1ZSR8XnQkfF4xJC9pKSAhPT0gbnVsbDsK
        ICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAibnVtYmVyIikgewogICAgICAg
        IHJldHVybiBzZXJpYWxpemVkID09PSAxOwogICAgICB9IGVsc2UgewogICAg
        ICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgfSwKCiAgICBzZXJpYWxp
        emU6IGZ1bmN0aW9uKGRlc2VyaWFsaXplZCkgewogICAgICByZXR1cm4gQm9v
        bGVhbihkZXNlcmlhbGl6ZWQpOwogICAgfQogIH0sCgogIGRhdGU6IHsKICAg
        IGRlc2VyaWFsaXplOiBmdW5jdGlvbihzZXJpYWxpemVkKSB7CiAgICAgIHZh
        ciB0eXBlID0gdHlwZW9mIHNlcmlhbGl6ZWQ7CgogICAgICBpZiAodHlwZSA9
        PT0gInN0cmluZyIpIHsKICAgICAgICByZXR1cm4gbmV3IERhdGUoRW1iZXIu
        RGF0ZS5wYXJzZShzZXJpYWxpemVkKSk7CiAgICAgIH0gZWxzZSBpZiAodHlw
        ZSA9PT0gIm51bWJlciIpIHsKICAgICAgICByZXR1cm4gbmV3IERhdGUoc2Vy
        aWFsaXplZCk7CiAgICAgIH0gZWxzZSBpZiAoc2VyaWFsaXplZCA9PT0gbnVs
        bCB8fCBzZXJpYWxpemVkID09PSB1bmRlZmluZWQpIHsKICAgICAgICAvLyBp
        ZiB0aGUgdmFsdWUgaXMgbm90IHByZXNlbnQgaW4gdGhlIGRhdGEsCiAgICAg
        ICAgLy8gcmV0dXJuIHVuZGVmaW5lZCwgbm90IG51bGwuCiAgICAgICAgcmV0
        dXJuIHNlcmlhbGl6ZWQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0dXJu
        IG51bGw7CiAgICAgIH0KICAgIH0sCgogICAgc2VyaWFsaXplOiBmdW5jdGlv
        bihkYXRlKSB7CiAgICAgIGlmIChkYXRlIGluc3RhbmNlb2YgRGF0ZSkgewog
        ICAgICAgIHZhciBkYXlzID0gWyJTdW4iLCAiTW9uIiwgIlR1ZSIsICJXZWQi
        LCAiVGh1IiwgIkZyaSIsICJTYXQiXTsKICAgICAgICB2YXIgbW9udGhzID0g
        WyJKYW4iLCAiRmViIiwgIk1hciIsICJBcHIiLCAiTWF5IiwgIkp1biIsICJK
        dWwiLCAiQXVnIiwgIlNlcCIsICJPY3QiLCAiTm92IiwgIkRlYyJdOwoKICAg
        ICAgICB2YXIgcGFkID0gZnVuY3Rpb24obnVtKSB7CiAgICAgICAgICByZXR1
        cm4gbnVtIDwgMTAgPyAiMCIrbnVtIDogIiIrbnVtOwogICAgICAgIH07Cgog
        ICAgICAgIHZhciB1dGNZZWFyID0gZGF0ZS5nZXRVVENGdWxsWWVhcigpLAog
        ICAgICAgICAgICB1dGNNb250aCA9IGRhdGUuZ2V0VVRDTW9udGgoKSwKICAg
        ICAgICAgICAgdXRjRGF5T2ZNb250aCA9IGRhdGUuZ2V0VVRDRGF0ZSgpLAog
        ICAgICAgICAgICB1dGNEYXkgPSBkYXRlLmdldFVUQ0RheSgpLAogICAgICAg
        ICAgICB1dGNIb3VycyA9IGRhdGUuZ2V0VVRDSG91cnMoKSwKICAgICAgICAg
        ICAgdXRjTWludXRlcyA9IGRhdGUuZ2V0VVRDTWludXRlcygpLAogICAgICAg
        ICAgICB1dGNTZWNvbmRzID0gZGF0ZS5nZXRVVENTZWNvbmRzKCk7CgoKICAg
        ICAgICB2YXIgZGF5T2ZXZWVrID0gZGF5c1t1dGNEYXldOwogICAgICAgIHZh
        ciBkYXlPZk1vbnRoID0gcGFkKHV0Y0RheU9mTW9udGgpOwogICAgICAgIHZh
        ciBtb250aCA9IG1vbnRoc1t1dGNNb250aF07CgogICAgICAgIHJldHVybiBk
        YXlPZldlZWsgKyAiLCAiICsgZGF5T2ZNb250aCArICIgIiArIG1vbnRoICsg
        IiAiICsgdXRjWWVhciArICIgIiArCiAgICAgICAgICAgICAgIHBhZCh1dGNI
        b3VycykgKyAiOiIgKyBwYWQodXRjTWludXRlcykgKyAiOiIgKyBwYWQodXRj
        U2Vjb25kcykgKyAiIEdNVCI7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcmV0
        dXJuIG51bGw7CiAgICAgIH0KICAgIH0KICB9Cn07Cgp9KSgpOwoKCgooZnVu
        Y3Rpb24oKSB7CnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNl
        dCwgaXNOb25lID0gRW1iZXIuaXNOb25lOwoKdmFyIHRyYW5zZm9ybXMgPSBE
        Uy5KU09OVHJhbnNmb3JtczsKCi8vIFNpbXBsZSBkaXNwYXRjaGVyIHRvIHN1
        cHBvcnQgb3ZlcnJpZGluZyB0aGUgYWxpYXNlZAovLyBtZXRob2QgaW4gc3Vi
        Y2xhc3Nlcy4KZnVuY3Rpb24gYWxpYXNNZXRob2QobWV0aG9kTmFtZSkgewog
        IHJldHVybiBmdW5jdGlvbigpIHsKICAgIHJldHVybiB0aGlzW21ldGhvZE5h
        bWVdLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfTsKfQoKRFMuSlNPTlNl
        cmlhbGl6ZXIgPSBFbWJlci5PYmplY3QuZXh0ZW5kKHsKICBwcmltYXJ5S2V5
        OiAnaWQnLAoKICBkZXNlcmlhbGl6ZTogZnVuY3Rpb24odHlwZSwgZGF0YSkg
        ewogICAgdmFyIHN0b3JlID0gZ2V0KHRoaXMsICdzdG9yZScpOwoKICAgIHR5
        cGUuZWFjaFRyYW5zZm9ybWVkQXR0cmlidXRlKGZ1bmN0aW9uKGtleSwgdHlw
        ZSkgewogICAgICBkYXRhW2tleV0gPSB0cmFuc2Zvcm1zW3R5cGVdLmRlc2Vy
        aWFsaXplKGRhdGFba2V5XSk7CiAgICB9KTsKCiAgICB0eXBlLmVhY2hSZWxh
        dGlvbnNoaXAoZnVuY3Rpb24oa2V5LCByZWxhdGlvbnNoaXApIHsKICAgICAg
        Ly8gQSBsaW5rICh1c3VhbGx5IGEgVVJMKSB3YXMgYWxyZWFkeSBwcm92aWRl
        ZCBpbgogICAgICAvLyBub3JtYWxpemVkIGZvcm0KICAgICAgaWYgKGRhdGEu
        bGlua3MgJiYgZGF0YS5saW5rc1trZXldKSB7CiAgICAgICAgcmV0dXJuOwog
        ICAgICB9CgogICAgICB2YXIgdHlwZSA9IHJlbGF0aW9uc2hpcC50eXBlLAog
        ICAgICAgICAgdmFsdWUgPSBkYXRhW2tleV07CgogICAgICBpZiAodmFsdWUg
        PT0gbnVsbCkgeyByZXR1cm47IH0KCiAgICAgIGlmIChyZWxhdGlvbnNoaXAu
        a2luZCA9PT0gJ2JlbG9uZ3NUbycpIHsKICAgICAgICB0aGlzLmRlc2VyaWFs
        aXplUmVjb3JkSWQoZGF0YSwga2V5LCByZWxhdGlvbnNoaXAsIHZhbHVlKTsK
        ICAgICAgfSBlbHNlIGlmIChyZWxhdGlvbnNoaXAua2luZCA9PT0gJ2hhc01h
        bnknKSB7CiAgICAgICAgdGhpcy5kZXNlcmlhbGl6ZVJlY29yZElkcyhkYXRh
        LCBrZXksIHJlbGF0aW9uc2hpcCwgdmFsdWUpOwogICAgICB9CiAgICB9LCB0
        aGlzKTsKCiAgICByZXR1cm4gZGF0YTsKICB9LAoKICBkZXNlcmlhbGl6ZVJl
        Y29yZElkOiBmdW5jdGlvbihkYXRhLCBrZXksIHJlbGF0aW9uc2hpcCwgaWQp
        IHsKICAgIGlmIChpc05vbmUoaWQpIHx8IGlkIGluc3RhbmNlb2YgRFMuTW9k
        ZWwpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHZhciB0eXBlOwoKICAg
        IGlmICh0eXBlb2YgaWQgPT09ICdudW1iZXInIHx8IHR5cGVvZiBpZCA9PT0g
        J3N0cmluZycpIHsKICAgICAgdHlwZSA9IHRoaXMudHlwZUZvcihyZWxhdGlv
        bnNoaXAsIGtleSwgZGF0YSk7CiAgICAgIGRhdGFba2V5XSA9IGdldCh0aGlz
        LCAnc3RvcmUnKS5yZWNvcmRGb3JJZCh0eXBlLCBpZCk7CiAgICB9IGVsc2Ug
        aWYgKHR5cGVvZiBpZCA9PT0gJ29iamVjdCcpIHsKICAgICAgLy8gcG9seW1v
        cnBoaWMKICAgICAgZGF0YVtrZXldID0gZ2V0KHRoaXMsICdzdG9yZScpLnJl
        Y29yZEZvcklkKGlkLnR5cGUsIGlkLmlkKTsKICAgIH0KICB9LAoKICBkZXNl
        cmlhbGl6ZVJlY29yZElkczogZnVuY3Rpb24oZGF0YSwga2V5LCByZWxhdGlv
        bnNoaXAsIGlkcykgewogICAgZm9yICh2YXIgaT0wLCBsPWlkcy5sZW5ndGg7
        IGk8bDsgaSsrKSB7CiAgICAgIHRoaXMuZGVzZXJpYWxpemVSZWNvcmRJZChp
        ZHMsIGksIHJlbGF0aW9uc2hpcCwgaWRzW2ldKTsKICAgIH0KICB9LAoKICAv
        LyBTRVJJQUxJWkUKCiAgc2VyaWFsaXplOiBmdW5jdGlvbihyZWNvcmQsIG9w
        dGlvbnMpIHsKICAgIHZhciBzdG9yZSA9IGdldCh0aGlzLCAnc3RvcmUnKTsK
        CiAgICB2YXIganNvbiA9IHt9OwoKICAgIGlmIChvcHRpb25zICYmIG9wdGlv
        bnMuaW5jbHVkZUlkKSB7CiAgICAgIHZhciBpZCA9IGdldChyZWNvcmQsICdp
        ZCcpOwoKICAgICAgaWYgKGlkKSB7CiAgICAgICAganNvbltnZXQodGhpcywg
        J3ByaW1hcnlLZXknKV0gPSBnZXQocmVjb3JkLCAnaWQnKTsKICAgICAgfQog
        ICAgfQoKICAgIHZhciBhdHRycyA9IGdldCh0aGlzLCAnYXR0cnMnKTsKCiAg
        ICByZWNvcmQuZWFjaEF0dHJpYnV0ZShmdW5jdGlvbihrZXksIGF0dHJpYnV0
        ZSkgewogICAgICB2YXIgdmFsdWUgPSBnZXQocmVjb3JkLCBrZXkpLCB0eXBl
        ID0gYXR0cmlidXRlLnR5cGU7CgogICAgICBpZiAodHlwZSkgewogICAgICAg
        IHZhbHVlID0gdHJhbnNmb3Jtc1t0eXBlXS5zZXJpYWxpemUodmFsdWUpOwog
        ICAgICB9CgogICAgICAvLyBpZiBwcm92aWRlZCwgdXNlIHRoZSBtYXBwaW5n
        IHByb3ZpZGVkIGJ5IGBhdHRyc2AgaW4KICAgICAgLy8gdGhlIHNlcmlhbGl6
        ZXIKICAgICAga2V5ID0gYXR0cnMgJiYgYXR0cnNba2V5XSB8fCBrZXk7Cgog
        ICAgICBqc29uW2tleV0gPSB2YWx1ZTsKICAgIH0sIHRoaXMpOwoKICAgIHJl
        Y29yZC5lYWNoUmVsYXRpb25zaGlwKGZ1bmN0aW9uKGtleSwgcmVsYXRpb25z
        aGlwKSB7CiAgICAgIGlmIChyZWxhdGlvbnNoaXAua2luZCA9PT0gJ2JlbG9u
        Z3NUbycpIHsKICAgICAgICB0aGlzLnNlcmlhbGl6ZUJlbG9uZ3NUbyhyZWNv
        cmQsIGpzb24sIHJlbGF0aW9uc2hpcCk7CiAgICAgIH0gZWxzZSBpZiAocmVs
        YXRpb25zaGlwLmtpbmQgPT09ICdoYXNNYW55JykgewogICAgICAgIHRoaXMu
        c2VyaWFsaXplSGFzTWFueShyZWNvcmQsIGpzb24sIHJlbGF0aW9uc2hpcCk7
        CiAgICAgIH0KICAgIH0sIHRoaXMpOwoKICAgIHJldHVybiBqc29uOwogIH0s
        CgogIHNlcmlhbGl6ZUJlbG9uZ3NUbzogZnVuY3Rpb24ocmVjb3JkLCBqc29u
        LCByZWxhdGlvbnNoaXApIHsKICAgIHZhciBrZXkgPSByZWxhdGlvbnNoaXAu
        a2V5OwoKICAgIHZhciBiZWxvbmdzVG8gPSBnZXQocmVjb3JkLCBrZXkpOwoK
        ICAgIGlmIChpc05vbmUoYmVsb25nc1RvKSkgeyByZXR1cm47IH0KCiAgICBq
        c29uW2tleV0gPSBnZXQoYmVsb25nc1RvLCAnaWQnKTsKCiAgICBpZiAocmVs
        YXRpb25zaGlwLm9wdGlvbnMucG9seW1vcnBoaWMpIHsKICAgICAganNvbltr
        ZXkgKyAiX3R5cGUiXSA9IGJlbG9uZ3NUby5jb25zdHJ1Y3Rvci50eXBlS2V5
        OwogICAgfQogIH0sCgogIHNlcmlhbGl6ZUhhc01hbnk6IEVtYmVyLkssCgog
        IC8vIEVYVFJBQ1QKCiAgZXh0cmFjdDogZnVuY3Rpb24oc3RvcmUsIHR5cGUs
        IHBheWxvYWQsIGlkLCByZXF1ZXN0VHlwZSkgewogICAgdmFyIHNwZWNpZmlj
        RXh0cmFjdCA9ICJleHRyYWN0IiArIHJlcXVlc3RUeXBlLmNoYXJBdCgwKS50
        b1VwcGVyQ2FzZSgpICsgcmVxdWVzdFR5cGUuc3Vic3RyKDEpOwogICAgcmV0
        dXJuIHRoaXNbc3BlY2lmaWNFeHRyYWN0XShzdG9yZSwgdHlwZSwgcGF5bG9h
        ZCwgaWQsIHJlcXVlc3RUeXBlKTsKICB9LAoKICBleHRyYWN0RmluZEFsbDog
        YWxpYXNNZXRob2QoJ2V4dHJhY3RBcnJheScpLAogIGV4dHJhY3RGaW5kUXVl
        cnk6IGFsaWFzTWV0aG9kKCdleHRyYWN0QXJyYXknKSwKICBleHRyYWN0Rmlu
        ZE1hbnk6IGFsaWFzTWV0aG9kKCdleHRyYWN0QXJyYXknKSwKICBleHRyYWN0
        RmluZEhhc01hbnk6IGFsaWFzTWV0aG9kKCdleHRyYWN0QXJyYXknKSwKCiAg
        ZXh0cmFjdENyZWF0ZVJlY29yZDogYWxpYXNNZXRob2QoJ2V4dHJhY3RTYXZl
        JyksCiAgZXh0cmFjdFVwZGF0ZVJlY29yZDogYWxpYXNNZXRob2QoJ2V4dHJh
        Y3RTYXZlJyksCiAgZXh0cmFjdERlbGV0ZVJlY29yZDogYWxpYXNNZXRob2Qo
        J2V4dHJhY3RTYXZlJyksCgogIGV4dHJhY3RGaW5kOiBhbGlhc01ldGhvZCgn
        ZXh0cmFjdFNpbmdsZScpLAogIGV4dHJhY3RTYXZlOiBhbGlhc01ldGhvZCgn
        ZXh0cmFjdFNpbmdsZScpLAoKICBleHRyYWN0U2luZ2xlOiBmdW5jdGlvbihz
        dG9yZSwgdHlwZSwgcGF5bG9hZCkgewogICAgcmV0dXJuIHBheWxvYWQ7CiAg
        fSwKCiAgZXh0cmFjdEFycmF5OiBmdW5jdGlvbihzdG9yZSwgdHlwZSwgcGF5
        bG9hZCkgewogICAgcmV0dXJuIHBheWxvYWQ7CiAgfSwKICAvLyBIRUxQRVJT
        CgogIHR5cGVGb3I6IGZ1bmN0aW9uKHJlbGF0aW9uc2hpcCwga2V5LCBkYXRh
        KSB7CiAgICBpZiAocmVsYXRpb25zaGlwLm9wdGlvbnMucG9seW1vcnBoaWMp
        IHsKICAgICAgcmV0dXJuIGRhdGFba2V5ICsgIl90eXBlIl07CiAgICB9IGVs
        c2UgewogICAgICByZXR1cm4gcmVsYXRpb25zaGlwLnR5cGU7CiAgICB9CiAg
        fSwKCiAgZWFjaEVtYmVkZGVkUmVjb3JkOiBmdW5jdGlvbigpIHsKICAgIC8v
        IHRoaXMgaXMgdXNlZCBieSB0cmFuc2FjdGlvbi5hZGQKICB9Cn0pOwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKICBAbW9kdWxlIGVtYmVyLWRhdGEK
        Ki8KdmFyIGdldCA9IEVtYmVyLmdldCwgY2FwaXRhbGl6ZSA9IEVtYmVyLlN0
        cmluZy5jYXBpdGFsaXplLCB1bmRlcnNjb3JlID0gRW1iZXIuU3RyaW5nLnVu
        ZGVyc2NvcmUsIERTID0gd2luZG93LkRTIDsKCi8qKgogIEV4dGVuZCBgRW1i
        ZXIuRGF0YUFkYXB0ZXJgIHdpdGggRUQgc3BlY2lmaWMgY29kZS4KKi8KRFMu
        RGVidWdBZGFwdGVyID0gRW1iZXIuRGF0YUFkYXB0ZXIuZXh0ZW5kKHsKICBn
        ZXRGaWx0ZXJzOiBmdW5jdGlvbigpIHsKICAgIHJldHVybiBbCiAgICAgIHsg
        bmFtZTogJ2lzTmV3JywgZGVzYzogJ05ldycgfSwKICAgICAgeyBuYW1lOiAn
        aXNNb2RpZmllZCcsIGRlc2M6ICdNb2RpZmllZCcgfSwKICAgICAgeyBuYW1l
        OiAnaXNDbGVhbicsIGRlc2M6ICdDbGVhbicgfQogICAgXTsKICB9LAoKICBk
        ZXRlY3Q6IGZ1bmN0aW9uKGtsYXNzKSB7CiAgICByZXR1cm4ga2xhc3MgIT09
        IERTLk1vZGVsICYmIERTLk1vZGVsLmRldGVjdChrbGFzcyk7CiAgfSwKCiAg
        Y29sdW1uc0ZvclR5cGU6IGZ1bmN0aW9uKHR5cGUpIHsKICAgIHZhciBjb2x1
        bW5zID0gW3sgbmFtZTogJ2lkJywgZGVzYzogJ0lkJyB9XSwgY291bnQgPSAw
        LCBzZWxmID0gdGhpczsKICAgIEVtYmVyLkEoZ2V0KHR5cGUsICdhdHRyaWJ1
        dGVzJykpLmZvckVhY2goZnVuY3Rpb24obmFtZSwgbWV0YSkgewogICAgICAg
        IGlmIChjb3VudCsrID4gc2VsZi5hdHRyaWJ1dGVMaW1pdCkgeyByZXR1cm4g
        ZmFsc2U7IH0KICAgICAgICB2YXIgZGVzYyA9IGNhcGl0YWxpemUodW5kZXJz
        Y29yZShuYW1lKS5yZXBsYWNlKCdfJywgJyAnKSk7CiAgICAgICAgY29sdW1u
        cy5wdXNoKHsgbmFtZTogbmFtZSwgZGVzYzogZGVzYyB9KTsKICAgIH0pOwog
        ICAgcmV0dXJuIGNvbHVtbnM7CiAgfSwKCiAgZ2V0UmVjb3JkczogZnVuY3Rp
        b24odHlwZSkgewogICAgcmV0dXJuIHRoaXMuZ2V0KCdzdG9yZScpLmFsbCh0
        eXBlKTsKICB9LAoKICBnZXRSZWNvcmRDb2x1bW5WYWx1ZXM6IGZ1bmN0aW9u
        KHJlY29yZCkgewogICAgdmFyIHNlbGYgPSB0aGlzLCBjb3VudCA9IDAsCiAg
        ICAgICAgY29sdW1uVmFsdWVzID0geyBpZDogZ2V0KHJlY29yZCwgJ2lkJykg
        fTsKCiAgICByZWNvcmQuZWFjaEF0dHJpYnV0ZShmdW5jdGlvbihrZXkpIHsK
        ICAgICAgaWYgKGNvdW50KysgPiBzZWxmLmF0dHJpYnV0ZUxpbWl0KSB7CiAg
        ICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHZhciB2YWx1ZSA9
        IGdldChyZWNvcmQsIGtleSk7CiAgICAgIGNvbHVtblZhbHVlc1trZXldID0g
        dmFsdWU7CiAgICB9KTsKICAgIHJldHVybiBjb2x1bW5WYWx1ZXM7CiAgfSwK
        CiAgZ2V0UmVjb3JkS2V5d29yZHM6IGZ1bmN0aW9uKHJlY29yZCkgewogICAg
        dmFyIGtleXdvcmRzID0gW10sIGtleXMgPSBFbWJlci5BKFsnaWQnXSk7CiAg
        ICByZWNvcmQuZWFjaEF0dHJpYnV0ZShmdW5jdGlvbihrZXkpIHsKICAgICAg
        a2V5cy5wdXNoKGtleSk7CiAgICB9KTsKICAgIGtleXMuZm9yRWFjaChmdW5j
        dGlvbihrZXkpIHsKICAgICAga2V5d29yZHMucHVzaChnZXQocmVjb3JkLCBr
        ZXkpKTsKICAgIH0pOwogICAgcmV0dXJuIGtleXdvcmRzOwogIH0sCgogIGdl
        dFJlY29yZEZpbHRlclZhbHVlczogZnVuY3Rpb24ocmVjb3JkKSB7CiAgICBy
        ZXR1cm4gewogICAgICBpc05ldzogcmVjb3JkLmdldCgnaXNOZXcnKSwKICAg
        ICAgaXNNb2RpZmllZDogcmVjb3JkLmdldCgnaXNEaXJ0eScpICYmICFyZWNv
        cmQuZ2V0KCdpc05ldycpLAogICAgICBpc0NsZWFuOiAhcmVjb3JkLmdldCgn
        aXNEaXJ0eScpCiAgICB9OwogIH0sCgogIGdldFJlY29yZENvbG9yOiBmdW5j
        dGlvbihyZWNvcmQpIHsKICAgIHZhciBjb2xvciA9ICdibGFjayc7CiAgICBp
        ZiAocmVjb3JkLmdldCgnaXNOZXcnKSkgewogICAgICBjb2xvciA9ICdncmVl
        bic7CiAgICB9IGVsc2UgaWYgKHJlY29yZC5nZXQoJ2lzRGlydHknKSkgewog
        ICAgICBjb2xvciA9ICdibHVlJzsKICAgIH0KICAgIHJldHVybiBjb2xvcjsK
        ICB9LAoKICBvYnNlcnZlUmVjb3JkOiBmdW5jdGlvbihyZWNvcmQsIHJlY29y
        ZFVwZGF0ZWQpIHsKICAgIHZhciByZWxlYXNlTWV0aG9kcyA9IEVtYmVyLkEo
        KSwgc2VsZiA9IHRoaXMsCiAgICAgICAga2V5c1RvT2JzZXJ2ZSA9IEVtYmVy
        LkEoWydpZCcsICdpc05ldycsICdpc0RpcnR5J10pOwoKICAgIHJlY29yZC5l
        YWNoQXR0cmlidXRlKGZ1bmN0aW9uKGtleSkgewogICAgICBrZXlzVG9PYnNl
        cnZlLnB1c2goa2V5KTsKICAgIH0pOwoKICAgIGtleXNUb09ic2VydmUuZm9y
        RWFjaChmdW5jdGlvbihrZXkpIHsKICAgICAgdmFyIGhhbmRsZXIgPSBmdW5j
        dGlvbigpIHsKICAgICAgICByZWNvcmRVcGRhdGVkKHNlbGYud3JhcFJlY29y
        ZChyZWNvcmQpKTsKICAgICAgfTsKICAgICAgRW1iZXIuYWRkT2JzZXJ2ZXIo
        cmVjb3JkLCBrZXksIGhhbmRsZXIpOwogICAgICByZWxlYXNlTWV0aG9kcy5w
        dXNoKGZ1bmN0aW9uKCkgewogICAgICAgIEVtYmVyLnJlbW92ZU9ic2VydmVy
        KHJlY29yZCwga2V5LCBoYW5kbGVyKTsKICAgICAgfSk7CiAgICB9KTsKCiAg
        ICB2YXIgcmVsZWFzZSA9IGZ1bmN0aW9uKCkgewogICAgICByZWxlYXNlTWV0
        aG9kcy5mb3JFYWNoKGZ1bmN0aW9uKGZuKSB7IGZuKCk7IH0gKTsKICAgIH07
        CgogICAgcmV0dXJuIHJlbGVhc2U7CiAgfQoKfSk7Cgp9KSgpOwoKCgooZnVu
        Y3Rpb24oKSB7Ci8qKgogIEBtb2R1bGUgZW1iZXItZGF0YQoqLwoKdmFyIHNl
        dCA9IEVtYmVyLnNldDsKCi8qCiAgVGhpcyBjb2RlIHJlZ2lzdGVycyBhbiBp
        bmplY3Rpb24gZm9yIEVtYmVyLkFwcGxpY2F0aW9uLgoKICBJZiBhbiBFbWJl
        ci5qcyBkZXZlbG9wZXIgZGVmaW5lcyBhIHN1YmNsYXNzIG9mIERTLlN0b3Jl
        IG9uIHRoZWlyIGFwcGxpY2F0aW9uLAogIHRoaXMgY29kZSB3aWxsIGF1dG9t
        YXRpY2FsbHkgaW5zdGFudGlhdGUgaXQgYW5kIG1ha2UgaXQgYXZhaWxhYmxl
        IG9uIHRoZQogIHJvdXRlci4KCiAgQWRkaXRpb25hbGx5LCBhZnRlciBhbiBh
        cHBsaWNhdGlvbidzIGNvbnRyb2xsZXJzIGhhdmUgYmVlbiBpbmplY3RlZCwg
        dGhleSB3aWxsCiAgZWFjaCBoYXZlIHRoZSBzdG9yZSBtYWRlIGF2YWlsYWJs
        ZSB0byB0aGVtLgoKICBGb3IgZXhhbXBsZSwgaW1hZ2luZSBhbiBFbWJlci5q
        cyBhcHBsaWNhdGlvbiB3aXRoIHRoZSBmb2xsb3dpbmcgY2xhc3NlczoKCiAg
        QXBwLlN0b3JlID0gRFMuU3RvcmUuZXh0ZW5kKHsKICAgIGFkYXB0ZXI6ICdB
        cHAuTXlDdXN0b21BZGFwdGVyJwogIH0pOwoKICBBcHAuUG9zdHNDb250cm9s
        bGVyID0gRW1iZXIuQXJyYXlDb250cm9sbGVyLmV4dGVuZCh7CiAgICAvLyAu
        Li4KICB9KTsKCiAgV2hlbiB0aGUgYXBwbGljYXRpb24gaXMgaW5pdGlhbGl6
        ZWQsIGBBcHAuU3RvcmVgIHdpbGwgYXV0b21hdGljYWxseSBiZQogIGluc3Rh
        bnRpYXRlZCwgYW5kIHRoZSBpbnN0YW5jZSBvZiBgQXBwLlBvc3RzQ29udHJv
        bGxlcmAgd2lsbCBoYXZlIGl0cyBgc3RvcmVgCiAgcHJvcGVydHkgc2V0IHRv
        IHRoYXQgaW5zdGFuY2UuCgogIE5vdGUgdGhhdCB0aGlzIGNvZGUgd2lsbCBv
        bmx5IGJlIHJ1biBpZiB0aGUgYGVtYmVyLWFwcGxpY2F0aW9uYCBwYWNrYWdl
        IGlzCiAgbG9hZGVkLiBJZiBFbWJlciBEYXRhIGlzIGJlaW5nIHVzZWQgaW4g
        YW4gZW52aXJvbm1lbnQgb3RoZXIgdGhhbiBhCiAgdHlwaWNhbCBhcHBsaWNh
        dGlvbiAoZS5nLiwgbm9kZS5qcyB3aGVyZSBvbmx5IGBlbWJlci1ydW50aW1l
        YCBpcyBhdmFpbGFibGUpLAogIHRoaXMgY29kZSB3aWxsIGJlIGlnbm9yZWQu
        CiovCgpFbWJlci5vbkxvYWQoJ0VtYmVyLkFwcGxpY2F0aW9uJywgZnVuY3Rp
        b24oQXBwbGljYXRpb24pIHsKICBBcHBsaWNhdGlvbi5pbml0aWFsaXplcih7
        CiAgICBuYW1lOiAic3RvcmUiLAoKICAgIGluaXRpYWxpemU6IGZ1bmN0aW9u
        KGNvbnRhaW5lciwgYXBwbGljYXRpb24pIHsKICAgICAgYXBwbGljYXRpb24u
        cmVnaXN0ZXIoJ3N0b3JlOm1haW4nLCBhcHBsaWNhdGlvbi5TdG9yZSB8fCBE
        Uy5TdG9yZSk7CiAgICAgIGFwcGxpY2F0aW9uLnJlZ2lzdGVyKCdzZXJpYWxp
        emVyOl9kZWZhdWx0JywgRFMuSlNPTlNlcmlhbGl6ZXIpOwogICAgICBhcHBs
        aWNhdGlvbi5yZWdpc3Rlcignc2VyaWFsaXplcjpfcmVzdCcsIERTLlJFU1RT
        ZXJpYWxpemVyKTsKICAgICAgYXBwbGljYXRpb24ucmVnaXN0ZXIoJ2FkYXB0
        ZXI6X3Jlc3QnLCBEUy5SRVNUQWRhcHRlcik7CgogICAgICAvLyBFYWdlcmx5
        IGdlbmVyYXRlIHRoZSBzdG9yZSBzbyBkZWZhdWx0U3RvcmUgaXMgcG9wdWxh
        dGVkLgogICAgICAvLyBUT0RPOiBEbyB0aGlzIGluIGEgZmluaXNoZXIgaG9v
        awogICAgICBjb250YWluZXIubG9va3VwKCdzdG9yZTptYWluJyk7CiAgICB9
        CiAgfSk7CgogIC8vIEtlZXAgRUQgY29tcGF0aWJsZSB3aXRoIHByZXZpb3Vz
        IHZlcnNpb25zIG9mIGVtYmVyCiAgLy8gVE9ETzogUmVtb3ZlIHRoZSBpZiBz
        dGF0ZW1lbnQgZm9yIEVtYmVyIDEuMAogIGlmIChEUy5EZWJ1Z0FkYXB0ZXIp
        IHsKICAgIEFwcGxpY2F0aW9uLmluaXRpYWxpemVyKHsKICAgICAgbmFtZTog
        ImRhdGFBZGFwdGVyIiwKCiAgICAgIGluaXRpYWxpemU6IGZ1bmN0aW9uKGNv
        bnRhaW5lciwgYXBwbGljYXRpb24pIHsKICAgICAgICBhcHBsaWNhdGlvbi5y
        ZWdpc3RlcignZGF0YUFkYXB0ZXI6bWFpbicsIERTLkRlYnVnQWRhcHRlcik7
        CiAgICAgIH0KICAgIH0pOwogIH0KCiAgQXBwbGljYXRpb24uaW5pdGlhbGl6
        ZXIoewogICAgbmFtZTogImRhdGFBZGFwdGVyIiwKCiAgICBpbml0aWFsaXpl
        OiBmdW5jdGlvbihjb250YWluZXIsIGFwcGxpY2F0aW9uKSB7CiAgICAgIGFw
        cGxpY2F0aW9uLnJlZ2lzdGVyKCdkYXRhQWRhcHRlcjptYWluJywgRFMuRGVi
        dWdBZGFwdGVyKTsKICAgIH0KICB9KTsKCiAgQXBwbGljYXRpb24uaW5pdGlh
        bGl6ZXIoewogICAgbmFtZTogImluamVjdFN0b3JlIiwKCiAgICBpbml0aWFs
        aXplOiBmdW5jdGlvbihjb250YWluZXIsIGFwcGxpY2F0aW9uKSB7CiAgICAg
        IGFwcGxpY2F0aW9uLmluamVjdCgnY29udHJvbGxlcicsICdzdG9yZScsICdz
        dG9yZTptYWluJyk7CiAgICAgIGFwcGxpY2F0aW9uLmluamVjdCgncm91dGUn
        LCAnc3RvcmUnLCAnc3RvcmU6bWFpbicpOwogICAgICBhcHBsaWNhdGlvbi5p
        bmplY3QoJ3NlcmlhbGl6ZXInLCAnc3RvcmUnLCAnc3RvcmU6bWFpbicpOwog
        ICAgICBhcHBsaWNhdGlvbi5pbmplY3QoJ2RhdGFBZGFwdGVyJywgJ3N0b3Jl
        JywgJ3N0b3JlOm1haW4nKTsKICAgIH0KICB9KTsKCn0pOwoKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewovKioKICBAbW9kdWxlIGVtYmVyLWRhdGEKKi8KCi8q
        KgogIERhdGUucGFyc2Ugd2l0aCBwcm9ncmVzc2l2ZSBlbmhhbmNlbWVudCBm
        b3IgSVNPIDg2MDEgPGh0dHBzOi8vZ2l0aHViLmNvbS9jc25vdmVyL2pzLWlz
        bzg2MDE+CgogIMKpIDIwMTEgQ29saW4gU25vdmVyIDxodHRwOi8vemV0YWZs
        ZWV0LmNvbT4KCiAgUmVsZWFzZWQgdW5kZXIgTUlUIGxpY2Vuc2UuCgogIEBj
        bGFzcyBEYXRlCiAgQG5hbWVzcGFjZSBFbWJlcgogIEBzdGF0aWMKKi8KRW1i
        ZXIuRGF0ZSA9IEVtYmVyLkRhdGUgfHwge307Cgp2YXIgb3JpZ1BhcnNlID0g
        RGF0ZS5wYXJzZSwgbnVtZXJpY0tleXMgPSBbIDEsIDQsIDUsIDYsIDcsIDEw
        LCAxMSBdOwoKLyoqCiAgQG1ldGhvZCBwYXJzZQogIEBwYXJhbSBkYXRlCiov
        CkVtYmVyLkRhdGUucGFyc2UgPSBmdW5jdGlvbiAoZGF0ZSkgewogICAgdmFy
        IHRpbWVzdGFtcCwgc3RydWN0LCBtaW51dGVzT2Zmc2V0ID0gMDsKCiAgICAv
        LyBFUzUgwqcxNS45LjQuMiBzdGF0ZXMgdGhhdCB0aGUgc3RyaW5nIHNob3Vs
        ZCBhdHRlbXB0IHRvIGJlIHBhcnNlZCBhcyBhIERhdGUgVGltZSBTdHJpbmcg
        Rm9ybWF0IHN0cmluZwogICAgLy8gYmVmb3JlIGZhbGxpbmcgYmFjayB0byBh
        bnkgaW1wbGVtZW50YXRpb24tc3BlY2lmaWMgZGF0ZSBwYXJzaW5nLCBzbyB0
        aGF04oCZcyB3aGF0IHdlIGRvLCBldmVuIGlmIG5hdGl2ZQogICAgLy8gaW1w
        bGVtZW50YXRpb25zIGNvdWxkIGJlIGZhc3RlcgogICAgLy8gICAgICAgICAg
        ICAgIDEgWVlZWSAgICAgICAgICAgICAgICAyIE1NICAgICAgIDMgREQgICAg
        ICAgICAgIDQgSEggICAgNSBtbSAgICAgICA2IHNzICAgICAgICA3IG1zZWMg
        ICAgICAgIDggWiA5IMKxICAgIDEwIHR6SEggICAgMTEgdHptbQogICAgaWYg
        KChzdHJ1Y3QgPSAvXihcZHs0fXxbK1wtXVxkezZ9KSg/Oi0oXGR7Mn0pKD86
        LShcZHsyfSkpPyk/KD86VChcZHsyfSk6KFxkezJ9KSg/OjooXGR7Mn0pKD86
        XC4oXGR7M30pKT8pPyg/OihaKXwoWytcLV0pKFxkezJ9KSg/OjooXGR7Mn0p
        KT8pPyk/JC8uZXhlYyhkYXRlKSkpIHsKICAgICAgICAvLyBhdm9pZCBOYU4g
        dGltZXN0YW1wcyBjYXVzZWQgYnkg4oCcdW5kZWZpbmVk4oCdIHZhbHVlcyBi
        ZWluZyBwYXNzZWQgdG8gRGF0ZS5VVEMKICAgICAgICBmb3IgKHZhciBpID0g
        MCwgazsgKGsgPSBudW1lcmljS2V5c1tpXSk7ICsraSkgewogICAgICAgICAg
        ICBzdHJ1Y3Rba10gPSArc3RydWN0W2tdIHx8IDA7CiAgICAgICAgfQoKICAg
        ICAgICAvLyBhbGxvdyB1bmRlZmluZWQgZGF5cyBhbmQgbW9udGhzCiAgICAg
        ICAgc3RydWN0WzJdID0gKCtzdHJ1Y3RbMl0gfHwgMSkgLSAxOwogICAgICAg
        IHN0cnVjdFszXSA9ICtzdHJ1Y3RbM10gfHwgMTsKCiAgICAgICAgaWYgKHN0
        cnVjdFs4XSAhPT0gJ1onICYmIHN0cnVjdFs5XSAhPT0gdW5kZWZpbmVkKSB7
        CiAgICAgICAgICAgIG1pbnV0ZXNPZmZzZXQgPSBzdHJ1Y3RbMTBdICogNjAg
        KyBzdHJ1Y3RbMTFdOwoKICAgICAgICAgICAgaWYgKHN0cnVjdFs5XSA9PT0g
        JysnKSB7CiAgICAgICAgICAgICAgICBtaW51dGVzT2Zmc2V0ID0gMCAtIG1p
        bnV0ZXNPZmZzZXQ7CiAgICAgICAgICAgIH0KICAgICAgICB9CgogICAgICAg
        IHRpbWVzdGFtcCA9IERhdGUuVVRDKHN0cnVjdFsxXSwgc3RydWN0WzJdLCBz
        dHJ1Y3RbM10sIHN0cnVjdFs0XSwgc3RydWN0WzVdICsgbWludXRlc09mZnNl
        dCwgc3RydWN0WzZdLCBzdHJ1Y3RbN10pOwogICAgfQogICAgZWxzZSB7CiAg
        ICAgICAgdGltZXN0YW1wID0gb3JpZ1BhcnNlID8gb3JpZ1BhcnNlKGRhdGUp
        IDogTmFOOwogICAgfQoKICAgIHJldHVybiB0aW1lc3RhbXA7Cn07CgppZiAo
        RW1iZXIuRVhURU5EX1BST1RPVFlQRVMgPT09IHRydWUgfHwgRW1iZXIuRVhU
        RU5EX1BST1RPVFlQRVMuRGF0ZSkgewogIERhdGUucGFyc2UgPSBFbWJlci5E
        YXRlLnBhcnNlOwp9Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Cgp9KSgpOwoK
        CgooZnVuY3Rpb24oKSB7Ci8qKgogIEBtb2R1bGUgZW1iZXItZGF0YQoqLwoK
        dmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0OwoKLyoqCiAg
        QSByZWNvcmQgYXJyYXkgaXMgYW4gYXJyYXkgdGhhdCBjb250YWlucyByZWNv
        cmRzIG9mIGEgY2VydGFpbiB0eXBlLiBUaGUgcmVjb3JkCiAgYXJyYXkgbWF0
        ZXJpYWxpemVzIHJlY29yZHMgYXMgbmVlZGVkIHdoZW4gdGhleSBhcmUgcmV0
        cmlldmVkIGZvciB0aGUgZmlyc3QKICB0aW1lLiBZb3Ugc2hvdWxkIG5vdCBj
        cmVhdGUgcmVjb3JkIGFycmF5cyB5b3Vyc2VsZi4gSW5zdGVhZCwgYW4gaW5z
        dGFuY2Ugb2YKICBEUy5SZWNvcmRBcnJheSBvciBpdHMgc3ViY2xhc3NlcyB3
        aWxsIGJlIHJldHVybmVkIGJ5IHlvdXIgYXBwbGljYXRpb24ncyBzdG9yZQog
        IGluIHJlc3BvbnNlIHRvIHF1ZXJpZXMuCgogIEBjbGFzcyBSZWNvcmRBcnJh
        eQogIEBuYW1lc3BhY2UgRFMKICBAZXh0ZW5kcyBFbWJlci5BcnJheVByb3h5
        CiAgQHVzZXMgRW1iZXIuRXZlbnRlZAoqLwoKRFMuUmVjb3JkQXJyYXkgPSBF
        bWJlci5BcnJheVByb3h5LmV4dGVuZChFbWJlci5FdmVudGVkLCB7CiAgLyoq
        CiAgICBUaGUgbW9kZWwgdHlwZSBjb250YWluZWQgYnkgdGhpcyByZWNvcmQg
        YXJyYXkuCgogICAgQHByb3BlcnR5IHR5cGUKICAgIEB0eXBlIERTLk1vZGVs
        CiAgKi8KICB0eXBlOiBudWxsLAoKICAvLyBUaGUgYXJyYXkgb2YgY2xpZW50
        IGlkcyBiYWNraW5nIHRoZSByZWNvcmQgYXJyYXkuIFdoZW4gYQogIC8vIHJl
        Y29yZCBpcyByZXF1ZXN0ZWQgZnJvbSB0aGUgcmVjb3JkIGFycmF5LCB0aGUg
        cmVjb3JkCiAgLy8gZm9yIHRoZSBjbGllbnQgaWQgYXQgdGhlIHNhbWUgaW5k
        ZXggaXMgbWF0ZXJpYWxpemVkLCBpZgogIC8vIG5lY2Vzc2FyeSwgYnkgdGhl
        IHN0b3JlLgogIGNvbnRlbnQ6IG51bGwsCgogIGlzTG9hZGVkOiBmYWxzZSwK
        ICBpc1VwZGF0aW5nOiBmYWxzZSwKCiAgLy8gVGhlIHN0b3JlIHRoYXQgY3Jl
        YXRlZCB0aGlzIHJlY29yZCBhcnJheS4KICBzdG9yZTogbnVsbCwKCiAgb2Jq
        ZWN0QXRDb250ZW50OiBmdW5jdGlvbihpbmRleCkgewogICAgdmFyIGNvbnRl
        bnQgPSBnZXQodGhpcywgJ2NvbnRlbnQnKTsKCiAgICByZXR1cm4gY29udGVu
        dC5vYmplY3RBdChpbmRleCk7CiAgfSwKCiAgdXBkYXRlOiBmdW5jdGlvbigp
        IHsKICAgIGlmIChnZXQodGhpcywgJ2lzVXBkYXRpbmcnKSkgeyByZXR1cm47
        IH0KCiAgICB2YXIgc3RvcmUgPSBnZXQodGhpcywgJ3N0b3JlJyksCiAgICAg
        ICAgdHlwZSA9IGdldCh0aGlzLCAndHlwZScpOwoKICAgIHN0b3JlLmZldGNo
        QWxsKHR5cGUsIHRoaXMpOwogIH0sCgogIGFkZFJlY29yZDogZnVuY3Rpb24o
        cmVjb3JkKSB7CiAgICBnZXQodGhpcywgJ2NvbnRlbnQnKS5hZGRPYmplY3Qo
        cmVjb3JkKTsKICB9LAoKICByZW1vdmVSZWNvcmQ6IGZ1bmN0aW9uKHJlY29y
        ZCkgewogICAgZ2V0KHRoaXMsICdjb250ZW50JykucmVtb3ZlT2JqZWN0KHJl
        Y29yZCk7CiAgfQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCiAg
        QG1vZHVsZSBlbWJlci1kYXRhCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0OwoK
        LyoqCiAgQGNsYXNzIEZpbHRlcmVkUmVjb3JkQXJyYXkKICBAbmFtZXNwYWNl
        IERTCiAgQGV4dGVuZHMgRFMuUmVjb3JkQXJyYXkKKi8KRFMuRmlsdGVyZWRS
        ZWNvcmRBcnJheSA9IERTLlJlY29yZEFycmF5LmV4dGVuZCh7CiAgZmlsdGVy
        RnVuY3Rpb246IG51bGwsCiAgaXNMb2FkZWQ6IHRydWUsCgogIHJlcGxhY2U6
        IGZ1bmN0aW9uKCkgewogICAgdmFyIHR5cGUgPSBnZXQodGhpcywgJ3R5cGUn
        KS50b1N0cmluZygpOwogICAgdGhyb3cgbmV3IEVycm9yKCJUaGUgcmVzdWx0
        IG9mIGEgY2xpZW50LXNpZGUgZmlsdGVyIChvbiAiICsgdHlwZSArICIpIGlz
        IGltbXV0YWJsZS4iKTsKICB9LAoKICB1cGRhdGVGaWx0ZXI6IEVtYmVyLm9i
        c2VydmVyKGZ1bmN0aW9uKCkgewogICAgdmFyIG1hbmFnZXIgPSBnZXQodGhp
        cywgJ21hbmFnZXInKTsKICAgIG1hbmFnZXIudXBkYXRlRmlsdGVyKHRoaXMs
        IGdldCh0aGlzLCAndHlwZScpLCBnZXQodGhpcywgJ2ZpbHRlckZ1bmN0aW9u
        JykpOwogIH0sICdmaWx0ZXJGdW5jdGlvbicpCn0pOwoKfSkoKTsKCgoKKGZ1
        bmN0aW9uKCkgewovKioKICBAbW9kdWxlIGVtYmVyLWRhdGEKKi8KCnZhciBn
        ZXQgPSBFbWJlci5nZXQsIHNldCA9IEVtYmVyLnNldDsKCi8qKgogIEBjbGFz
        cyBBZGFwdGVyUG9wdWxhdGVkUmVjb3JkQXJyYXkKICBAbmFtZXNwYWNlIERT
        CiAgQGV4dGVuZHMgRFMuUmVjb3JkQXJyYXkKKi8KRFMuQWRhcHRlclBvcHVs
        YXRlZFJlY29yZEFycmF5ID0gRFMuUmVjb3JkQXJyYXkuZXh0ZW5kKHsKICBx
        dWVyeTogbnVsbCwKCiAgcmVwbGFjZTogZnVuY3Rpb24oKSB7CiAgICB2YXIg
        dHlwZSA9IGdldCh0aGlzLCAndHlwZScpLnRvU3RyaW5nKCk7CiAgICB0aHJv
        dyBuZXcgRXJyb3IoIlRoZSByZXN1bHQgb2YgYSBzZXJ2ZXIgcXVlcnkgKG9u
        ICIgKyB0eXBlICsgIikgaXMgaW1tdXRhYmxlLiIpOwogIH0sCgogIGxvYWQ6
        IGZ1bmN0aW9uKGRhdGEpIHsKICAgIHZhciBzdG9yZSA9IGdldCh0aGlzLCAn
        c3RvcmUnKSwKICAgICAgICB0eXBlID0gZ2V0KHRoaXMsICd0eXBlJyksCiAg
        ICAgICAgcmVjb3JkcyA9IHN0b3JlLnB1c2hNYW55KHR5cGUsIGRhdGEpOwoK
        ICAgIHRoaXMuc2V0UHJvcGVydGllcyh7CiAgICAgIGNvbnRlbnQ6IEVtYmVy
        LkEocmVjb3JkcyksCiAgICAgIGlzTG9hZGVkOiB0cnVlCiAgICB9KTsKCiAg
        ICAvLyBUT0RPOiBkb2VzIHRyaWdnZXJpbmcgZGlkTG9hZCBldmVudCBzaG91
        bGQgYmUgdGhlIGxhc3QgYWN0aW9uIG9mIHRoZSBydW5Mb29wPwogICAgRW1i
        ZXIucnVuLm9uY2UodGhpcywgJ3RyaWdnZXInLCAnZGlkTG9hZCcpOwogIH0K
        fSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgogIEBtb2R1bGUgZW1i
        ZXItZGF0YQoqLwoKdmFyIGdldCA9IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIu
        c2V0Owp2YXIgbWFwID0gRW1iZXIuRW51bWVyYWJsZVV0aWxzLm1hcDsKCi8q
        KgogIEEgTWFueUFycmF5IGlzIGEgUmVjb3JkQXJyYXkgdGhhdCByZXByZXNl
        bnRzIHRoZSBjb250ZW50cyBvZiBhIGhhcy1tYW55CiAgcmVsYXRpb25zaGlw
        LgoKICBUaGUgTWFueUFycmF5IGlzIGluc3RhbnRpYXRlZCBsYXppbHkgdGhl
        IGZpcnN0IHRpbWUgdGhlIHJlbGF0aW9uc2hpcCBpcwogIHJlcXVlc3RlZC4K
        CiAgIyMjIEludmVyc2VzCgogIE9mdGVuLCB0aGUgcmVsYXRpb25zaGlwcyBp
        biBFbWJlciBEYXRhIGFwcGxpY2F0aW9ucyB3aWxsIGhhdmUKICBhbiBpbnZl
        cnNlLiBGb3IgZXhhbXBsZSwgaW1hZ2luZSB0aGUgZm9sbG93aW5nIG1vZGVs
        cyBhcmUKICBkZWZpbmVkOgoKICAgICAgQXBwLlBvc3QgPSBEUy5Nb2RlbC5l
        eHRlbmQoewogICAgICAgIGNvbW1lbnRzOiBEUy5oYXNNYW55KCdBcHAuQ29t
        bWVudCcpCiAgICAgIH0pOwoKICAgICAgQXBwLkNvbW1lbnQgPSBEUy5Nb2Rl
        bC5leHRlbmQoewogICAgICAgIHBvc3Q6IERTLmJlbG9uZ3NUbygnQXBwLlBv
        c3QnKQogICAgICB9KTsKCiAgSWYgeW91IGNyZWF0ZWQgYSBuZXcgaW5zdGFu
        Y2Ugb2YgYEFwcC5Qb3N0YCBhbmQgYWRkZWQKICBhIGBBcHAuQ29tbWVudGAg
        cmVjb3JkIHRvIGl0cyBgY29tbWVudHNgIGhhcy1tYW55CiAgcmVsYXRpb25z
        aGlwLCB5b3Ugd291bGQgZXhwZWN0IHRoZSBjb21tZW50J3MgYHBvc3RgCiAg
        cHJvcGVydHkgdG8gYmUgc2V0IHRvIHRoZSBwb3N0IHRoYXQgY29udGFpbmVk
        CiAgdGhlIGhhcy1tYW55LgoKICBXZSBjYWxsIHRoZSByZWNvcmQgdG8gd2hp
        Y2ggYSByZWxhdGlvbnNoaXAgYmVsb25ncyB0aGUKICByZWxhdGlvbnNoaXAn
        cyBfb3duZXJfLgoKICBAY2xhc3MgTWFueUFycmF5CiAgQG5hbWVzcGFjZSBE
        UwogIEBleHRlbmRzIERTLlJlY29yZEFycmF5CiovCkRTLk1hbnlBcnJheSA9
        IERTLlJlY29yZEFycmF5LmV4dGVuZCh7CiAgaW5pdDogZnVuY3Rpb24oKSB7
        CiAgICB0aGlzLl9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAg
        dGhpcy5fY2hhbmdlc1RvU3luYyA9IEVtYmVyLk9yZGVyZWRTZXQuY3JlYXRl
        KCk7CiAgfSwKCiAgLyoqCiAgICBUaGUgcmVjb3JkIHRvIHdoaWNoIHRoaXMg
        cmVsYXRpb25zaGlwIGJlbG9uZ3MuCgogICAgQHByb3BlcnR5IHtEUy5Nb2Rl
        bH0KICAgIEBwcml2YXRlCiAgKi8KICBvd25lcjogbnVsbCwKCiAgLyoqCiAg
        ICBgdHJ1ZWAgaWYgdGhlIHJlbGF0aW9uc2hpcCBpcyBwb2x5bW9ycGhpYywg
        YGZhbHNlYCBvdGhlcndpc2UuCgogICAgQHByb3BlcnR5IHtCb29sZWFufQog
        ICAgQHByaXZhdGUKICAqLwogIGlzUG9seW1vcnBoaWM6IGZhbHNlLAoKICAv
        LyBMT0FESU5HIFNUQVRFCgogIGlzTG9hZGVkOiBmYWxzZSwKCiAgbG9hZGlu
        Z1JlY29yZHNDb3VudDogZnVuY3Rpb24oY291bnQpIHsKICAgIHRoaXMubG9h
        ZGluZ1JlY29yZHNDb3VudCA9IGNvdW50OwogIH0sCgogIGxvYWRlZFJlY29y
        ZDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmxvYWRpbmdSZWNvcmRzQ291bnQt
        LTsKICAgIGlmICh0aGlzLmxvYWRpbmdSZWNvcmRzQ291bnQgPT09IDApIHsK
        ICAgICAgc2V0KHRoaXMsICdpc0xvYWRlZCcsIHRydWUpOwogICAgICB0aGlz
        LnRyaWdnZXIoJ2RpZExvYWQnKTsKICAgIH0KICB9LAoKICBmZXRjaDogZnVu
        Y3Rpb24oKSB7CiAgICB2YXIgcmVjb3JkcyA9IGdldCh0aGlzLCAnY29udGVu
        dCcpLAogICAgICAgIHN0b3JlID0gZ2V0KHRoaXMsICdzdG9yZScpLAogICAg
        ICAgIG93bmVyID0gZ2V0KHRoaXMsICdvd25lcicpOwoKICAgIHZhciB1bmxv
        YWRlZFJlY29yZHMgPSByZWNvcmRzLmZpbHRlclByb3BlcnR5KCdpc0VtcHR5
        JywgdHJ1ZSk7CiAgICBzdG9yZS5mZXRjaE1hbnkodW5sb2FkZWRSZWNvcmRz
        LCBvd25lcik7CiAgfSwKCiAgLy8gT3ZlcnJpZGVzIEVtYmVyLkFycmF5J3Mg
        cmVwbGFjZSBtZXRob2QgdG8gaW1wbGVtZW50CiAgcmVwbGFjZUNvbnRlbnQ6
        IGZ1bmN0aW9uKGluZGV4LCByZW1vdmVkLCBhZGRlZCkgewogICAgLy8gTWFw
        IHRoZSBhcnJheSBvZiByZWNvcmQgb2JqZWN0cyBpbnRvIGFuIGFycmF5IG9m
        ICBjbGllbnQgaWRzLgogICAgYWRkZWQgPSBtYXAoYWRkZWQsIGZ1bmN0aW9u
        KHJlY29yZCkgewogICAgICBFbWJlci5hc3NlcnQoIllvdSBjYW5ub3QgYWRk
        ICciICsgcmVjb3JkLmNvbnN0cnVjdG9yLnR5cGVLZXkgKyAiJyByZWNvcmRz
        IHRvIHRoaXMgcmVsYXRpb25zaGlwIChvbmx5ICciICsgdGhpcy50eXBlLnR5
        cGVLZXkgKyAiJyBhbGxvd2VkKSIsICF0aGlzLnR5cGUgfHwgcmVjb3JkIGlu
        c3RhbmNlb2YgdGhpcy50eXBlKTsKICAgICAgcmV0dXJuIHJlY29yZDsKICAg
        IH0sIHRoaXMpOwoKICAgIHRoaXMuX3N1cGVyKGluZGV4LCByZW1vdmVkLCBh
        ZGRlZCk7CiAgfSwKCiAgYXJyYW5nZWRDb250ZW50RGlkQ2hhbmdlOiBmdW5j
        dGlvbigpIHsKICAgIHRoaXMuZmV0Y2goKTsKICB9LAoKICBhcnJheUNvbnRl
        bnRXaWxsQ2hhbmdlOiBmdW5jdGlvbihpbmRleCwgcmVtb3ZlZCwgYWRkZWQp
        IHsKICAgIHZhciBvd25lciA9IGdldCh0aGlzLCAnb3duZXInKSwKICAgICAg
        ICBuYW1lID0gZ2V0KHRoaXMsICduYW1lJyk7CgogICAgaWYgKCFvd25lci5f
        c3VzcGVuZGVkUmVsYXRpb25zaGlwcykgewogICAgICAvLyBUaGlzIGNvZGUg
        aXMgdGhlIGZpcnN0IGhhbGYgb2YgY29kZSB0aGF0IGNvbnRpbnVlcyBpbnNp
        ZGUKICAgICAgLy8gb2YgYXJyYXlDb250ZW50RGlkQ2hhbmdlLiBJdCBnZXRz
        IG9yIGNyZWF0ZXMgYSBjaGFuZ2UgZnJvbQogICAgICAvLyB0aGUgY2hpbGQg
        b2JqZWN0LCBhZGRzIHRoZSBjdXJyZW50IG93bmVyIGFzIHRoZSBvbGQKICAg
        ICAgLy8gcGFyZW50IGlmIHRoaXMgaXMgdGhlIGZpcnN0IHRpbWUgdGhlIG9i
        amVjdCB3YXMgcmVtb3ZlZAogICAgICAvLyBmcm9tIGEgTWFueUFycmF5LCBh
        bmQgc2V0cyBgbmV3UGFyZW50YCB0byBudWxsLgogICAgICAvLwogICAgICAv
        LyBMYXRlciwgaWYgdGhlIG9iamVjdCBpcyBhZGRlZCB0byBhbm90aGVyIE1h
        bnlBcnJheSwKICAgICAgLy8gdGhlIGBhcnJheUNvbnRlbnREaWRDaGFuZ2Vg
        IHdpbGwgc2V0IGBuZXdQYXJlbnRgIG9uCiAgICAgIC8vIHRoZSBjaGFuZ2Uu
        CiAgICAgIGZvciAodmFyIGk9aW5kZXg7IGk8aW5kZXgrcmVtb3ZlZDsgaSsr
        KSB7CiAgICAgICAgdmFyIHJlY29yZCA9IGdldCh0aGlzLCAnY29udGVudCcp
        Lm9iamVjdEF0KGkpOwoKICAgICAgICB2YXIgY2hhbmdlID0gRFMuUmVsYXRp
        b25zaGlwQ2hhbmdlLmNyZWF0ZUNoYW5nZShvd25lciwgcmVjb3JkLCBnZXQo
        dGhpcywgJ3N0b3JlJyksIHsKICAgICAgICAgIHBhcmVudFR5cGU6IG93bmVy
        LmNvbnN0cnVjdG9yLAogICAgICAgICAgY2hhbmdlVHlwZTogInJlbW92ZSIs
        CiAgICAgICAgICBraW5kOiAiaGFzTWFueSIsCiAgICAgICAgICBrZXk6IG5h
        bWUKICAgICAgICB9KTsKCiAgICAgICAgdGhpcy5fY2hhbmdlc1RvU3luYy5h
        ZGQoY2hhbmdlKTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiB0aGlzLl9z
        dXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0sCgogIGFycmF5Q29u
        dGVudERpZENoYW5nZTogZnVuY3Rpb24oaW5kZXgsIHJlbW92ZWQsIGFkZGVk
        KSB7CiAgICB0aGlzLl9zdXBlci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwoK
        ICAgIHZhciBvd25lciA9IGdldCh0aGlzLCAnb3duZXInKSwKICAgICAgICBu
        YW1lID0gZ2V0KHRoaXMsICduYW1lJyksCiAgICAgICAgc3RvcmUgPSBnZXQo
        dGhpcywgJ3N0b3JlJyk7CgogICAgaWYgKCFvd25lci5fc3VzcGVuZGVkUmVs
        YXRpb25zaGlwcykgewogICAgICAvLyBUaGlzIGNvZGUgaXMgdGhlIHNlY29u
        ZCBoYWxmIG9mIGNvZGUgdGhhdCBzdGFydGVkIGluCiAgICAgIC8vIGBhcnJh
        eUNvbnRlbnRXaWxsQ2hhbmdlYC4gSXQgZ2V0cyBvciBjcmVhdGVzIGEgY2hh
        bmdlCiAgICAgIC8vIGZyb20gdGhlIGNoaWxkIG9iamVjdCwgYW5kIGFkZHMg
        dGhlIGN1cnJlbnQgb3duZXIgYXMKICAgICAgLy8gdGhlIG5ldyBwYXJlbnQu
        CiAgICAgIGZvciAodmFyIGk9aW5kZXg7IGk8aW5kZXgrYWRkZWQ7IGkrKykg
        ewogICAgICAgIHZhciByZWNvcmQgPSBnZXQodGhpcywgJ2NvbnRlbnQnKS5v
        YmplY3RBdChpKTsKCiAgICAgICAgdmFyIGNoYW5nZSA9IERTLlJlbGF0aW9u
        c2hpcENoYW5nZS5jcmVhdGVDaGFuZ2Uob3duZXIsIHJlY29yZCwgc3RvcmUs
        IHsKICAgICAgICAgIHBhcmVudFR5cGU6IG93bmVyLmNvbnN0cnVjdG9yLAog
        ICAgICAgICAgY2hhbmdlVHlwZTogImFkZCIsCiAgICAgICAgICBraW5kOiJo
        YXNNYW55IiwKICAgICAgICAgIGtleTogbmFtZQogICAgICAgIH0pOwogICAg
        ICAgIGNoYW5nZS5oYXNNYW55TmFtZSA9IG5hbWU7CgogICAgICAgIHRoaXMu
        X2NoYW5nZXNUb1N5bmMuYWRkKGNoYW5nZSk7CiAgICAgIH0KCiAgICAgIC8v
        IFdlIHdhaXQgdW50aWwgdGhlIGFycmF5IGhhcyBmaW5pc2hlZCBiZWluZwog
        ICAgICAvLyBtdXRhdGVkIGJlZm9yZSBzeW5jaW5nIHRoZSBPbmVUb01hbnlD
        aGFuZ2VzIGNyZWF0ZWQKICAgICAgLy8gaW4gYXJyYXlDb250ZW50V2lsbENo
        YW5nZSwgc28gdGhhdCB0aGUgYXJyYXkKICAgICAgLy8gbWVtYmVyc2hpcCB0
        ZXN0IGluIHRoZSBzeW5jKCkgbG9naWMgb3BlcmF0ZXMKICAgICAgLy8gb24g
        dGhlIGZpbmFsIHJlc3VsdHMuCiAgICAgIHRoaXMuX2NoYW5nZXNUb1N5bmMu
        Zm9yRWFjaChmdW5jdGlvbihjaGFuZ2UpIHsKICAgICAgICBjaGFuZ2Uuc3lu
        YygpOwogICAgICB9KTsKCiAgICAgIHRoaXMuX2NoYW5nZXNUb1N5bmMuY2xl
        YXIoKTsKICAgIH0KICB9LAoKICAvLyBDcmVhdGUgYSBjaGlsZCByZWNvcmQg
        d2l0aGluIHRoZSBvd25lcgogIGNyZWF0ZVJlY29yZDogZnVuY3Rpb24oaGFz
        aCkgewogICAgdmFyIG93bmVyID0gZ2V0KHRoaXMsICdvd25lcicpLAogICAg
        ICAgIHN0b3JlID0gZ2V0KG93bmVyLCAnc3RvcmUnKSwKICAgICAgICB0eXBl
        ID0gZ2V0KHRoaXMsICd0eXBlJyksCiAgICAgICAgcmVjb3JkOwoKICAgIEVt
        YmVyLmFzc2VydCgiWW91IGNhbm5vdCBhZGQgJyIgKyB0eXBlLnR5cGVLZXkg
        KyAiJyByZWNvcmRzIHRvIHRoaXMgcG9seW1vcnBoaWMgcmVsYXRpb25zaGlw
        LiIsICFnZXQodGhpcywgJ2lzUG9seW1vcnBoaWMnKSk7CgogICAgcmVjb3Jk
        ID0gc3RvcmUuY3JlYXRlUmVjb3JkLmNhbGwoc3RvcmUsIHR5cGUsIGhhc2gp
        OwogICAgdGhpcy5wdXNoT2JqZWN0KHJlY29yZCk7CgogICAgcmV0dXJuIHJl
        Y29yZDsKICB9Cgp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCiAg
        QG1vZHVsZSBlbWJlci1kYXRhCiovCgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7
        Ci8qKgogIEBtb2R1bGUgZW1iZXItZGF0YQoqLwoKdmFyIGdldCA9IEVtYmVy
        LmdldDsKCnZhciByZXNvbHZlTWFwQ29uZmxpY3QgPSBmdW5jdGlvbihvbGRW
        YWx1ZSwgbmV3VmFsdWUpIHsKICByZXR1cm4gb2xkVmFsdWU7Cn07Cgp2YXIg
        dHJhbnNmb3JtTWFwS2V5ID0gZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewogIHJl
        dHVybiBrZXk7Cn07Cgp2YXIgdHJhbnNmb3JtTWFwVmFsdWUgPSBmdW5jdGlv
        bihrZXksIHZhbHVlKSB7CiAgcmV0dXJuIHZhbHVlOwp9OwoKLyoqCiAgVGhl
        IE1hcHBhYmxlIG1peGluIGlzIGRlc2lnbmVkIGZvciBjbGFzc2VzIHRoYXQg
        d291bGQgbGlrZSB0bwogIGJlaGF2ZSBhcyBhIG1hcCBmb3IgY29uZmlndXJh
        dGlvbiBwdXJwb3Nlcy4KCiAgRm9yIGV4YW1wbGUsIHRoZSBEUy5BZGFwdGVy
        IGNsYXNzIGNhbiBiZWhhdmUgbGlrZSBhIG1hcCwgd2l0aAogIG1vcmUgc2Vt
        YW50aWMgQVBJLCB2aWEgdGhlIGBtYXBgIEFQSToKCiAgICBEUy5BZGFwdGVy
        Lm1hcCgnQXBwLlBlcnNvbicsIHsgZmlyc3ROYW1lOiB7IGtleTogJ0ZJUlNU
        JyB9IH0pOwoKICBDbGFzcyBjb25maWd1cmF0aW9uIHZpYSBhIG1hcC1saWtl
        IEFQSSBoYXMgYSBmZXcgY29tbW9uIHJlcXVpcmVtZW50cwogIHRoYXQgZGlm
        ZmVyZW50aWF0ZSBpdCBmcm9tIHRoZSBzdGFuZGFyZCBFbWJlci5NYXAgaW1w
        bGVtZW50YXRpb24uCgogIEZpcnN0LCB2YWx1ZXMgb2Z0ZW4gYXJlIHByb3Zp
        ZGVkIGFzIHN0cmluZ3MgdGhhdCBzaG91bGQgYmUgbm9ybWFsaXplZAogIGlu
        dG8gY2xhc3NlcyB0aGUgZmlyc3QgdGltZSB0aGUgY29uZmlndXJhdGlvbiBv
        cHRpb25zIGFyZSB1c2VkLgoKICBTZWNvbmQsIHRoZSB2YWx1ZXMgY29uZmln
        dXJlZCBvbiBwYXJlbnQgY2xhc3NlcyBzaG91bGQgYWxzbyBiZSB0YWtlbgog
        IGludG8gYWNjb3VudC4KCiAgRmluYWxseSwgc2V0dGluZyB0aGUgdmFsdWUg
        b2YgYSBrZXkgc29tZXRpbWVzIHNob3VsZCBtZXJnZSB3aXRoIHRoZQogIHBy
        ZXZpb3VzIHZhbHVlLCByYXRoZXIgdGhhbiByZXBsYWNpbmcgaXQuCgogIFRo
        aXMgbWl4aW4gcHJvdmlkZXMgYSBpbnN0YW5jZSBtZXRob2QsIGBjcmVhdGVJ
        bnN0YW5jZU1hcEZvcmAsIHRoYXQKICB3aWxsIHJlaWZ5IGFsbCBvZiB0aGUg
        Y29uZmlndXJhdGlvbiBvcHRpb25zIHNldCBvbiBhbiBpbnN0YW5jZSdzCiAg
        Y29uc3RydWN0b3IgYW5kIHByb3ZpZGUgaXQgZm9yIHRoZSBpbnN0YW5jZSB0
        byB1c2UuCgogIENsYXNzZXMgY2FuIGltcGxlbWVudCBjZXJ0YWluIGhvb2tz
        IHRoYXQgYWxsb3cgdGhlbSB0byBjdXN0b21pemUKICB0aGUgcmVxdWlyZW1l
        bnRzIGxpc3RlZCBhYm92ZToKCiAgKiBgcmVzb2x2ZU1hcENvbmZsaWN0YCAt
        IGNhbGxlZCB3aGVuIGEgdmFsdWUgaXMgc2V0IGZvciBhbiBleGlzdGluZwog
        ICAgdmFsdWUKICAqIGB0cmFuc2Zvcm1NYXBLZXlgIC0gYWxsb3dzIGEga2V5
        IG5hbWUgKGZvciBleGFtcGxlLCBhIGdsb2JhbCBwYXRoCiAgICB0byBhIGNs
        YXNzKSB0byBiZSBub3JtYWxpemVkCiAgKiBgdHJhbnNmb3JtTWFwVmFsdWVg
        IC0gYWxsb3dzIGEgdmFsdWUgKGZvciBleGFtcGxlLCBhIGNsYXNzIHRoYXQK
        ICAgIHNob3VsZCBiZSBpbnN0YW50aWF0ZWQpIHRvIGJlIG5vcm1hbGl6ZWQK
        CiAgQ2xhc3NlcyB0aGF0IGltcGxlbWVudCB0aGlzIG1peGluIHNob3VsZCBh
        bHNvIGltcGxlbWVudCBhIGNsYXNzCiAgbWV0aG9kIGJ1aWx0IHVzaW5nIHRo
        ZSBgZ2VuZXJhdGVNYXBGdW5jdGlvbkZvcmAgbWV0aG9kOgoKICAgIERTLkFk
        YXB0ZXIucmVvcGVuQ2xhc3MoewogICAgICBtYXA6IERTLk1hcHBhYmxlLmdl
        bmVyYXRlTWFwRnVuY3Rpb25Gb3IoJ2F0dHJpYnV0ZXMnLCBmdW5jdGlvbihr
        ZXksIG5ld1ZhbHVlLCBtYXApIHsKICAgICAgICB2YXIgZXhpc3RpbmdWYWx1
        ZSA9IG1hcC5nZXQoa2V5KTsKCiAgICAgICAgZm9yICh2YXIgcHJvcCBpbiBu
        ZXdWYWx1ZSkgewogICAgICAgICAgaWYgKCFuZXdWYWx1ZS5oYXNPd25Qcm9w
        ZXJ0eShwcm9wKSkgeyBjb250aW51ZTsgfQogICAgICAgICAgZXhpc3RpbmdW
        YWx1ZVtwcm9wXSA9IG5ld1ZhbHVlW3Byb3BdOwogICAgICAgIH0KICAgICAg
        fSkKICAgIH0pOwoKICBUaGUgZnVuY3Rpb24gcGFzc2VkIHRvIGBnZW5lcmF0
        ZU1hcEZ1bmN0aW9uRm9yYCBpcyBpbnZva2VkIGV2ZXJ5IHRpbWUgYQogIG5l
        dyB2YWx1ZSBpcyBhZGRlZCB0byB0aGUgbWFwLgoKICBAY2xhc3MgX01hcHBh
        YmxlCiAgQHByaXZhdGUKICBAbmFtZXNwYWNlIERTCioqLwpEUy5fTWFwcGFi
        bGUgPSBFbWJlci5NaXhpbi5jcmVhdGUoewogIGNyZWF0ZUluc3RhbmNlTWFw
        Rm9yOiBmdW5jdGlvbihtYXBOYW1lKSB7CiAgICB2YXIgaW5zdGFuY2VNZXRh
        ID0gZ2V0TWFwcGFibGVNZXRhKHRoaXMpOwoKICAgIGluc3RhbmNlTWV0YS52
        YWx1ZXMgPSBpbnN0YW5jZU1ldGEudmFsdWVzIHx8IHt9OwoKICAgIGlmIChp
        bnN0YW5jZU1ldGEudmFsdWVzW21hcE5hbWVdKSB7IHJldHVybiBpbnN0YW5j
        ZU1ldGEudmFsdWVzW21hcE5hbWVdOyB9CgogICAgdmFyIGluc3RhbmNlTWFw
        ID0gaW5zdGFuY2VNZXRhLnZhbHVlc1ttYXBOYW1lXSA9IG5ldyBFbWJlci5N
        YXAoKTsKCiAgICB2YXIga2xhc3MgPSB0aGlzLmNvbnN0cnVjdG9yOwoKICAg
        IHdoaWxlIChrbGFzcyAmJiBrbGFzcyAhPT0gRFMuU3RvcmUpIHsKICAgICAg
        dGhpcy5fY29weU1hcChtYXBOYW1lLCBrbGFzcywgaW5zdGFuY2VNYXApOwog
        ICAgICBrbGFzcyA9IGtsYXNzLnN1cGVyY2xhc3M7CiAgICB9CgogICAgaW5z
        dGFuY2VNZXRhLnZhbHVlc1ttYXBOYW1lXSA9IGluc3RhbmNlTWFwOwogICAg
        cmV0dXJuIGluc3RhbmNlTWFwOwogIH0sCgogIF9jb3B5TWFwOiBmdW5jdGlv
        bihtYXBOYW1lLCBrbGFzcywgaW5zdGFuY2VNYXApIHsKICAgIHZhciBjbGFz
        c01ldGEgPSBnZXRNYXBwYWJsZU1ldGEoa2xhc3MpOwoKICAgIHZhciBjbGFz
        c01hcCA9IGNsYXNzTWV0YVttYXBOYW1lXTsKICAgIGlmIChjbGFzc01hcCkg
        ewogICAgICBjbGFzc01hcC5mb3JFYWNoKGVhY2hNYXAsIHRoaXMpOwogICAg
        fQoKICAgIGZ1bmN0aW9uIGVhY2hNYXAoa2V5LCB2YWx1ZSkgewogICAgICB2
        YXIgdHJhbnNmb3JtZWRLZXkgPSAoa2xhc3MudHJhbnNmb3JtTWFwS2V5IHx8
        IHRyYW5zZm9ybU1hcEtleSkoa2V5LCB2YWx1ZSk7CiAgICAgIHZhciB0cmFu
        c2Zvcm1lZFZhbHVlID0gKGtsYXNzLnRyYW5zZm9ybU1hcFZhbHVlIHx8IHRy
        YW5zZm9ybU1hcFZhbHVlKShrZXksIHZhbHVlKTsKCiAgICAgIHZhciBvbGRW
        YWx1ZSA9IGluc3RhbmNlTWFwLmdldCh0cmFuc2Zvcm1lZEtleSk7CiAgICAg
        IHZhciBuZXdWYWx1ZSA9IHRyYW5zZm9ybWVkVmFsdWU7CgogICAgICBpZiAo
        b2xkVmFsdWUpIHsKICAgICAgICBuZXdWYWx1ZSA9ICh0aGlzLmNvbnN0cnVj
        dG9yLnJlc29sdmVNYXBDb25mbGljdCB8fCByZXNvbHZlTWFwQ29uZmxpY3Qp
        KG9sZFZhbHVlLCBuZXdWYWx1ZSk7CiAgICAgIH0KCiAgICAgIGluc3RhbmNl
        TWFwLnNldCh0cmFuc2Zvcm1lZEtleSwgbmV3VmFsdWUpOwogICAgfQogIH0K
        Cgp9KTsKCkRTLl9NYXBwYWJsZS5nZW5lcmF0ZU1hcEZ1bmN0aW9uRm9yID0g
        ZnVuY3Rpb24obWFwTmFtZSwgdHJhbnNmb3JtKSB7CiAgcmV0dXJuIGZ1bmN0
        aW9uKGtleSwgdmFsdWUpIHsKICAgIHZhciBtZXRhID0gZ2V0TWFwcGFibGVN
        ZXRhKHRoaXMpOwoKICAgIHZhciBtYXAgPSBtZXRhW21hcE5hbWVdIHx8IEVt
        YmVyLk1hcFdpdGhEZWZhdWx0LmNyZWF0ZSh7CiAgICAgIGRlZmF1bHRWYWx1
        ZTogZnVuY3Rpb24oKSB7IHJldHVybiB7fTsgfQogICAgfSk7CgogICAgdHJh
        bnNmb3JtLmNhbGwodGhpcywga2V5LCB2YWx1ZSwgbWFwKTsKCiAgICBtZXRh
        W21hcE5hbWVdID0gbWFwOwogIH07Cn07CgpmdW5jdGlvbiBnZXRNYXBwYWJs
        ZU1ldGEob2JqKSB7CiAgdmFyIG1ldGEgPSBFbWJlci5tZXRhKG9iaiwgdHJ1
        ZSksCiAgICAgIGtleU5hbWUgPSAnRFMuTWFwcGFibGUnLAogICAgICB2YWx1
        ZSA9IG1ldGFba2V5TmFtZV07CgogIGlmICghdmFsdWUpIHsgbWV0YVtrZXlO
        YW1lXSA9IHt9OyB9CgogIGlmICghbWV0YS5oYXNPd25Qcm9wZXJ0eShrZXlO
        YW1lKSkgewogICAgbWV0YVtrZXlOYW1lXSA9IEVtYmVyLmNyZWF0ZShtZXRh
        W2tleU5hbWVdKTsKICB9CgogIHJldHVybiBtZXRhW2tleU5hbWVdOwp9Cgp9
        KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qZ2xvYmFscyBFbWJlciovCi8qanNo
        aW50IGVxbnVsbDp0cnVlKi8KLyoqCiAgQG1vZHVsZSBlbWJlci1kYXRhCiov
        Cgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CnZhciBv
        bmNlID0gRW1iZXIucnVuLm9uY2U7CnZhciBpc05vbmUgPSBFbWJlci5pc05v
        bmU7CnZhciBmb3JFYWNoID0gRW1iZXIuRW51bWVyYWJsZVV0aWxzLmZvckVh
        Y2g7CnZhciBpbmRleE9mID0gRW1iZXIuRW51bWVyYWJsZVV0aWxzLmluZGV4
        T2Y7CnZhciBtYXAgPSBFbWJlci5FbnVtZXJhYmxlVXRpbHMubWFwOwp2YXIg
        T3JkZXJlZFNldCA9IEVtYmVyLk9yZGVyZWRTZXQ7CnZhciByZXNvbHZlID0g
        RW1iZXIuUlNWUC5yZXNvbHZlOwoKLy8gSW1wbGVtZW50b3JzIE5vdGU6Ci8v
        Ci8vICAgVGhlIHZhcmlhYmxlcyBpbiB0aGlzIGZpbGUgYXJlIGNvbnNpc3Rl
        bnRseSBuYW1lZCBhY2NvcmRpbmcgdG8gdGhlIGZvbGxvd2luZwovLyAgIHNj
        aGVtZToKLy8KLy8gICAqICtpZCsgbWVhbnMgYW4gaWRlbnRpZmllciBtYW5h
        Z2VkIGJ5IGFuIGV4dGVybmFsIHNvdXJjZSwgcHJvdmlkZWQgaW5zaWRlCi8v
        ICAgICB0aGUgZGF0YSBwcm92aWRlZCBieSB0aGF0IHNvdXJjZS4gVGhlc2Ug
        YXJlIGFsd2F5cyBjb2VyY2VkIHRvIGJlIHN0cmluZ3MKLy8gICAgIGJlZm9y
        ZSBiZWluZyB1c2VkIGludGVybmFsbHkuCi8vICAgKiArY2xpZW50SWQrIG1l
        YW5zIGEgdHJhbnNpZW50IG51bWVyaWNhbCBpZGVudGlmaWVyIGdlbmVyYXRl
        ZCBhdCBydW50aW1lIGJ5Ci8vICAgICB0aGUgZGF0YSBzdG9yZS4gSXQgaXMg
        aW1wb3J0YW50IHByaW1hcmlseSBiZWNhdXNlIG5ld2x5IGNyZWF0ZWQgb2Jq
        ZWN0cyBtYXkKLy8gICAgIG5vdCB5ZXQgaGF2ZSBhbiBleHRlcm5hbGx5IGdl
        bmVyYXRlZCBpZC4KLy8gICAqICtyZWZlcmVuY2UrIG1lYW5zIGEgcmVjb3Jk
        IHJlZmVyZW5jZSBvYmplY3QsIHdoaWNoIGhvbGRzIG1ldGFkYXRhIGFib3V0
        IGEKLy8gICAgIHJlY29yZCwgZXZlbiBpZiBpdCBoYXMgbm90IHlldCBiZWVu
        IGZ1bGx5IG1hdGVyaWFsaXplZC4KLy8gICAqICt0eXBlKyBtZWFucyBhIHN1
        YmNsYXNzIG9mIERTLk1vZGVsLgoKLy8gVXNlZCBieSB0aGUgc3RvcmUgdG8g
        bm9ybWFsaXplIElEcyBlbnRlcmluZyB0aGUgc3RvcmUuICBEZXNwaXRlIHRo
        ZSBmYWN0Ci8vIHRoYXQgZGV2ZWxvcGVycyBtYXkgcHJvdmlkZSBJRHMgYXMg
        bnVtYmVycyAoZS5nLiwgYHN0b3JlLmZpbmQoUGVyc29uLCAxKWApLAovLyBp
        dCBpcyBpbXBvcnRhbnQgdGhhdCBpbnRlcm5hbGx5IHdlIHVzZSBzdHJpbmdz
        LCBzaW5jZSBJRHMgbWF5IGJlIHNlcmlhbGl6ZWQKLy8gYW5kIGxvc2UgdHlw
        ZSBpbmZvcm1hdGlvbi4gIEZvciBleGFtcGxlLCBFbWJlcidzIHJvdXRlciBt
        YXkgcHV0IGEgcmVjb3JkJ3MKLy8gSUQgaW50byB0aGUgVVJMLCBhbmQgaWYg
        d2UgbGF0ZXIgdHJ5IHRvIGRlc2VyaWFsaXplIHRoYXQgVVJMIGFuZCBmaW5k
        IHRoZQovLyBjb3JyZXNwb25kaW5nIHJlY29yZCwgd2Ugd2lsbCBub3Qga25v
        dyBpZiBpdCBpcyBhIHN0cmluZyBvciBhIG51bWJlci4KdmFyIGNvZXJjZUlk
        ID0gZnVuY3Rpb24oaWQpIHsKICByZXR1cm4gaWQgPT0gbnVsbCA/IG51bGwg
        OiBpZCsnJzsKfTsKCi8qKgogIFRoZSBzdG9yZSBjb250YWlucyBhbGwgb2Yg
        dGhlIGRhdGEgZm9yIHJlY29yZHMgbG9hZGVkIGZyb20gdGhlIHNlcnZlci4K
        ICBJdCBpcyBhbHNvIHJlc3BvbnNpYmxlIGZvciBjcmVhdGluZyBpbnN0YW5j
        ZXMgb2YgRFMuTW9kZWwgdGhhdCB3cmFwCiAgdGhlIGluZGl2aWR1YWwgZGF0
        YSBmb3IgYSByZWNvcmQsIHNvIHRoYXQgdGhleSBjYW4gYmUgYm91bmQgdG8g
        aW4geW91cgogIEhhbmRsZWJhcnMgdGVtcGxhdGVzLgoKICBEZWZpbmUgeW91
        ciBhcHBsaWNhdGlvbidzIHN0b3JlIGxpa2UgdGhpczoKCiAgICAgICBNeUFw
        cC5TdG9yZSA9IERTLlN0b3JlLmV4dGVuZCgpOwoKICBNb3N0IEVtYmVyLmpz
        IGFwcGxpY2F0aW9ucyB3aWxsIG9ubHkgaGF2ZSBhIHNpbmdsZSBgRFMuU3Rv
        cmVgIHRoYXQgaXMKICBhdXRvbWF0aWNhbGx5IGNyZWF0ZWQgYnkgdGhlaXIg
        YEVtYmVyLkFwcGxpY2F0aW9uYC4KCiAgWW91IGNhbiByZXRyaWV2ZSBtb2Rl
        bHMgZnJvbSB0aGUgc3RvcmUgaW4gc2V2ZXJhbCB3YXlzLiBUbyByZXRyaWV2
        ZSBhIHJlY29yZAogIGZvciBhIHNwZWNpZmljIGlkLCB1c2UgYERTLk1vZGVs
        YCdzIGBmaW5kKClgIG1ldGhvZDoKCiAgICAgICB2YXIgcGVyc29uID0gQXBw
        LlBlcnNvbi5maW5kKDEyMyk7CgogIElmIHlvdXIgYXBwbGljYXRpb24gaGFz
        IG11bHRpcGxlIGBEUy5TdG9yZWAgaW5zdGFuY2VzIChhbiB1bnVzdWFsIGNh
        c2UpLCB5b3UgY2FuCiAgc3BlY2lmeSB3aGljaCBzdG9yZSBzaG91bGQgYmUg
        dXNlZDoKCiAgICAgIHZhciBwZXJzb24gPSBzdG9yZS5maW5kKEFwcC5QZXJz
        b24sIDEyMyk7CgogIEluIGdlbmVyYWwsIHlvdSBzaG91bGQgcmV0cmlldmUg
        bW9kZWxzIHVzaW5nIHRoZSBtZXRob2RzIG9uIGBEUy5Nb2RlbGA7IHlvdSBz
        aG91bGQKICByYXJlbHkgbmVlZCB0byBpbnRlcmFjdCB3aXRoIHRoZSBzdG9y
        ZSBkaXJlY3RseS4KCiAgQnkgZGVmYXVsdCwgdGhlIHN0b3JlIHdpbGwgdGFs
        ayB0byB5b3VyIGJhY2tlbmQgdXNpbmcgYSBzdGFuZGFyZCBSRVNUIG1lY2hh
        bmlzbS4KICBZb3UgY2FuIGN1c3RvbWl6ZSBob3cgdGhlIHN0b3JlIHRhbGtz
        IHRvIHlvdXIgYmFja2VuZCBieSBzcGVjaWZ5aW5nIGEgY3VzdG9tIGFkYXB0
        ZXI6CgogICAgICAgTXlBcHAuc3RvcmUgPSBEUy5TdG9yZS5jcmVhdGUoewog
        ICAgICAgICBhZGFwdGVyOiAnTXlBcHAuQ3VzdG9tQWRhcHRlcicKICAgICAg
        IH0pOwoKICBZb3UgY2FuIGxlYXJuIG1vcmUgYWJvdXQgd3JpdGluZyBhIGN1
        c3RvbSBhZGFwdGVyIGJ5IHJlYWRpbmcgdGhlIGBEUy5BZGFwdGVyYAogIGRv
        Y3VtZW50YXRpb24uCgogIEBjbGFzcyBTdG9yZQogIEBuYW1lc3BhY2UgRFMK
        ICBAZXh0ZW5kcyBFbWJlci5PYmplY3QKICBAdXNlcyBEUy5fTWFwcGFibGUK
        Ki8KRFMuU3RvcmUgPSBFbWJlci5PYmplY3QuZXh0ZW5kKERTLl9NYXBwYWJs
        ZSwgewoKICAvKioKICAgIEBtZXRob2QgaW5pdAogICAgQHByaXZhdGUKICAq
        LwogIGluaXQ6IGZ1bmN0aW9uKCkgewogICAgLy8gaW50ZXJuYWwgYm9va2tl
        ZXBpbmc7IG5vdCBvYnNlcnZhYmxlCiAgICB0aGlzLnR5cGVNYXBzID0ge307
        CiAgICB0aGlzLnJlY29yZEFycmF5TWFuYWdlciA9IERTLlJlY29yZEFycmF5
        TWFuYWdlci5jcmVhdGUoewogICAgICBzdG9yZTogdGhpcwogICAgfSk7CiAg
        ICB0aGlzLl9yZWxhdGlvbnNoaXBDaGFuZ2VzID0ge307CiAgICB0aGlzLl9w
        ZW5kaW5nU2F2ZSA9IFtdOwogIH0sCgogIC8qKgogICAgVGhlIGFkYXB0ZXIg
        dG8gdXNlIHRvIGNvbW11bmljYXRlIHRvIGEgYmFja2VuZCBzZXJ2ZXIgb3Ig
        b3RoZXIgcGVyc2lzdGVuY2UgbGF5ZXIuCgogICAgVGhpcyBjYW4gYmUgc3Bl
        Y2lmaWVkIGFzIGFuIGluc3RhbmNlLCBjbGFzcywgb3Igc3RyaW5nLgoKICAg
        IElmIHlvdSB3YW50IHRvIHNwZWNpZnkgYEFwcC5DdXN0b21BZGFwdGVyYCBh
        cyBhIHN0cmluZywgZG86CgogICAgYGBganMKICAgIGFkYXB0ZXI6ICdjdXN0
        b20nCiAgICBgYGAKCiAgICBAcHJvcGVydHkgYWRhcHRlcgogICAgQGRlZmF1
        bHQgRFMuUkVTVEFkYXB0ZXIKICAgIEB0eXBlIHtEUy5BZGFwdGVyfFN0cmlu
        Z30KICAqLwogIGFkYXB0ZXI6ICdfcmVzdCcsCgogIC8qKgogICAgUmV0dXJu
        cyBhIEpTT04gcmVwcmVzZW50YXRpb24gb2YgdGhlIHJlY29yZCB1c2luZyBh
        IGN1c3RvbQogICAgdHlwZS1zcGVjaWZpYyBzZXJpYWxpemVyLCBpZiBvbmUg
        ZXhpc3RzLgoKICAgIFRoZSBhdmFpbGFibGUgb3B0aW9ucyBhcmU6CgogICAg
        KiBgaW5jbHVkZUlkYDogYHRydWVgIGlmIHRoZSByZWNvcmQncyBJRCBzaG91
        bGQgYmUgaW5jbHVkZWQgaW4KICAgICAgdGhlIEpTT04gcmVwcmVzZW50YXRp
        b24KCiAgICBAbWV0aG9kIHNlcmlhbGl6ZQogICAgQHByaXZhdGUKICAgIEBw
        YXJhbSB7RFMuTW9kZWx9IHJlY29yZCB0aGUgcmVjb3JkIHRvIHNlcmlhbGl6
        ZQogICAgQHBhcmFtIHtPYmplY3R9IG9wdGlvbnMgYW4gb3B0aW9ucyBoYXNo
        CiAgKi8KICBzZXJpYWxpemU6IGZ1bmN0aW9uKHJlY29yZCwgb3B0aW9ucykg
        ewogICAgcmV0dXJuIHRoaXMuc2VyaWFsaXplckZvcihyZWNvcmQuY29uc3Ry
        dWN0b3IudHlwZUtleSkuc2VyaWFsaXplKHJlY29yZCwgb3B0aW9ucyk7CiAg
        fSwKCiAgLyoqCiAgICBUaGlzIHByb3BlcnR5IHJldHVybnMgdGhlIGFkYXB0
        ZXIsIGFmdGVyIHJlc29sdmluZyBhIHBvc3NpYmxlCiAgICBzdHJpbmcga2V5
        LgoKICAgIElmIHRoZSBzdXBwbGllZCBgYWRhcHRlcmAgd2FzIGEgY2xhc3Ms
        IG9yIGEgU3RyaW5nIHByb3BlcnR5CiAgICBwYXRoIHJlc29sdmVkIHRvIGEg
        Y2xhc3MsIHRoaXMgcHJvcGVydHkgd2lsbCBpbnN0YW50aWF0ZSB0aGUKICAg
        IGNsYXNzLgoKICAgIFRoaXMgcHJvcGVydHkgaXMgY2FjaGVhYmxlLCBzbyB0
        aGUgc2FtZSBpbnN0YW5jZSBvZiBhIHNwZWNpZmllZAogICAgYWRhcHRlciBj
        bGFzcyBzaG91bGQgYmUgdXNlZCBmb3IgdGhlIGxpZmV0aW1lIG9mIHRoZSBz
        dG9yZS4KCiAgICBAcHJvcGVydHkgX2FkYXB0ZXIKICAgIEBwcml2YXRlCiAg
        ICBAcmV0dXJucyBEUy5BZGFwdGVyCiAgKi8KICBfYWRhcHRlcjogRW1iZXIu
        Y29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICB2YXIgYWRhcHRlciA9IGdldCh0
        aGlzLCAnYWRhcHRlcicpOwogICAgaWYgKHR5cGVvZiBhZGFwdGVyID09PSAn
        c3RyaW5nJykgewogICAgICBhZGFwdGVyID0gdGhpcy5jb250YWluZXIubG9v
        a3VwKCdhZGFwdGVyOicgKyBhZGFwdGVyKSB8fCB0aGlzLmNvbnRhaW5lci5s
        b29rdXAoJ2FkYXB0ZXI6YXBwbGljYXRpb24nKSB8fCB0aGlzLmNvbnRhaW5l
        ci5sb29rdXAoJ2FkYXB0ZXI6X3Jlc3QnKTsKICAgIH0KCiAgICBpZiAoRFMu
        QWRhcHRlci5kZXRlY3QoYWRhcHRlcikpIHsKICAgICAgYWRhcHRlciA9IGFk
        YXB0ZXIuY3JlYXRlKHsgY29udGFpbmVyOiB0aGlzLmNvbnRhaW5lciB9KTsK
        ICAgIH0KCiAgICByZXR1cm4gYWRhcHRlcjsKICB9KS5wcm9wZXJ0eSgnYWRh
        cHRlcicpLAoKICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4KICAvLyAuIENS
        RUFURSBORVcgUkVDT1JEIC4KICAvLyAuLi4uLi4uLi4uLi4uLi4uLi4uLi4K
        CiAgLyoqCiAgICBDcmVhdGUgYSBuZXcgcmVjb3JkIGluIHRoZSBjdXJyZW50
        IHN0b3JlLiBUaGUgcHJvcGVydGllcyBwYXNzZWQKICAgIHRvIHRoaXMgbWV0
        aG9kIGFyZSBzZXQgb24gdGhlIG5ld2x5IGNyZWF0ZWQgcmVjb3JkLgoKICAg
        IFRvIGNyZWF0ZSBhIG5ldyBpbnN0YW5jZSBvZiBgQXBwLlBvc3RgOgoKICAg
        IGBgYGpzCiAgICBzdG9yZS5jcmVhdGVSZWNvcmQoJ3Bvc3QnLCB7CiAgICAg
        IHRpdGxlOiAiUmFpbHMgaXMgb21ha2FzZSIKICAgIH0pOwogICAgYGBgCgog
        ICAgQG1ldGhvZCBjcmVhdGVSZWNvcmQKICAgIEBwYXJhbSB7U3RyaW5nfSB0
        eXBlCiAgICBAcGFyYW0ge09iamVjdH0gcHJvcGVydGllcyBhIGhhc2ggb2Yg
        cHJvcGVydGllcyB0byBzZXQgb24gdGhlCiAgICAgIG5ld2x5IGNyZWF0ZWQg
        cmVjb3JkLgogICAgQHJldHVybnMgRFMuTW9kZWwKICAqLwogIGNyZWF0ZVJl
        Y29yZDogZnVuY3Rpb24odHlwZSwgcHJvcGVydGllcykgewogICAgdHlwZSA9
        IHRoaXMubW9kZWxGb3IodHlwZSk7CgogICAgcHJvcGVydGllcyA9IHByb3Bl
        cnRpZXMgfHwge307CgogICAgLy8gSWYgdGhlIHBhc3NlZCBwcm9wZXJ0aWVz
        IGRvIG5vdCBpbmNsdWRlIGEgcHJpbWFyeSBrZXksCiAgICAvLyBnaXZlIHRo
        ZSBhZGFwdGVyIGFuIG9wcG9ydHVuaXR5IHRvIGdlbmVyYXRlIG9uZS4gVHlw
        aWNhbGx5LAogICAgLy8gY2xpZW50LXNpZGUgSUQgZ2VuZXJhdG9ycyB3aWxs
        IHVzZSBzb21ldGhpbmcgbGlrZSB1dWlkLmpzCiAgICAvLyB0byBhdm9pZCBj
        b25mbGljdHMuCgogICAgaWYgKGlzTm9uZShwcm9wZXJ0aWVzLmlkKSkgewog
        ICAgICBwcm9wZXJ0aWVzLmlkID0gdGhpcy5fZ2VuZXJhdGVJZCh0eXBlKTsK
        ICAgIH0KCiAgICAvLyBDb2VyY2UgSUQgdG8gYSBzdHJpbmcKICAgIHByb3Bl
        cnRpZXMuaWQgPSBjb2VyY2VJZChwcm9wZXJ0aWVzLmlkKTsKCiAgICB2YXIg
        cmVjb3JkID0gdGhpcy5idWlsZFJlY29yZCh0eXBlLCBwcm9wZXJ0aWVzLmlk
        KTsKCiAgICAvLyBNb3ZlIHRoZSByZWNvcmQgb3V0IG9mIGl0cyBpbml0aWFs
        IGBlbXB0eWAgc3RhdGUgaW50bwogICAgLy8gdGhlIGBsb2FkZWRgIHN0YXRl
        LgogICAgcmVjb3JkLmxvYWRlZERhdGEoKTsKCiAgICAvLyBTZXQgdGhlIHBy
        b3BlcnRpZXMgc3BlY2lmaWVkIG9uIHRoZSByZWNvcmQuCiAgICByZWNvcmQu
        c2V0UHJvcGVydGllcyhwcm9wZXJ0aWVzKTsKCiAgICByZXR1cm4gcmVjb3Jk
        OwogIH0sCgogIC8qKgogICAgSWYgcG9zc2libGUsIHRoaXMgbWV0aG9kIGFz
        a3MgdGhlIGFkYXB0ZXIgdG8gZ2VuZXJhdGUgYW4gSUQgZm9yCiAgICBhIG5l
        d2x5IGNyZWF0ZWQgcmVjb3JkLgoKICAgIEBtZXRob2QgZ2VuZXJhdGVJZAog
        ICAgQHBhcmFtIHtTdHJpbmd9IHR5cGUKICAgIEByZXR1cm5zIFN0cmluZyBp
        ZiB0aGUgYWRhcHRlciBjYW4gZ2VuZXJhdGUgb25lLCBhbiBJRAogICovCiAg
        X2dlbmVyYXRlSWQ6IGZ1bmN0aW9uKHR5cGUpIHsKICAgIHZhciBhZGFwdGVy
        ID0gdGhpcy5hZGFwdGVyRm9yVHlwZSh0eXBlKTsKCiAgICBpZiAoYWRhcHRl
        ciAmJiBhZGFwdGVyLmdlbmVyYXRlSWRGb3JSZWNvcmQpIHsKICAgICAgcmV0
        dXJuIGFkYXB0ZXIuZ2VuZXJhdGVJZEZvclJlY29yZCh0aGlzKTsKICAgIH0K
        CiAgICByZXR1cm4gbnVsbDsKICB9LAoKICAvLyAuLi4uLi4uLi4uLi4uLi4u
        LgogIC8vIC4gREVMRVRFIFJFQ09SRCAuCiAgLy8gLi4uLi4uLi4uLi4uLi4u
        Li4KCiAgLyoqCiAgICBGb3Igc3ltbWV0cnksIGEgcmVjb3JkIGNhbiBiZSBk
        ZWxldGVkIHZpYSB0aGUgc3RvcmUuCgogICAgQG1ldGhvZCBkZWxldGVSZWNv
        cmQKICAgIEBwYXJhbSB7RFMuTW9kZWx9IHJlY29yZAogICovCiAgZGVsZXRl
        UmVjb3JkOiBmdW5jdGlvbihyZWNvcmQpIHsKICAgIHJlY29yZC5kZWxldGVS
        ZWNvcmQoKTsKICB9LAoKICAvKioKICAgIEZvciBzeW1tZXRyeSwgYSByZWNv
        cmQgY2FuIGJlIHVubG9hZGVkIHZpYSB0aGUgc3RvcmUuCgogICAgQG1ldGhv
        ZCB1bmxvYWRSZWNvcmQKICAgIEBwYXJhbSB7RFMuTW9kZWx9IHJlY29yZAog
        ICovCiAgdW5sb2FkUmVjb3JkOiBmdW5jdGlvbihyZWNvcmQpIHsKICAgIHJl
        Y29yZC51bmxvYWRSZWNvcmQoKTsKICB9LAoKICAvLyAuLi4uLi4uLi4uLi4u
        Li4uCiAgLy8gLiBGSU5EIFJFQ09SRFMgLgogIC8vIC4uLi4uLi4uLi4uLi4u
        Li4KCiAgLyoqCiAgICBUaGlzIGlzIHRoZSBtYWluIGVudHJ5IHBvaW50IGlu
        dG8gZmluZGluZyByZWNvcmRzLiBUaGUgZmlyc3QgcGFyYW1ldGVyIHRvCiAg
        ICB0aGlzIG1ldGhvZCBpcyB0aGUgbW9kZWwncyBuYW1lIGFzIGEgc3RyaW5n
        LgoKICAgIC0tLQoKICAgIFRvIGZpbmQgYSByZWNvcmQgYnkgSUQsIHBhc3Mg
        dGhlIGBpZGAgYXMgdGhlIHNlY29uZCBwYXJhbWV0ZXI6CgogICAgICAgIHN0
        b3JlLmZpbmQoJ3BlcnNvbicsIDEpOwoKICAgIFRoZSBgZmluZGAgbWV0aG9k
        IHdpbGwgYWx3YXlzIHJldHVybiBhICoqcHJvbWlzZSoqIHRoYXQgd2lsbCBi
        ZSByZXNvbHZlZAogICAgd2l0aCB0aGUgcmVjb3JkLiBJZiB0aGUgcmVjb3Jk
        IHdhcyBhbHJlYWR5IGluIHRoZSBzdG9yZSwgdGhlIHByb21pc2Ugd2lsbAog
        ICAgYmUgcmVzb2x2ZWQgaW1tZWRpYXRlbHkuIE90aGVyd2lzZSwgdGhlIHN0
        b3JlIHdpbGwgYXNrIHRoZSBhZGFwdGVyJ3MgYGZpbmRgCiAgICBtZXRob2Qg
        dG8gZmluZCB0aGUgbmVjZXNzYXJ5IGRhdGEuCgogICAgVGhlIGBmaW5kYCBt
        ZXRob2Qgd2lsbCBhbHdheXMgcmVzb2x2ZSBpdHMgcHJvbWlzZSB3aXRoIHRo
        ZSBzYW1lIG9iamVjdCBmb3IKICAgIGEgZ2l2ZW4gdHlwZSBhbmQgYGlkYC4K
        CiAgICAtLS0KCiAgICBUbyBmaW5kIGFsbCByZWNvcmRzIGZvciBhIHR5cGUs
        IGNhbGwgYGZpbmRgIHdpdGggbm8gYWRkaXRpb25hbCBwYXJhbWV0ZXJzOgoK
        ICAgICAgICBzdG9yZS5maW5kKCdwZXJzb24nKTsKCiAgICBUaGlzIHdpbGwg
        YXNrIHRoZSBhZGFwdGVyJ3MgYGZpbmRBbGxgIG1ldGhvZCB0byBmaW5kIHRo
        ZSByZWNvcmRzIGZvciB0aGUKICAgIGdpdmVuIHR5cGUsIGFuZCByZXR1cm4g
        YSBwcm9taXNlIHRoYXQgd2lsbCBiZSByZXNvbHZlZCBvbmNlIHRoZSBzZXJ2
        ZXIKICAgIHJldHVybnMgdGhlIHZhbHVlcy4KCiAgICAtLS0KCiAgICBUbyBm
        aW5kIGEgcmVjb3JkIGJ5IGEgcXVlcnksIGNhbGwgYGZpbmRgIHdpdGggYSBo
        YXNoIGFzIHRoZSBzZWNvbmQKICAgIHBhcmFtZXRlcjoKCiAgICAgICAgc3Rv
        cmUuZmluZChBcHAuUGVyc29uLCB7IHBhZ2U6IDEgfSk7CgogICAgVGhpcyB3
        aWxsIGFzayB0aGUgYWRhcHRlcidzIGBmaW5kUXVlcnlgIG1ldGhvZCB0byBm
        aW5kIHRoZSByZWNvcmRzIGZvcgogICAgdGhlIHF1ZXJ5LCBhbmQgcmV0dXJu
        IGEgcHJvbWlzZSB0aGF0IHdpbGwgYmUgcmVzb2x2ZWQgb25jZSB0aGUgc2Vy
        dmVyCiAgICByZXNwb25kcy4KCiAgICBAbWV0aG9kIGZpbmQKICAgIEBwYXJh
        bSB7RFMuTW9kZWx9IHR5cGUKICAgIEBwYXJhbSB7T2JqZWN0fFN0cmluZ3xJ
        bnRlZ2VyfG51bGx9IGlkCiAgKi8KICBmaW5kOiBmdW5jdGlvbih0eXBlLCBp
        ZCkgewogICAgaWYgKGlkID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJu
        IHRoaXMuZmluZEFsbCh0eXBlKTsKICAgIH0KCiAgICAvLyBXZSBhcmUgcGFz
        c2VkIGEgcXVlcnkgaW5zdGVhZCBvZiBhbiBpZC4KICAgIGlmIChFbWJlci50
        eXBlT2YoaWQpID09PSAnb2JqZWN0JykgewogICAgICByZXR1cm4gdGhpcy5m
        aW5kUXVlcnkodHlwZSwgaWQpOwogICAgfQoKICAgIHJldHVybiB0aGlzLmZp
        bmRCeUlkKHR5cGUsIGNvZXJjZUlkKGlkKSk7CiAgfSwKCiAgLyoqCiAgICBU
        aGlzIG1ldGhvZCByZXR1cm5zIGEgcmVjb3JkIGZvciBhIGdpdmVuIHR5cGUg
        YW5kIGlkIGNvbWJpbmF0aW9uLgoKICAgIEBtZXRob2QgZmluZEJ5SWQKICAg
        IEBwcml2YXRlCiAgICBAcGFyYW0gdHlwZQogICAgQHBhcmFtIGlkCiAgKi8K
        ICBmaW5kQnlJZDogZnVuY3Rpb24odHlwZSwgaWQpIHsKICAgIHR5cGUgPSB0
        aGlzLm1vZGVsRm9yKHR5cGUpOwoKICAgIHZhciByZWNvcmQgPSB0aGlzLmdl
        dEJ5SWQodHlwZSwgaWQpOwogICAgaWYgKGdldChyZWNvcmQsICdpc0VtcHR5
        JykpIHsKICAgICAgcmV0dXJuIHByb21pc2VPYmplY3QodGhpcy5mZXRjaFJl
        Y29yZChyZWNvcmQpKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBwcm9t
        aXNlT2JqZWN0KHJlc29sdmUocmVjb3JkKSk7CiAgICB9CiAgfSwKCiAgLyoq
        CiAgICBUaGlzIG1ldGhvZCBtYWtlcyBhIHNlcmllcyBvZiByZXF1ZXN0cyB0
        byB0aGUgYWRhcHRlcidzIGBmaW5kYCBtZXRob2QKICAgIGFuZCByZXR1cm5z
        IGEgcHJvbWlzZSB0aGF0IHJlc29sdmVzIG9uY2UgdGhleSBhcmUgYWxsIGxv
        YWRlZC4KCiAgICBAbWV0aG9kIGZpbmRCeUlkcwogICAgQHBhcmFtIHtTdHJp
        bmd9IHR5cGUKICAgIEBwYXJhbSB7QXJyYXl9IGlkcwogICAgQHJldHVybnMg
        UHJvbWlzZQogICovCiAgZmluZEJ5SWRzOiBmdW5jdGlvbih0eXBlLCBpZHMp
        IHsKICAgIHZhciBzdG9yZSA9IHRoaXM7CgogICAgcmV0dXJuIHByb21pc2VB
        cnJheShFbWJlci5SU1ZQLmFsbChtYXAoaWRzLCBmdW5jdGlvbihpZCkgewog
        ICAgICByZXR1cm4gc3RvcmUuZmluZEJ5SWQodHlwZSwgaWQpOwogICAgfSkp
        LnRoZW4oZnVuY3Rpb24oYXJyYXkpIHsKICAgICAgcmV0dXJuIEVtYmVyLkEo
        YXJyYXkpOwogICAgfSkpOwogIH0sCgogIC8qKgogICAgVGhpcyBtZXRob2Qg
        aXMgY2FsbGVkIGJ5IGBmaW5kQnlJZGAgaWYgaXQgZGlzY292ZXJzIHRoYXQg
        YSBwYXJ0aWN1bGFyCiAgICB0eXBlL2lkIHBhaXIgaGFzbid0IGJlZW4gbG9h
        ZGVkIHlldCB0byBraWNrIG9mZiBhIHJlcXVlc3QgdG8gdGhlCiAgICBhZGFw
        dGVyLgoKICAgIEBtZXRob2QgZmV0Y2hSZWNvcmQKICAgIEBwcml2YXRlCiAg
        ICBAcGFyYW0ge0RTLk1vZGVsfSByZWNvcmQKICAgIEByZXR1cm5zIFByb21p
        c2UKICAqLwogIGZldGNoUmVjb3JkOiBmdW5jdGlvbihyZWNvcmQpIHsKICAg
        IHZhciB0eXBlID0gcmVjb3JkLmNvbnN0cnVjdG9yLAogICAgICAgIGlkID0g
        Z2V0KHJlY29yZCwgJ2lkJyksCiAgICAgICAgcmVzb2x2ZXIgPSBFbWJlci5S
        U1ZQLmRlZmVyKCk7CgogICAgcmVjb3JkLmxvYWRpbmdEYXRhKCk7CgogICAg
        dmFyIGFkYXB0ZXIgPSB0aGlzLmFkYXB0ZXJGb3JUeXBlKHR5cGUpOwoKICAg
        IEVtYmVyLmFzc2VydCgiWW91IHRyaWVkIHRvIGZpbmQgYSByZWNvcmQgYnV0
        IHlvdSBoYXZlIG5vIGFkYXB0ZXIgKGZvciAiICsgdHlwZSArICIpIiwgYWRh
        cHRlcik7CiAgICBFbWJlci5hc3NlcnQoIllvdSB0cmllZCB0byBmaW5kIGEg
        cmVjb3JkIGJ1dCB5b3VyIGFkYXB0ZXIgKGZvciAiICsgdHlwZSArICIpIGRv
        ZXMgbm90IGltcGxlbWVudCAnZmluZCciLCBhZGFwdGVyLmZpbmQpOwoKICAg
        IF9maW5kKGFkYXB0ZXIsIHRoaXMsIHR5cGUsIGlkLCByZXNvbHZlcik7Cgog
        ICAgcmV0dXJuIHJlc29sdmVyLnByb21pc2U7CiAgfSwKCiAgLyoqCiAgICBH
        ZXQgYSByZWNvcmQgYnkgYSBnaXZlbiB0eXBlIGFuZCBJRCB3aXRob3V0IHRy
        aWdnZXJpbmcgYSBmZXRjaC4KCiAgICBUaGlzIG1ldGhvZCB3aWxsIHN5bmNo
        cm9ub3VzbHkgcmV0dXJuIHRoZSByZWNvcmQgaWYgaXQncyBhdmFpbGFibGUu
        CiAgICBPdGhlcndpc2UsIGl0IHdpbGwgcmV0dXJuIHVuZGVmaW5lZC4KCiAg
        ICBgYGBqcwogICAgdmFyIHBvc3QgPSBzdG9yZS5nZXRCeUlkKCdwb3N0Jywg
        MSk7CiAgICBgYGAKCiAgICBAbWV0aG9kIGdldEJ5SWQKICAgIEBwYXJhbSB0
        eXBlCiAgICBAcGFyYW0gaWQKICAqLwogIGdldEJ5SWQ6IGZ1bmN0aW9uKHR5
        cGUsIGlkKSB7CiAgICB0eXBlID0gdGhpcy5tb2RlbEZvcih0eXBlKTsKCiAg
        ICBpZiAodGhpcy5oYXNSZWNvcmRGb3JJZCh0eXBlLCBpZCkpIHsKICAgICAg
        cmV0dXJuIHRoaXMucmVjb3JkRm9ySWQodHlwZSwgaWQpOwogICAgfSBlbHNl
        IHsKICAgICAgcmV0dXJuIHRoaXMuYnVpbGRSZWNvcmQodHlwZSwgaWQpOwog
        ICAgfQogIH0sCgogIC8qKgogICAgVGhpcyBtZXRob2QgaXMgY2FsbGVkIGJ5
        IHRoZSByZWNvcmQncyBgcmVsb2FkYCBtZXRob2QuIFRoZSByZWNvcmQncyBg
        cmVsb2FkYAogICAgcGFzc2VzIGluIGEgcmVzb2x2ZXIgZm9yIHRoZSBwcm9t
        aXNlIGl0IHJldHVybnMuCgogICAgVGhpcyBtZXRob2QgY2FsbHMgdGhlIGFk
        YXB0ZXIncyBgZmluZGAgbWV0aG9kLCB3aGljaCByZXR1cm5zIGEgcHJvbWlz
        ZS4gV2hlbgogICAgKip0aGF0KiogcHJvbWlzZSByZXNvbHZlcywgYHJlbG9h
        ZFJlY29yZGAgd2lsbCByZXNvbHZlIHRoZSBwcm9taXNlIHJldHVybmVkCiAg
        ICBieSB0aGUgcmVjb3JkJ3MgYHJlbG9hZGAuCgogICAgQG1ldGhvZCByZWxv
        YWRSZWNvcmQKICAgIEBwcml2YXRlCiAgICBAcGFyYW0ge0RTLk1vZGVsfSBy
        ZWNvcmQKICAgIEBwYXJhbSB7UmVzb2x2ZXJ9IHJlc29sdmVyCiAgKi8KICBy
        ZWxvYWRSZWNvcmQ6IGZ1bmN0aW9uKHJlY29yZCwgcmVzb2x2ZXIpIHsKICAg
        IHZhciB0eXBlID0gcmVjb3JkLmNvbnN0cnVjdG9yLAogICAgICAgIGFkYXB0
        ZXIgPSB0aGlzLmFkYXB0ZXJGb3JUeXBlKHR5cGUpLAogICAgICAgIHN0b3Jl
        ID0gdGhpcywKICAgICAgICBpZCA9IGdldChyZWNvcmQsICdpZCcpOwoKICAg
        IEVtYmVyLmFzc2VydCgiWW91IGNhbm5vdCByZWxvYWQgYSByZWNvcmQgd2l0
        aG91dCBhbiBJRCIsIGlkKTsKICAgIEVtYmVyLmFzc2VydCgiWW91IHRyaWVk
        IHRvIHJlbG9hZCBhIHJlY29yZCBidXQgeW91IGhhdmUgbm8gYWRhcHRlciAo
        Zm9yICIgKyB0eXBlICsgIikiLCBhZGFwdGVyKTsKICAgIEVtYmVyLmFzc2Vy
        dCgiWW91IHRyaWVkIHRvIHJlbG9hZCBhIHJlY29yZCBidXQgeW91ciBhZGFw
        dGVyIGRvZXMgbm90IGltcGxlbWVudCBgZmluZGAiLCBhZGFwdGVyLmZpbmQp
        OwoKICAgIHJldHVybiBfZmluZChhZGFwdGVyLCB0aGlzLCB0eXBlLCBpZCwg
        cmVzb2x2ZXIpOwogIH0sCgogIC8qKgogICAgVGhpcyBtZXRob2QgdGFrZXMg
        YSBsaXN0IG9mIHJlY29yZHMsIGdyb3VwcyB0aGUgcmVjb3JkcyBieSB0eXBl
        LAogICAgY29udmVydHMgdGhlIHJlY29yZHMgaW50byBJRHMsIGFuZCB0aGVu
        IGludm9rZXMgdGhlIGFkYXB0ZXIncyBgZmluZE1hbnlgCiAgICBtZXRob2Qu
        CgogICAgVGhlIHJlY29yZHMgYXJlIGdyb3VwZWQgYnkgdHlwZSB0byBpbnZv
        a2UgYGZpbmRNYW55YCBvbiBhZGFwdGVycwogICAgZm9yIGVhY2ggdW5pcXVl
        IHR5cGUgaW4gcmVjb3Jkcy4KCiAgICBJdCBpcyB1c2VkIGJvdGggYnkgYSBi
        cmFuZCBuZXcgcmVsYXRpb25zaGlwICh2aWEgdGhlIGBmaW5kTWFueWAKICAg
        IG1ldGhvZCkgb3Igd2hlbiB0aGUgZGF0YSB1bmRlcmx5aW5nIGFuIGV4aXN0
        aW5nIHJlbGF0aW9uc2hpcAogICAgY2hhbmdlcy4KCiAgICBAbWV0aG9kIGZl
        dGNoTWFueQogICAgQHByaXZhdGUKICAgIEBwYXJhbSByZWNvcmRzCiAgICBA
        cGFyYW0gb3duZXIKICAqLwogIGZldGNoTWFueTogZnVuY3Rpb24ocmVjb3Jk
        cywgb3duZXIsIHJlc29sdmVyKSB7CiAgICBpZiAoIXJlY29yZHMubGVuZ3Ro
        KSB7IHJldHVybjsgfQoKICAgIC8vIEdyb3VwIEJ5IFR5cGUKICAgIHZhciBy
        ZWNvcmRzQnlUeXBlTWFwID0gRW1iZXIuTWFwV2l0aERlZmF1bHQuY3JlYXRl
        KHsKICAgICAgZGVmYXVsdFZhbHVlOiBmdW5jdGlvbigpIHsgcmV0dXJuIEVt
        YmVyLkEoKTsgfQogICAgfSk7CgogICAgZm9yRWFjaChyZWNvcmRzLCBmdW5j
        dGlvbihyZWNvcmQpIHsKICAgICAgcmVjb3Jkc0J5VHlwZU1hcC5nZXQocmVj
        b3JkLmNvbnN0cnVjdG9yKS5wdXNoKHJlY29yZCk7CiAgICB9KTsKCiAgICBm
        b3JFYWNoKHJlY29yZHNCeVR5cGVNYXAsIGZ1bmN0aW9uKHR5cGUsIHJlY29y
        ZHMpIHsKICAgICAgdmFyIGlkcyA9IHJlY29yZHMubWFwUHJvcGVydHkoJ2lk
        JyksCiAgICAgICAgICBhZGFwdGVyID0gdGhpcy5hZGFwdGVyRm9yVHlwZSh0
        eXBlKTsKCiAgICAgIEVtYmVyLmFzc2VydCgiWW91IHRyaWVkIHRvIGxvYWQg
        bWFueSByZWNvcmRzIGJ1dCB5b3UgaGF2ZSBubyBhZGFwdGVyIChmb3IgIiAr
        IHR5cGUgKyAiKSIsIGFkYXB0ZXIpOwogICAgICBFbWJlci5hc3NlcnQoIllv
        dSB0cmllZCB0byBsb2FkIG1hbnkgcmVjb3JkcyBidXQgeW91ciBhZGFwdGVy
        IGRvZXMgbm90IGltcGxlbWVudCBgZmluZE1hbnlgIiwgYWRhcHRlci5maW5k
        TWFueSk7CgogICAgICBfZmluZE1hbnkoYWRhcHRlciwgdGhpcywgdHlwZSwg
        aWRzLCBvd25lciwgcmVzb2x2ZXIpOwogICAgfSwgdGhpcyk7CiAgfSwKCiAg
        LyoqCiAgICBSZXR1cm5zIHRydWUgaWYgYSByZWNvcmQgZm9yIGEgZ2l2ZW4g
        dHlwZSBhbmQgSUQgaXMgYWxyZWFkeSBsb2FkZWQuCgogICAgQHBhcmFtIHtT
        dHJpbmd9IHR5cGUKICAgIEBwYXJhbSB7U3RyaW5nfEludGVnZXJ9IGlkCiAg
        ICBAcmV0dXJucyBCb29sZWFuCiAgKi8KICBoYXNSZWNvcmRGb3JJZDogZnVu
        Y3Rpb24odHlwZSwgaWQpIHsKICAgIGlkID0gY29lcmNlSWQoaWQpOwoKICAg
        IHJldHVybiAhIXRoaXMudHlwZU1hcEZvcih0eXBlKS5pZFRvUmVjb3JkW2lk
        XTsKICB9LAoKICAvKioKICAgIFJldHVybnMgaWQgcmVjb3JkIGZvciBhIGdp
        dmVuIHR5cGUgYW5kIElELiBJZiBvbmUgaXNuJ3QgYWxyZWFkeSBsb2FkZWQs
        CiAgICBpdCBidWlsZHMgYSBuZXcgcmVjb3JkIGFuZCBsZWF2ZXMgaXQgaW4g
        dGhlIGBlbXB0eWAgc3RhdGUuCgogICAgQHBhcmFtIHtTdHJpbmd9IHR5cGUK
        ICAgIEBwYXJhbSB7U3RyaW5nfEludGVnZXJ9IGlkCiAgICBAcmV0dXJucyBE
        Uy5Nb2RlbAogICovCiAgcmVjb3JkRm9ySWQ6IGZ1bmN0aW9uKHR5cGUsIGlk
        KSB7CiAgICB0eXBlID0gdGhpcy5tb2RlbEZvcih0eXBlKTsKCiAgICBpZCA9
        IGNvZXJjZUlkKGlkKTsKCiAgICB2YXIgcmVjb3JkID0gdGhpcy50eXBlTWFw
        Rm9yKHR5cGUpLmlkVG9SZWNvcmRbaWRdOwoKICAgIGlmICghcmVjb3JkKSB7
        CiAgICAgIHJlY29yZCA9IHRoaXMuYnVpbGRSZWNvcmQodHlwZSwgaWQpOwog
        ICAgfQoKICAgIHJldHVybiByZWNvcmQ7CiAgfSwKCiAgLyoqCiAgICBAbWV0
        aG9kIGZpbmRNYW55CiAgICBAcHJpdmF0ZQogICAgQHBhcmFtIHtEUy5Nb2Rl
        bH0gb3duZXIKICAgIEBwYXJhbSB7QXJyYXk8RFMuTW9kZWw+fSByZWNvcmRz
        CiAgICBAcGFyYW0ge1N0cmluZ30gdHlwZQogICAgQHBhcmFtIHtSZXNvbHZl
        cn0gcmVzb2x2ZXIKICAgIEByZXR1cm4gRFMuTWFueUFycmF5CiAgKi8KICBm
        aW5kTWFueTogZnVuY3Rpb24ob3duZXIsIHJlY29yZHMsIHR5cGUsIHJlc29s
        dmVyKSB7CiAgICB0eXBlID0gdGhpcy5tb2RlbEZvcih0eXBlKTsKCiAgICBy
        ZWNvcmRzID0gRW1iZXIuQShyZWNvcmRzKTsKCiAgICB2YXIgdW5sb2FkZWRS
        ZWNvcmRzID0gcmVjb3Jkcy5maWx0ZXJQcm9wZXJ0eSgnaXNFbXB0eScsIHRy
        dWUpLAogICAgICAgIG1hbnlBcnJheSA9IHRoaXMucmVjb3JkQXJyYXlNYW5h
        Z2VyLmNyZWF0ZU1hbnlBcnJheSh0eXBlLCByZWNvcmRzKTsKCiAgICB1bmxv
        YWRlZFJlY29yZHMuZm9yRWFjaChmdW5jdGlvbihyZWNvcmQpIHsKICAgICAg
        cmVjb3JkLmxvYWRpbmdEYXRhKCk7CiAgICB9KTsKCiAgICBtYW55QXJyYXku
        bG9hZGluZ1JlY29yZHNDb3VudCA9IHVubG9hZGVkUmVjb3Jkcy5sZW5ndGg7
        CgogICAgaWYgKHVubG9hZGVkUmVjb3Jkcy5sZW5ndGgpIHsKICAgICAgdW5s
        b2FkZWRSZWNvcmRzLmZvckVhY2goZnVuY3Rpb24ocmVjb3JkKSB7CiAgICAg
        ICAgdGhpcy5yZWNvcmRBcnJheU1hbmFnZXIucmVnaXN0ZXJXYWl0aW5nUmVj
        b3JkQXJyYXkocmVjb3JkLCBtYW55QXJyYXkpOwogICAgICB9LCB0aGlzKTsK
        CiAgICAgIHRoaXMuZmV0Y2hNYW55KHVubG9hZGVkUmVjb3Jkcywgb3duZXIs
        IHJlc29sdmVyKTsKICAgIH0gZWxzZSB7CiAgICAgIG1hbnlBcnJheS5zZXQo
        J2lzTG9hZGVkJywgdHJ1ZSk7CiAgICAgIEVtYmVyLnJ1bi5vbmNlKG1hbnlB
        cnJheSwgJ3RyaWdnZXInLCAnZGlkTG9hZCcpOwogICAgfQoKICAgIHJldHVy
        biBtYW55QXJyYXk7CiAgfSwKCiAgLyoqCiAgICBJZiBhIHJlbGF0aW9uc2hp
        cCB3YXMgb3JpZ2luYWxseSBwb3B1bGF0ZWQgYnkgdGhlIGFkYXB0ZXIgYXMg
        YSBsaW5rCiAgICAoYXMgb3Bwb3NlZCB0byBhIGxpc3Qgb2YgSURzKSwgdGhp
        cyBtZXRob2QgaXMgY2FsbGVkIHdoZW4gdGhlCiAgICByZWxhdGlvbnNoaXAg
        aXMgZmV0Y2hlZC4KCiAgICBUaGUgbGluayAod2hpY2ggaXMgdXN1YWxseSBh
        IFVSTCkgaXMgcGFzc2VkIHRocm91Z2ggdW5jaGFuZ2VkLCBzbyB0aGUKICAg
        IGFkYXB0ZXIgY2FuIG1ha2Ugd2hhdGV2ZXIgcmVxdWVzdCBpdCB3YW50cy4K
        CiAgICBUaGUgdXN1YWwgdXNlLWNhc2UgaXMgZm9yIHRoZSBzZXJ2ZXIgdG8g
        cmVnaXN0ZXIgYSBVUkwgYXMgYSBsaW5rLCBhbmQKICAgIHRoZW4gdXNlIHRo
        YXQgVVJMIGluIHRoZSBmdXR1cmUgdG8gbWFrZSBhIHJlcXVlc3QgZm9yIHRo
        ZSByZWxhdGlvbnNoaXAuCgogICAgQHByaXZhdGUKICAgIEBwYXJhbSB7RFMu
        TW9kZWx9IG93bmVyCiAgICBAcGFyYW0ge2FueX0gbGluawogICAgQHBhcmFt
        IHtTdHJpbmd9IHR5cGUKICAgIEBwYXJhbSB7UmVzb2x2ZXJ9IHJlc29sdmVy
        CiAgICBAcmV0dXJuIERTLk1hbnlBcnJheQogICovCiAgZmluZEhhc01hbnk6
        IGZ1bmN0aW9uKG93bmVyLCBsaW5rLCByZWxhdGlvbnNoaXAsIHJlc29sdmVy
        KSB7CiAgICB2YXIgYWRhcHRlciA9IHRoaXMuYWRhcHRlckZvclR5cGUob3du
        ZXIuY29uc3RydWN0b3IpOwoKICAgIEVtYmVyLmFzc2VydCgiWW91IHRyaWVk
        IHRvIGxvYWQgYSBoYXNNYW55IHJlbGF0aW9uc2hpcCBidXQgeW91IGhhdmUg
        bm8gYWRhcHRlciAoZm9yICIgKyBvd25lci5jb25zdHJ1Y3RvciArICIpIiwg
        YWRhcHRlcik7CiAgICBFbWJlci5hc3NlcnQoIllvdSB0cmllZCB0byBsb2Fk
        IGEgaGFzTWFueSByZWxhdGlvbnNoaXAgZnJvbSBhIHNwZWNpZmllZCBgbGlu
        a2AgaW4gdGhlIG9yaWdpbmFsIHBheWxvYWQgYnV0IHlvdXIgYWRhcHRlciBk
        b2VzIG5vdCBpbXBsZW1lbnQgYGZpbmRIYXNNYW55YCIsIGFkYXB0ZXIuZmlu
        ZEhhc01hbnkpOwoKICAgIHZhciByZWNvcmRzID0gdGhpcy5yZWNvcmRBcnJh
        eU1hbmFnZXIuY3JlYXRlTWFueUFycmF5KHJlbGF0aW9uc2hpcC50eXBlLCBF
        bWJlci5BKFtdKSk7CiAgICBfZmluZEhhc01hbnkoYWRhcHRlciwgdGhpcywg
        b3duZXIsIGxpbmssIHJlbGF0aW9uc2hpcCwgcmVzb2x2ZXIpOwogICAgcmV0
        dXJuIHJlY29yZHM7CiAgfSwKCiAgLyoqCiAgICBUaGlzIG1ldGhvZCBkZWxl
        Z2F0ZXMgYSBxdWVyeSB0byB0aGUgYWRhcHRlci4gVGhpcyBpcyB0aGUgb25l
        IHBsYWNlIHdoZXJlCiAgICBhZGFwdGVyLWxldmVsIHNlbWFudGljcyBhcmUg
        ZXhwb3NlZCB0byB0aGUgYXBwbGljYXRpb24uCgogICAgRXhwb3NpbmcgcXVl
        cmllcyB0aGlzIHdheSBzZWVtcyBwcmVmZXJhYmxlIHRvIGNyZWF0aW5nIGFu
        IGFic3RyYWN0IHF1ZXJ5CiAgICBsYW5ndWFnZSBmb3IgYWxsIHNlcnZlci1z
        aWRlIHF1ZXJpZXMsIGFuZCB0aGVuIHJlcXVpcmUgYWxsIGFkYXB0ZXJzIHRv
        CiAgICBpbXBsZW1lbnQgdGhlbS4KCiAgICBUaGlzIG1ldGhvZCByZXR1cm5z
        IGEgcHJvbWlzZSwgd2hpY2ggaXMgcmVzb2x2ZWQgd2l0aCBhIGBSZWNvcmRB
        cnJheWAKICAgIG9uY2UgdGhlIHNlcnZlciByZXR1cm5zLgoKICAgIEBtZXRo
        b2QgZmluZFF1ZXJ5CiAgICBAcHJpdmF0ZQogICAgQHBhcmFtIHtTdHJpbmd9
        IHR5cGUKICAgIEBwYXJhbSB7YW55fSBxdWVyeSBhbiBvcGFxdWUgcXVlcnkg
        dG8gYmUgdXNlZCBieSB0aGUgYWRhcHRlcgogICAgQHJldHVybiBQcm9taXNl
        CiAgKi8KICBmaW5kUXVlcnk6IGZ1bmN0aW9uKHR5cGUsIHF1ZXJ5KSB7CiAg
        ICB0eXBlID0gdGhpcy5tb2RlbEZvcih0eXBlKTsKCiAgICB2YXIgYXJyYXkg
        PSBEUy5BZGFwdGVyUG9wdWxhdGVkUmVjb3JkQXJyYXkuY3JlYXRlKHsKICAg
        ICAgdHlwZTogdHlwZSwKICAgICAgcXVlcnk6IHF1ZXJ5LAogICAgICBjb250
        ZW50OiBFbWJlci5BKCksCiAgICAgIHN0b3JlOiB0aGlzCiAgICB9KTsKCiAg
        ICB2YXIgYWRhcHRlciA9IHRoaXMuYWRhcHRlckZvclR5cGUodHlwZSksCiAg
        ICAgICAgcmVzb2x2ZXIgPSBFbWJlci5SU1ZQLmRlZmVyKCk7CgogICAgRW1i
        ZXIuYXNzZXJ0KCJZb3UgdHJpZWQgdG8gbG9hZCBhIHF1ZXJ5IGJ1dCB5b3Ug
        aGF2ZSBubyBhZGFwdGVyIChmb3IgIiArIHR5cGUgKyAiKSIsIGFkYXB0ZXIp
        OwogICAgRW1iZXIuYXNzZXJ0KCJZb3UgdHJpZWQgdG8gbG9hZCBhIHF1ZXJ5
        IGJ1dCB5b3VyIGFkYXB0ZXIgZG9lcyBub3QgaW1wbGVtZW50IGBmaW5kUXVl
        cnlgIiwgYWRhcHRlci5maW5kUXVlcnkpOwoKICAgIF9maW5kUXVlcnkoYWRh
        cHRlciwgdGhpcywgdHlwZSwgcXVlcnksIGFycmF5LCByZXNvbHZlcik7Cgog
        ICAgcmV0dXJuIHByb21pc2VBcnJheShyZXNvbHZlci5wcm9taXNlKTsKICB9
        LAoKICAvKioKICAgIFRoaXMgbWV0aG9kIHJldHVybnMgYW4gYXJyYXkgb2Yg
        YWxsIHJlY29yZHMgYWRhcHRlciBjYW4gZmluZC4KICAgIEl0IHRyaWdnZXJz
        IHRoZSBhZGFwdGVyJ3MgYGZpbmRBbGxgIG1ldGhvZCB0byBnaXZlIGl0IGFu
        IG9wcG9ydHVuaXR5IHRvIHBvcHVsYXRlCiAgICB0aGUgYXJyYXkgd2l0aCBy
        ZWNvcmRzIG9mIHRoYXQgdHlwZS4KCiAgICBAbWV0aG9kIGZpbmRBbGwKICAg
        IEBwcml2YXRlCiAgICBAcGFyYW0ge0NsYXNzfSB0eXBlCiAgICBAcmV0dXJu
        IHtEUy5BZGFwdGVyUG9wdWxhdGVkUmVjb3JkQXJyYXl9CiAgKi8KICBmaW5k
        QWxsOiBmdW5jdGlvbih0eXBlKSB7CiAgICB0eXBlID0gdGhpcy5tb2RlbEZv
        cih0eXBlKTsKCiAgICByZXR1cm4gdGhpcy5mZXRjaEFsbCh0eXBlLCB0aGlz
        LmFsbCh0eXBlKSk7CiAgfSwKCiAgLyoqCiAgICBAbWV0aG9kIGZldGNoQWxs
        CiAgICBAcHJpdmF0ZQogICAgQHBhcmFtIHR5cGUKICAgIEBwYXJhbSBhcnJh
        eQogICAgQHJldHVybnMgUHJvbWlzZQogICovCiAgZmV0Y2hBbGw6IGZ1bmN0
        aW9uKHR5cGUsIGFycmF5KSB7CiAgICB2YXIgYWRhcHRlciA9IHRoaXMuYWRh
        cHRlckZvclR5cGUodHlwZSksCiAgICAgICAgc2luY2VUb2tlbiA9IHRoaXMu
        dHlwZU1hcEZvcih0eXBlKS5tZXRhZGF0YS5zaW5jZSwKICAgICAgICByZXNv
        bHZlciA9IEVtYmVyLlJTVlAuZGVmZXIoKTsKCiAgICBzZXQoYXJyYXksICdp
        c1VwZGF0aW5nJywgdHJ1ZSk7CgogICAgRW1iZXIuYXNzZXJ0KCJZb3UgdHJp
        ZWQgdG8gbG9hZCBhbGwgcmVjb3JkcyBidXQgeW91IGhhdmUgbm8gYWRhcHRl
        ciAoZm9yICIgKyB0eXBlICsgIikiLCBhZGFwdGVyKTsKICAgIEVtYmVyLmFz
        c2VydCgiWW91IHRyaWVkIHRvIGxvYWQgYWxsIHJlY29yZHMgYnV0IHlvdXIg
        YWRhcHRlciBkb2VzIG5vdCBpbXBsZW1lbnQgYGZpbmRBbGxgIiwgYWRhcHRl
        ci5maW5kQWxsKTsKCiAgICBfZmluZEFsbChhZGFwdGVyLCB0aGlzLCB0eXBl
        LCBzaW5jZVRva2VuLCByZXNvbHZlcik7CgogICAgcmV0dXJuIHByb21pc2VB
        cnJheShyZXNvbHZlci5wcm9taXNlKTsKICB9LAoKICAvKioKICAgIEBtZXRo
        b2QgZGlkVXBkYXRlQWxsCiAgICBAcGFyYW0gdHlwZQogICovCiAgZGlkVXBk
        YXRlQWxsOiBmdW5jdGlvbih0eXBlKSB7CiAgICB2YXIgZmluZEFsbENhY2hl
        ID0gdGhpcy50eXBlTWFwRm9yKHR5cGUpLmZpbmRBbGxDYWNoZTsKICAgIHNl
        dChmaW5kQWxsQ2FjaGUsICdpc1VwZGF0aW5nJywgZmFsc2UpOwogIH0sCgog
        IC8qKgogICAgVGhpcyBtZXRob2QgcmV0dXJucyBhIGZpbHRlcmVkIGFycmF5
        IHRoYXQgY29udGFpbnMgYWxsIG9mIHRoZSBrbm93biByZWNvcmRzCiAgICBm
        b3IgYSBnaXZlbiB0eXBlLgoKICAgIE5vdGUgdGhhdCBiZWNhdXNlIGl0J3Mg
        anVzdCBhIGZpbHRlciwgaXQgd2lsbCBoYXZlIGFueSBsb2NhbGx5CiAgICBj
        cmVhdGVkIHJlY29yZHMgb2YgdGhlIHR5cGUuCgogICAgQWxzbyBub3RlIHRo
        YXQgbXVsdGlwbGUgY2FsbHMgdG8gYGFsbGAgZm9yIGEgZ2l2ZW4gdHlwZSB3
        aWxsIGFsd2F5cwogICAgcmV0dXJuIHRoZSBzYW1lIFJlY29yZEFycmF5LgoK
        ICAgIEBtZXRob2QgYWxsCiAgICBAcGFyYW0ge0NsYXNzfSB0eXBlCiAgICBA
        cmV0dXJuIHtEUy5SZWNvcmRBcnJheX0KICAqLwogIGFsbDogZnVuY3Rpb24o
        dHlwZSkgewogICAgdmFyIHR5cGVNYXAgPSB0aGlzLnR5cGVNYXBGb3IodHlw
        ZSksCiAgICAgICAgZmluZEFsbENhY2hlID0gdHlwZU1hcC5maW5kQWxsQ2Fj
        aGU7CgogICAgaWYgKGZpbmRBbGxDYWNoZSkgeyByZXR1cm4gZmluZEFsbENh
        Y2hlOyB9CgogICAgdmFyIGFycmF5ID0gRFMuUmVjb3JkQXJyYXkuY3JlYXRl
        KHsKICAgICAgdHlwZTogdHlwZSwKICAgICAgY29udGVudDogRW1iZXIuQSgp
        LAogICAgICBzdG9yZTogdGhpcywKICAgICAgaXNMb2FkZWQ6IHRydWUKICAg
        IH0pOwoKICAgIHRoaXMucmVjb3JkQXJyYXlNYW5hZ2VyLnJlZ2lzdGVyRmls
        dGVyZWRSZWNvcmRBcnJheShhcnJheSwgdHlwZSk7CgogICAgdHlwZU1hcC5m
        aW5kQWxsQ2FjaGUgPSBhcnJheTsKICAgIHJldHVybiBhcnJheTsKICB9LAoK
        ICAvKioKICAgIFRha2VzIGEgdHlwZSBhbmQgZmlsdGVyIGZ1bmN0aW9uLCBh
        bmQgcmV0dXJucyBhIGxpdmUgUmVjb3JkQXJyYXkgdGhhdAogICAgcmVtYWlu
        cyB1cCB0byBkYXRlIGFzIG5ldyByZWNvcmRzIGFyZSBsb2FkZWQgaW50byB0
        aGUgc3RvcmUgb3IgY3JlYXRlZAogICAgbG9jYWxseS4KCiAgICBUaGUgY2Fs
        bGJhY2sgZnVuY3Rpb24gdGFrZXMgYSBtYXRlcmlhbGl6ZWQgcmVjb3JkLCBh
        bmQgcmV0dXJucyB0cnVlCiAgICBpZiB0aGUgcmVjb3JkIHNob3VsZCBiZSBp
        bmNsdWRlZCBpbiB0aGUgZmlsdGVyIGFuZCBmYWxzZSBpZiBpdCBzaG91bGQK
        ICAgIG5vdC4KCiAgICBUaGUgZmlsdGVyIGZ1bmN0aW9uIGlzIGNhbGxlZCBv
        bmNlIG9uIGFsbCByZWNvcmRzIGZvciB0aGUgdHlwZSB3aGVuCiAgICBpdCBp
        cyBjcmVhdGVkLCBhbmQgdGhlbiBvbmNlIG9uIGVhY2ggbmV3bHkgbG9hZGVk
        IG9yIGNyZWF0ZWQgcmVjb3JkLgoKICAgIElmIGFueSBvZiBhIHJlY29yZCdz
        IHByb3BlcnRpZXMgY2hhbmdlLCBvciBpZiBpdCBjaGFuZ2VzIHN0YXRlLCB0
        aGUKICAgIGZpbHRlciBmdW5jdGlvbiB3aWxsIGJlIGludm9rZWQgYWdhaW4g
        dG8gZGV0ZXJtaW5lIHdoZXRoZXIgaXQgc2hvdWxkCiAgICBzdGlsbCBiZSBp
        biB0aGUgYXJyYXkuCgogICAgTm90ZSB0aGF0IHRoZSBleGlzdGVuY2Ugb2Yg
        YSBmaWx0ZXIgb24gYSB0eXBlIHdpbGwgdHJpZ2dlciBpbW1lZGlhdGUKICAg
        IG1hdGVyaWFsaXphdGlvbiBvZiBhbGwgbG9hZGVkIGRhdGEgZm9yIGEgZ2l2
        ZW4gdHlwZSwgc28geW91IG1pZ2h0CiAgICBub3Qgd2FudCB0byB1c2UgZmls
        dGVycyBmb3IgYSB0eXBlIGlmIHlvdSBhcmUgbG9hZGluZyBtYW55IHJlY29y
        ZHMKICAgIGludG8gdGhlIHN0b3JlLCBtYW55IG9mIHdoaWNoIGFyZSBub3Qg
        YWN0aXZlIGF0IGFueSBnaXZlbiB0aW1lLgoKICAgIEluIHRoaXMgc2NlbmFy
        aW8sIHlvdSBtaWdodCB3YW50IHRvIGNvbnNpZGVyIGZpbHRlcmluZyB0aGUg
        cmF3CiAgICBkYXRhIGJlZm9yZSBsb2FkaW5nIGl0IGludG8gdGhlIHN0b3Jl
        LgoKICAgIEBtZXRob2QgZmlsdGVyCiAgICBAcGFyYW0ge0NsYXNzfSB0eXBl
        CiAgICBAcGFyYW0ge0Z1bmN0aW9ufSBmaWx0ZXIKICAgIEByZXR1cm4ge0RT
        LkZpbHRlcmVkUmVjb3JkQXJyYXl9CiAgKi8KICBmaWx0ZXI6IGZ1bmN0aW9u
        KHR5cGUsIHF1ZXJ5LCBmaWx0ZXIpIHsKICAgIHZhciBwcm9taXNlOwoKICAg
        IC8vIGFsbG93IGFuIG9wdGlvbmFsIHNlcnZlciBxdWVyeQogICAgaWYgKGFy
        Z3VtZW50cy5sZW5ndGggPT09IDMpIHsKICAgICAgcHJvbWlzZSA9IHRoaXMu
        ZmluZFF1ZXJ5KHR5cGUsIHF1ZXJ5KTsKICAgIH0gZWxzZSBpZiAoYXJndW1l
        bnRzLmxlbmd0aCA9PT0gMikgewogICAgICBmaWx0ZXIgPSBxdWVyeTsKICAg
        IH0KCiAgICB0eXBlID0gdGhpcy5tb2RlbEZvcih0eXBlKTsKCiAgICB2YXIg
        YXJyYXkgPSBEUy5GaWx0ZXJlZFJlY29yZEFycmF5LmNyZWF0ZSh7CiAgICAg
        IHR5cGU6IHR5cGUsCiAgICAgIGNvbnRlbnQ6IEVtYmVyLkEoKSwKICAgICAg
        c3RvcmU6IHRoaXMsCiAgICAgIG1hbmFnZXI6IHRoaXMucmVjb3JkQXJyYXlN
        YW5hZ2VyLAogICAgICBmaWx0ZXJGdW5jdGlvbjogZmlsdGVyCiAgICB9KTsK
        CiAgICB0aGlzLnJlY29yZEFycmF5TWFuYWdlci5yZWdpc3RlckZpbHRlcmVk
        UmVjb3JkQXJyYXkoYXJyYXksIHR5cGUsIGZpbHRlcik7CgogICAgaWYgKHBy
        b21pc2UpIHsKICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbigp
        IHsgcmV0dXJuIGFycmF5OyB9KTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVy
        biBhcnJheTsKICAgIH0KICB9LAoKICAvKioKICAgIFRoaXMgbWV0aG9kIHJl
        dHVybnMgaWYgYSBjZXJ0YWluIHJlY29yZCBpcyBhbHJlYWR5IGxvYWRlZAog
        ICAgaW4gdGhlIHN0b3JlLiBVc2UgdGhpcyBmdW5jdGlvbiB0byBrbm93IGJl
        Zm9yZWhhbmQgaWYgYSBmaW5kKCkKICAgIHdpbGwgcmVzdWx0IGluIGEgcmVx
        dWVzdCBvciB0aGF0IGl0IHdpbGwgYmUgYSBjYWNoZSBoaXQuCgogICAgQG1l
        dGhvZCByZWNvcmRJc0xvYWRlZAogICAgQHBhcmFtIHtDbGFzc30gdHlwZQog
        ICAgQHBhcmFtIHtzdHJpbmd9IGlkCiAgICBAcmV0dXJuIHtib29sZWFufQog
        ICovCiAgcmVjb3JkSXNMb2FkZWQ6IGZ1bmN0aW9uKHR5cGUsIGlkKSB7CiAg
        ICBpZiAoIXRoaXMuaGFzUmVjb3JkRm9ySWQodHlwZSwgaWQpKSB7IHJldHVy
        biBmYWxzZTsgfQogICAgcmV0dXJuICFnZXQodGhpcy5yZWNvcmRGb3JJZCh0
        eXBlLCBpZCksICdpc0VtcHR5Jyk7CiAgfSwKCiAgLy8gLi4uLi4uLi4uLi4u
        CiAgLy8gLiBVUERBVElORyAuCiAgLy8gLi4uLi4uLi4uLi4uCgogIC8qKgog
        ICAgSWYgdGhlIGFkYXB0ZXIgdXBkYXRlcyBhdHRyaWJ1dGVzIG9yIGFja25v
        d2xlZGdlcyBjcmVhdGlvbgogICAgb3IgZGVsZXRpb24sIHRoZSByZWNvcmQg
        d2lsbCBub3RpZnkgdGhlIHN0b3JlIHRvIHVwZGF0ZSBpdHMKICAgIG1lbWJl
        cnNoaXAgaW4gYW55IGZpbHRlcnMuCgogICAgVG8gYXZvaWQgdGhyYXNoaW5n
        LCB0aGlzIG1ldGhvZCBpcyBpbnZva2VkIG9ubHkgb25jZSBwZXIKICAgIHJ1
        biBsb29wIHBlciByZWNvcmQuCgogICAgQG1ldGhvZCBkYXRhV2FzVXBkYXRl
        ZAogICAgQHByaXZhdGUKICAgIEBwYXJhbSB7Q2xhc3N9IHR5cGUKICAgIEBw
        YXJhbSB7TnVtYmVyfFN0cmluZ30gY2xpZW50SWQKICAgIEBwYXJhbSB7RFMu
        TW9kZWx9IHJlY29yZAogICovCiAgZGF0YVdhc1VwZGF0ZWQ6IGZ1bmN0aW9u
        KHR5cGUsIHJlY29yZCkgewogICAgLy8gQmVjYXVzZSBkYXRhIHVwZGF0ZXMg
        YXJlIGludm9rZWQgYXQgdGhlIGVuZCBvZiB0aGUgcnVuIGxvb3AsCiAgICAv
        LyBpdCBpcyBwb3NzaWJsZSB0aGF0IGEgcmVjb3JkIG1pZ2h0IGJlIGRlbGV0
        ZWQgYWZ0ZXIgaXRzIGRhdGEKICAgIC8vIGhhcyBiZWVuIG1vZGlmaWVkIGFu
        ZCB0aGlzIG1ldGhvZCB3YXMgc2NoZWR1bGVkIHRvIGJlIGNhbGxlZC4KICAg
        IC8vCiAgICAvLyBJZiB0aGF0J3MgdGhlIGNhc2UsIHRoZSByZWNvcmQgd291
        bGQgaGF2ZSBhbHJlYWR5IGJlZW4gcmVtb3ZlZAogICAgLy8gZnJvbSBhbGwg
        cmVjb3JkIGFycmF5czsgY2FsbGluZyB1cGRhdGVSZWNvcmRBcnJheXMgd291
        bGQganVzdAogICAgLy8gYWRkIGl0IGJhY2suIElmIHRoZSByZWNvcmQgaXMg
        ZGVsZXRlZCwganVzdCBiYWlsLiBJdCBzaG91bGRuJ3QKICAgIC8vIGdpdmUg
        dXMgYW55IG1vcmUgdHJvdWJsZSBhZnRlciB0aGlzLgoKICAgIGlmIChnZXQo
        cmVjb3JkLCAnaXNEZWxldGVkJykpIHsgcmV0dXJuOyB9CgogICAgaWYgKGdl
        dChyZWNvcmQsICdpc0xvYWRlZCcpKSB7CiAgICAgIHRoaXMucmVjb3JkQXJy
        YXlNYW5hZ2VyLnJlY29yZERpZENoYW5nZShyZWNvcmQpOwogICAgfQogIH0s
        CgogIC8vIC4uLi4uLi4uLi4uLi4uCiAgLy8gLiBQRVJTSVNUSU5HIC4KICAv
        LyAuLi4uLi4uLi4uLi4uLgoKICAvKioKICAgIFRoaXMgbWV0aG9kIGlzIGNh
        bGxlZCBieSBgcmVjb3JkLnNhdmVgLCBhbmQgZ2V0cyBwYXNzZWQgYQogICAg
        cmVzb2x2ZXIgZm9yIHRoZSBwcm9taXNlIHRoYXQgYHJlY29yZC5zYXZlYCBy
        ZXR1cm5zLgoKICAgIEl0IHNjaGVkdWxlcyBzYXZpbmcgdG8gaGFwcGVuIGF0
        IHRoZSBlbmQgb2YgdGhlIHJ1biBsb29wLgoKICAgIEBtZXRob2Qgc2NoZWR1
        bGVTYXZlCiAgICBAcHJpdmF0ZQogICAgQHBhcmFtIHtEUy5Nb2RlbH0gcmVj
        b3JkCiAgICBAcGFyYW0ge1Jlc29sdmVyfSByZXNvbHZlcgogICovCiAgc2No
        ZWR1bGVTYXZlOiBmdW5jdGlvbihyZWNvcmQsIHJlc29sdmVyKSB7CiAgICBy
        ZWNvcmQuYWRhcHRlcldpbGxDb21taXQoKTsKICAgIHRoaXMuX3BlbmRpbmdT
        YXZlLnB1c2goW3JlY29yZCwgcmVzb2x2ZXJdKTsKICAgIG9uY2UodGhpcywg
        J2ZsdXNoUGVuZGluZ1NhdmUnKTsKICB9LAoKICAvKioKICAgIFRoaXMgbWV0
        aG9kIGlzIGNhbGxlZCBhdCB0aGUgZW5kIG9mIHRoZSBydW4gbG9vcCwgYW5k
        CiAgICBmbHVzaGVzIGFueSByZWNvcmRzIHBhc3NlZCBpbnRvIGBzY2hlZHVs
        ZVNhdmVgCgogICAgQG1ldGhvZCBmbHVzaFBlbmRpbmdTYXZlCiAgICBAcHJp
        dmF0ZQogICovCiAgZmx1c2hQZW5kaW5nU2F2ZTogZnVuY3Rpb24oKSB7CiAg
        ICB2YXIgcGVuZGluZyA9IHRoaXMuX3BlbmRpbmdTYXZlLnNsaWNlKCk7CiAg
        ICB0aGlzLl9wZW5kaW5nU2F2ZSA9IFtdOwoKICAgIGZvckVhY2gocGVuZGlu
        ZywgZnVuY3Rpb24odHVwbGUpIHsKICAgICAgdmFyIHJlY29yZCA9IHR1cGxl
        WzBdLCByZXNvbHZlciA9IHR1cGxlWzFdLAogICAgICAgICAgYWRhcHRlciA9
        IHRoaXMuYWRhcHRlckZvclR5cGUocmVjb3JkLmNvbnN0cnVjdG9yKSwKICAg
        ICAgICAgIG9wZXJhdGlvbjsKCiAgICAgIGlmIChnZXQocmVjb3JkLCAnaXNO
        ZXcnKSkgewogICAgICAgIG9wZXJhdGlvbiA9ICdjcmVhdGVSZWNvcmQnOwog
        ICAgICB9IGVsc2UgaWYgKGdldChyZWNvcmQsICdpc0RlbGV0ZWQnKSkgewog
        ICAgICAgIG9wZXJhdGlvbiA9ICdkZWxldGVSZWNvcmQnOwogICAgICB9IGVs
        c2UgewogICAgICAgIG9wZXJhdGlvbiA9ICd1cGRhdGVSZWNvcmQnOwogICAg
        ICB9CgogICAgICBfY29tbWl0KGFkYXB0ZXIsIHRoaXMsIG9wZXJhdGlvbiwg
        cmVjb3JkLCByZXNvbHZlcik7CiAgICB9LCB0aGlzKTsKICB9LAoKICAvKioK
        ICAgIFRoaXMgbWV0aG9kIGlzIGNhbGxlZCBvbmNlIHRoZSBwcm9taXNlIHJl
        dHVybmVkIGJ5IGFuCiAgICBhZGFwdGVyJ3MgYGNyZWF0ZVJlY29yZGAsIGB1
        cGRhdGVSZWNvcmRgIG9yIGBkZWxldGVSZWNvcmRgCiAgICBpcyByZXNvbHZl
        ZC4KCiAgICBJZiB0aGUgZGF0YSBwcm92aWRlcyBhIHNlcnZlci1nZW5lcmF0
        ZWQgSUQsIGl0IHdpbGwKICAgIHVwZGF0ZSB0aGUgcmVjb3JkIGFuZCB0aGUg
        c3RvcmUncyBpbmRleGVzLgoKICAgIEBtZXRob2QgZGlkU2F2ZVJlY29yZAog
        ICAgQHByaXZhdGUKICAgIEBwYXJhbSB7RFMuTW9kZWx9IHJlY29yZCB0aGUg
        aW4tZmxpZ2h0IHJlY29yZAogICAgQHBhcmFtIHtPYmplY3R9IGRhdGEgb3B0
        aW9uYWwgZGF0YSAoc2VlIGFib3ZlKQogICovCiAgZGlkU2F2ZVJlY29yZDog
        ZnVuY3Rpb24ocmVjb3JkLCBkYXRhKSB7CiAgICBpZiAoZGF0YSkgewogICAg
        ICB0aGlzLnVwZGF0ZUlkKHJlY29yZCwgZGF0YSk7CiAgICB9CgogICAgcmVj
        b3JkLmFkYXB0ZXJEaWRDb21taXQoZGF0YSk7CiAgfSwKCiAgLyoqCiAgICBU
        aGlzIG1ldGhvZCBpcyBjYWxsZWQgb25jZSB0aGUgcHJvbWlzZSByZXR1cm5l
        ZCBieSBhbgogICAgYWRhcHRlcidzIGBjcmVhdGVSZWNvcmRgLCBgdXBkYXRl
        UmVjb3JkYCBvciBgZGVsZXRlUmVjb3JkYAogICAgaXMgcmVqZWN0ZWQgd2l0
        aCBhIGBEUy5JbnZhbGlkRXJyb3JgLgoKICAgIEBtZXRob2QgcmVjb3JkV2Fz
        SW52YWxpZAogICAgQHByaXZhdGUKICAgIEBwYXJhbSB7RFMuTW9kZWx9IHJl
        Y29yZAogICAgQHBhcmFtIHtPYmplY3R9IGVycm9ycwogICovCiAgcmVjb3Jk
        V2FzSW52YWxpZDogZnVuY3Rpb24ocmVjb3JkLCBlcnJvcnMpIHsKICAgIHJl
        Y29yZC5hZGFwdGVyRGlkSW52YWxpZGF0ZShlcnJvcnMpOwogIH0sCgogIC8q
        KgogICAgVGhpcyBtZXRob2QgaXMgY2FsbGVkIG9uY2UgdGhlIHByb21pc2Ug
        cmV0dXJuZWQgYnkgYW4KICAgIGFkYXB0ZXIncyBgY3JlYXRlUmVjb3JkYCwg
        YHVwZGF0ZVJlY29yZGAgb3IgYGRlbGV0ZVJlY29yZGAKICAgIGlzIHJlamVj
        dGVkICh3aXRoIGFueXRoaW5nIG90aGVyIHRoYW4gYSBgRFMuSW52YWxpZEVy
        cm9yYCkuCgogICAgQG1ldGhvZCByZWNvcmRXYXNFcnJvcgogICAgQHByaXZh
        dGUKICAgIEBwYXJhbSB7RFMuTW9kZWx9IHJlY29yZAogICovCiAgcmVjb3Jk
        V2FzRXJyb3I6IGZ1bmN0aW9uKHJlY29yZCkgewogICAgcmVjb3JkLmFkYXB0
        ZXJEaWRFcnJvcigpOwogIH0sCgogIC8qKgogICAgV2hlbiBhbiBhZGFwdGVy
        J3MgYGNyZWF0ZVJlY29yZGAsIGB1cGRhdGVSZWNvcmRgIG9yIGBkZWxldGVS
        ZWNvcmRgCiAgICByZXNvbHZlcyB3aXRoIGRhdGEsIHRoaXMgbWV0aG9kIGV4
        dHJhY3RzIHRoZSBJRCBmcm9tIHRoZSBzdXBwbGllZAogICAgZGF0YS4KCiAg
        ICBAbWV0aG9kIHVwZGF0ZUlkCiAgICBAcHJpdmF0ZQogICAgQHBhcmFtIHtE
        Uy5Nb2RlbH0gcmVjb3JkCiAgICBAcGFyYW0ge09iamVjdH0gZGF0YQogICov
        CiAgdXBkYXRlSWQ6IGZ1bmN0aW9uKHJlY29yZCwgZGF0YSkgewogICAgdmFy
        IG9sZElkID0gZ2V0KHJlY29yZCwgJ2lkJyksCiAgICAgICAgaWQgPSBjb2Vy
        Y2VJZChkYXRhLmlkKTsKCiAgICBFbWJlci5hc3NlcnQoIkFuIGFkYXB0ZXIg
        Y2Fubm90IGFzc2lnbiBhIG5ldyBpZCB0byBhIHJlY29yZCB0aGF0IGFscmVh
        ZHkgaGFzIGFuIGlkLiAiICsgcmVjb3JkICsgIiBoYWQgaWQ6ICIgKyBvbGRJ
        ZCArICIgYW5kIHlvdSB0cmllZCB0byB1cGRhdGUgaXQgd2l0aCAiICsgaWQg
        KyAiLiBUaGlzIGxpa2VseSBoYXBwZW5lZCBiZWNhdXNlIHlvdXIgc2VydmVy
        IHJldHVybmVkIGRhdGEgaW4gcmVzcG9uc2UgdG8gYSBmaW5kIG9yIHVwZGF0
        ZSB0aGF0IGhhZCBhIGRpZmZlcmVudCBpZCB0aGFuIHRoZSBvbmUgeW91IHNl
        bnQuIiwgb2xkSWQgPT09IG51bGwgfHwgaWQgPT09IG9sZElkKTsKCiAgICB0
        aGlzLnR5cGVNYXBGb3IocmVjb3JkLmNvbnN0cnVjdG9yKS5pZFRvUmVjb3Jk
        W2lkXSA9IHJlY29yZDsKCiAgICBzZXQocmVjb3JkLCAnaWQnLCBpZCk7CiAg
        fSwKCiAgLyoqCiAgICBSZXR1cm5zIGEgbWFwIG9mIElEcyB0byBjbGllbnQg
        SURzIGZvciBhIGdpdmVuIHR5cGUuCgogICAgQG1ldGhvZCB0eXBlTWFwRm9y
        CiAgICBAcHJpdmF0ZQogICAgQHBhcmFtIHR5cGUKICAqLwogIHR5cGVNYXBG
        b3I6IGZ1bmN0aW9uKHR5cGUpIHsKICAgIHZhciB0eXBlTWFwcyA9IGdldCh0
        aGlzLCAndHlwZU1hcHMnKSwKICAgICAgICBndWlkID0gRW1iZXIuZ3VpZEZv
        cih0eXBlKSwKICAgICAgICB0eXBlTWFwOwoKICAgIHR5cGVNYXAgPSB0eXBl
        TWFwc1tndWlkXTsKCiAgICBpZiAodHlwZU1hcCkgeyByZXR1cm4gdHlwZU1h
        cDsgfQoKICAgIHR5cGVNYXAgPSB7CiAgICAgIGlkVG9SZWNvcmQ6IHt9LAog
        ICAgICByZWNvcmRzOiBbXSwKICAgICAgbWV0YWRhdGE6IHt9CiAgICB9OwoK
        ICAgIHR5cGVNYXBzW2d1aWRdID0gdHlwZU1hcDsKCiAgICByZXR1cm4gdHlw
        ZU1hcDsKICB9LAoKICAvLyAuLi4uLi4uLi4uLi4uLi4uCiAgLy8gLiBMT0FE
        SU5HIERBVEEgLgogIC8vIC4uLi4uLi4uLi4uLi4uLi4KCiAgLyoqCiAgICBU
        aGlzIGludGVybmFsIG1ldGhvZCBpcyB1c2VkIGJ5IGBwdXNoYC4KCiAgICBA
        bWV0aG9kIF9sb2FkCiAgICBAcHJpdmF0ZQogICAgQHBhcmFtIHtEUy5Nb2Rl
        bH0gdHlwZQogICAgQHBhcmFtIGRhdGEKICAgIEBwYXJhbSBwcmVtYXRlcmlh
        bGl6ZWQKICAqLwogIF9sb2FkOiBmdW5jdGlvbih0eXBlLCBkYXRhKSB7CiAg
        ICB2YXIgaWQgPSBjb2VyY2VJZChkYXRhLmlkKSwKICAgICAgICByZWNvcmQg
        PSB0aGlzLnJlY29yZEZvcklkKHR5cGUsIGlkKTsKCiAgICByZWNvcmQuc2V0
        dXBEYXRhKGRhdGEpOwogICAgdGhpcy5yZWNvcmRBcnJheU1hbmFnZXIucmVj
        b3JkRGlkQ2hhbmdlKHJlY29yZCk7CgogICAgcmV0dXJuIHJlY29yZDsKICB9
        LAoKICAvKioKICAgIFJldHVybnMgYSBtb2RlbCBjbGFzcyBmb3IgYSBwYXJ0
        aWN1bGFyIGtleS4gVXNlZCBieQogICAgbWV0aG9kcyB0aGF0IHRha2UgYSB0
        eXBlIGtleSAobGlrZSBgZmluZGAsIGBjcmVhdGVSZWNvcmRgLAogICAgZXRj
        LikKCiAgICBAcGFyYW0ge1N0cmluZ30ga2V5CiAgICBAcmV0dXJucyB7c3Vi
        Y2xhc3Mgb2YgRFMuTW9kZWx9CiAgKi8KICBtb2RlbEZvcjogZnVuY3Rpb24o
        a2V5KSB7CiAgICBpZiAodHlwZW9mIGtleSAhPT0gJ3N0cmluZycpIHsKICAg
        ICAgcmV0dXJuIGtleTsKICAgIH0KCiAgICB2YXIgZmFjdG9yeSA9IHRoaXMu
        Y29udGFpbmVyLmxvb2t1cEZhY3RvcnkoJ21vZGVsOicra2V5KTsKCiAgICBF
        bWJlci5hc3NlcnQoIk5vIG1vZGVsIHdhcyBmb3VuZCBmb3IgJyIgKyBrZXkg
        KyAiJyIsIGZhY3RvcnkpOwoKICAgIGZhY3Rvcnkuc3RvcmUgPSB0aGlzOwog
        ICAgZmFjdG9yeS50eXBlS2V5ID0ga2V5OwoKICAgIHJldHVybiBmYWN0b3J5
        OwogIH0sCgogIC8qKgogICAgUHVzaCBzb21lIGRhdGEgZm9yIGEgZ2l2ZW4g
        dHlwZSBpbnRvIHRoZSBzdG9yZS4KCiAgICBUaGlzIG1ldGhvZCBleHBlY3Rz
        IG5vcm1hbGl6ZWQgZGF0YToKCiAgICAqIFRoZSBJRCBpcyBhIGtleSBuYW1l
        ZCBgaWRgIChhbiBJRCBpcyBtYW5kYXRvcnkpCiAgICAqIFRoZSBuYW1lcyBv
        ZiBhdHRyaWJ1dGVzIGFyZSB0aGUgb25lcyB5b3UgdXNlZCBpbgogICAgICB5
        b3VyIG1vZGVsJ3MgYERTLmF0dHJgcy4KICAgICogWW91ciByZWxhdGlvbnNo
        aXBzIG11c3QgYmU6CiAgICAgICogcmVwcmVzZW50ZWQgYXMgSURzIG9yIEFy
        cmF5cyBvZiBJRHMKICAgICAgKiByZXByZXNlbnRlZCBhcyBtb2RlbCBpbnN0
        YW5jZXMKICAgICAgKiByZXByZXNlbnRlZCBhcyBVUkxzLCB1bmRlciB0aGUg
        YGxpbmtzYCBrZXkKCiAgICBGb3IgdGhpcyBtb2RlbDoKCiAgICBgYGBqcwog
        ICAgQXBwLlBlcnNvbiA9IERTLk1vZGVsLmV4dGVuZCh7CiAgICAgIGZpcnN0
        TmFtZTogRFMuYXR0cigpLAogICAgICBsYXN0TmFtZTogRFMuYXR0cigpLAoK
        ICAgICAgY2hpbGRyZW46IERTLmhhc01hbnkoJ3BlcnNvbicpCiAgICB9KTsK
        ICAgIGBgYAoKICAgIFRvIHJlcHJlc2VudCB0aGUgY2hpbGRyZW4gYXMgSURz
        OgoKICAgIGBgYGpzCiAgICB7CiAgICAgIGlkOiAxLAogICAgICBmaXJzdE5h
        bWU6ICJUb20iLAogICAgICBsYXN0TmFtZTogIkRhbGUiLAogICAgICBjaGls
        ZHJlbjogWzEsIDIsIDNdCiAgICB9CiAgICBgYGAKCiAgICBUbyByZXByZXNl
        bnQgdGhlIGNoaWxkcmVuIHJlbGF0aW9uc2hpcCBhcyBhIFVSTDoKCiAgICBg
        YGBqcwogICAgewogICAgICBpZDogMSwKICAgICAgZmlyc3ROYW1lOiAiVG9t
        IiwKICAgICAgbGFzdE5hbWU6ICJEYWxlIiwKICAgICAgbGlua3M6IHsKICAg
        ICAgICBjaGlsZHJlbjogIi9wZW9wbGUvMS9jaGlsZHJlbiIKICAgICAgfQog
        ICAgfQogICAgYGBgCgogICAgSWYgeW91J3JlIHN0cmVhbWluZyBkYXRhIG9y
        IGltcGxlbWVudGluZyBhbiBhZGFwdGVyLAogICAgbWFrZSBzdXJlIHRoYXQg
        eW91IGhhdmUgY29udmVydGVkIHRoZSBpbmNvbWluZyBkYXRhCiAgICBpbnRv
        IHRoaXMgZm9ybS4KCiAgICBUaGlzIG1ldGhvZCBjYW4gYmUgdXNlZCBib3Ro
        IHRvIHB1c2ggaW4gYnJhbmQgbmV3CiAgICByZWNvcmRzLCBhcyB3ZWxsIGFz
        IHRvIHVwZGF0ZSBleGlzdGluZyByZWNvcmRzLgoKICAgIEBtZXRob2QgcHVz
        aAogICAgQHBhcmFtIHtTdHJpbmd9IHR5cGUKICAgIEBwYXJhbSB7T2JqZWN0
        fSBkYXRhCiAgICBAcmV0dXJucyBEUy5Nb2RlbCB0aGUgcmVjb3JkIHRoYXQg
        d2FzIGNyZWF0ZWQgb3IKICAgICAgdXBkYXRlZC4KICAqLwogIHB1c2g6IGZ1
        bmN0aW9uKHR5cGUsIGRhdGEpIHsKICAgIHZhciBzZXJpYWxpemVyID0gdGhp
        cy5zZXJpYWxpemVyRm9yKHR5cGUpOwogICAgdHlwZSA9IHRoaXMubW9kZWxG
        b3IodHlwZSk7CgogICAgZGF0YSA9IHNlcmlhbGl6ZXIuZGVzZXJpYWxpemUo
        dHlwZSwgZGF0YSk7CgogICAgdGhpcy5fbG9hZCh0eXBlLCBkYXRhKTsKCiAg
        ICByZXR1cm4gdGhpcy5yZWNvcmRGb3JJZCh0eXBlLCBkYXRhLmlkKTsKICB9
        LAoKICAvKioKICAgIElmIHlvdSBoYXZlIGFuIEFycmF5IG9mIG5vcm1hbGl6
        ZWQgZGF0YSB0byBwdXNoLAogICAgeW91IGNhbiBjYWxsIGBwdXNoTWFueWAg
        d2l0aCB0aGUgQXJyYXksIGFuZCBpdCB3aWxsCiAgICBjYWxsIGBwdXNoYCBy
        ZXBlYXRlZGx5IGZvciB5b3UuCgogICAgQG1ldGhvZCBwdXNoTWFueQogICAg
        QHBhcmFtIHtTdHJpbmd9IHR5cGUKICAgIEBwYXJhbSB7QXJyYXl9IGRhdGFz
        CiAgICBAcmV0dXJuIHtBcnJheTxEUy5Nb2RlbD59CiAgKi8KICBwdXNoTWFu
        eTogZnVuY3Rpb24odHlwZSwgZGF0YXMpIHsKICAgIHJldHVybiBtYXAoZGF0
        YXMsIGZ1bmN0aW9uKGRhdGEpIHsKICAgICAgcmV0dXJuIHRoaXMucHVzaCh0
        eXBlLCBkYXRhKTsKICAgIH0sIHRoaXMpOwogIH0sCgogIC8qKgogICAgQnVp
        bGQgYSBicmFuZCBuZXcgcmVjb3JkIGZvciBhIGdpdmVuIHR5cGUsIElELCBh
        bmQKICAgIGluaXRpYWwgZGF0YS4KCiAgICBAbWV0aG9kIGJ1aWxkUmVjb3Jk
        CiAgICBAcHJpdmF0ZQogICAgQHBhcmFtIHtzdWJjbGFzcyBvZiBEUy5Nb2Rl
        bH0gdHlwZQogICAgQHBhcmFtIHtTdHJpbmd9IGlkCiAgICBAcGFyYW0ge09i
        amVjdH0gZGF0YQogICAgQHJldHVybnMgRFMuTW9kZWwKICAqLwogIGJ1aWxk
        UmVjb3JkOiBmdW5jdGlvbih0eXBlLCBpZCwgZGF0YSkgewogICAgdmFyIHR5
        cGVNYXAgPSB0aGlzLnR5cGVNYXBGb3IodHlwZSksCiAgICAgICAgaWRUb1Jl
        Y29yZCA9IHR5cGVNYXAuaWRUb1JlY29yZDsKCiAgICBFbWJlci5hc3NlcnQo
        J1RoZSBpZCAnICsgaWQgKyAnIGhhcyBhbHJlYWR5IGJlZW4gdXNlZCB3aXRo
        IGFub3RoZXIgcmVjb3JkIG9mIHR5cGUgJyArIHR5cGUudG9TdHJpbmcoKSAr
        ICcuJywgIWlkIHx8ICFpZFRvUmVjb3JkW2lkXSk7CgogICAgdmFyIHJlY29y
        ZCA9IHR5cGUuX2NyZWF0ZSh7CiAgICAgIGlkOiBpZCwKICAgICAgc3RvcmU6
        IHRoaXMsCiAgICB9KTsKCiAgICBpZiAoZGF0YSkgewogICAgICByZWNvcmQu
        c2V0dXBEYXRhKGRhdGEpOwogICAgfQoKICAgIC8vIGlmIHdlJ3JlIGNyZWF0
        aW5nIGFuIGl0ZW0sIHRoaXMgcHJvY2VzcyB3aWxsIGJlIGRvbmUKICAgIC8v
        IGxhdGVyLCBvbmNlIHRoZSBvYmplY3QgaGFzIGJlZW4gcGVyc2lzdGVkLgog
        ICAgaWYgKGlkKSB7CiAgICAgIGlkVG9SZWNvcmRbaWRdID0gcmVjb3JkOwog
        ICAgfQoKICAgIHR5cGVNYXAucmVjb3Jkcy5wdXNoKHJlY29yZCk7CgogICAg
        cmV0dXJuIHJlY29yZDsKICB9LAoKICAvLyAuLi4uLi4uLi4uLi4uLi4KICAv
        LyAuIERFU1RSVUNUSU9OIC4KICAvLyAuLi4uLi4uLi4uLi4uLi4KCiAgLyoq
        CiAgICBXaGVuIGEgcmVjb3JkIGlzIGRlc3Ryb3llZCwgdGhpcyB1bi1pbmRl
        eGVzIGl0IGFuZAogICAgcmVtb3ZlcyBpdCBmcm9tIGFueSByZWNvcmQgYXJy
        YXlzIHNvIGl0IGNhbiBiZSBHQ2VkLgoKICAgIEBtZXRob2QgZGVtYXRlcmlh
        bGl6ZVJlY29yZAogICAgQHByaXZhdGUKICAgIEBwYXJhbSB7RFMuTW9kZWx9
        IHJlY29yZAogICovCiAgZGVtYXRlcmlhbGl6ZVJlY29yZDogZnVuY3Rpb24o
        cmVjb3JkKSB7CiAgICB2YXIgdHlwZSA9IHJlY29yZC5jb25zdHJ1Y3RvciwK
        ICAgICAgICB0eXBlTWFwID0gdGhpcy50eXBlTWFwRm9yKHR5cGUpLAogICAg
        ICAgIGlkID0gZ2V0KHJlY29yZCwgJ2lkJyk7CgogICAgcmVjb3JkLnVwZGF0
        ZVJlY29yZEFycmF5cygpOwoKICAgIGlmIChpZCkgewogICAgICBkZWxldGUg
        dHlwZU1hcC5pZFRvUmVjb3JkW2lkXTsKICAgIH0KCiAgICB2YXIgbG9jID0g
        aW5kZXhPZih0eXBlTWFwLnJlY29yZHMsIHJlY29yZCk7CiAgICB0eXBlTWFw
        LnJlY29yZHMuc3BsaWNlKGxvYywgMSk7CiAgfSwKCiAgLy8gLi4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uCiAgLy8gLiBSRUxBVElPTlNISVAgQ0hBTkdFUyAu
        CiAgLy8gLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uCgogIGFkZFJlbGF0aW9u
        c2hpcENoYW5nZUZvcjogZnVuY3Rpb24oY2hpbGRSZWNvcmQsIGNoaWxkS2V5
        LCBwYXJlbnRSZWNvcmQsIHBhcmVudEtleSwgY2hhbmdlKSB7CiAgICB2YXIg
        Y2xpZW50SWQgPSBjaGlsZFJlY29yZC5jbGllbnRJZCwKICAgICAgICBwYXJl
        bnRDbGllbnRJZCA9IHBhcmVudFJlY29yZCA/IHBhcmVudFJlY29yZCA6IHBh
        cmVudFJlY29yZDsKICAgIHZhciBrZXkgPSBjaGlsZEtleSArIHBhcmVudEtl
        eTsKICAgIHZhciBjaGFuZ2VzID0gdGhpcy5fcmVsYXRpb25zaGlwQ2hhbmdl
        czsKICAgIGlmICghKGNsaWVudElkIGluIGNoYW5nZXMpKSB7CiAgICAgIGNo
        YW5nZXNbY2xpZW50SWRdID0ge307CiAgICB9CiAgICBpZiAoIShwYXJlbnRD
        bGllbnRJZCBpbiBjaGFuZ2VzW2NsaWVudElkXSkpIHsKICAgICAgY2hhbmdl
        c1tjbGllbnRJZF1bcGFyZW50Q2xpZW50SWRdID0ge307CiAgICB9CiAgICBp
        ZiAoIShrZXkgaW4gY2hhbmdlc1tjbGllbnRJZF1bcGFyZW50Q2xpZW50SWRd
        KSkgewogICAgICBjaGFuZ2VzW2NsaWVudElkXVtwYXJlbnRDbGllbnRJZF1b
        a2V5XSA9IHt9OwogICAgfQogICAgY2hhbmdlc1tjbGllbnRJZF1bcGFyZW50
        Q2xpZW50SWRdW2tleV1bY2hhbmdlLmNoYW5nZVR5cGVdID0gY2hhbmdlOwog
        IH0sCgogIHJlbW92ZVJlbGF0aW9uc2hpcENoYW5nZUZvcjogZnVuY3Rpb24o
        Y2xpZW50UmVjb3JkLCBjaGlsZEtleSwgcGFyZW50UmVjb3JkLCBwYXJlbnRL
        ZXksIHR5cGUpIHsKICAgIHZhciBjbGllbnRJZCA9IGNsaWVudFJlY29yZC5j
        bGllbnRJZCwKICAgICAgICBwYXJlbnRDbGllbnRJZCA9IHBhcmVudFJlY29y
        ZCA/IHBhcmVudFJlY29yZC5jbGllbnRJZCA6IHBhcmVudFJlY29yZDsKICAg
        IHZhciBjaGFuZ2VzID0gdGhpcy5fcmVsYXRpb25zaGlwQ2hhbmdlczsKICAg
        IHZhciBrZXkgPSBjaGlsZEtleSArIHBhcmVudEtleTsKICAgIGlmICghKGNs
        aWVudElkIGluIGNoYW5nZXMpIHx8ICEocGFyZW50Q2xpZW50SWQgaW4gY2hh
        bmdlc1tjbGllbnRJZF0pIHx8ICEoa2V5IGluIGNoYW5nZXNbY2xpZW50SWRd
        W3BhcmVudENsaWVudElkXSkpewogICAgICByZXR1cm47CiAgICB9CiAgICBk
        ZWxldGUgY2hhbmdlc1tjbGllbnRJZF1bcGFyZW50Q2xpZW50SWRdW2tleV1b
        dHlwZV07CiAgfSwKCiAgcmVsYXRpb25zaGlwQ2hhbmdlUGFpcnNGb3I6IGZ1
        bmN0aW9uKHJlY29yZCl7CiAgICB2YXIgdG9SZXR1cm4gPSBbXTsKCiAgICBp
        ZiggIXJlY29yZCApIHsgcmV0dXJuIHRvUmV0dXJuOyB9CgogICAgLy9UT0RP
        KElnb3IpIFdoYXQgYWJvdXQgdGhlIG90aGVyIHNpZGUKICAgIHZhciBjaGFu
        Z2VzT2JqZWN0ID0gdGhpcy5fcmVsYXRpb25zaGlwQ2hhbmdlc1tyZWNvcmQu
        Y2xpZW50SWRdOwogICAgZm9yICh2YXIgb2JqS2V5IGluIGNoYW5nZXNPYmpl
        Y3QpewogICAgICBpZihjaGFuZ2VzT2JqZWN0Lmhhc093blByb3BlcnR5KG9i
        aktleSkpewogICAgICAgIGZvciAodmFyIGNoYW5nZUtleSBpbiBjaGFuZ2Vz
        T2JqZWN0W29iaktleV0pewogICAgICAgICAgaWYoY2hhbmdlc09iamVjdFtv
        YmpLZXldLmhhc093blByb3BlcnR5KGNoYW5nZUtleSkpewogICAgICAgICAg
        ICB0b1JldHVybi5wdXNoKGNoYW5nZXNPYmplY3Rbb2JqS2V5XVtjaGFuZ2VL
        ZXldKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0KICAg
        IHJldHVybiB0b1JldHVybjsKICB9LAoKICAvLyAuLi4uLi4uLi4uLi4uLi4u
        Li4uLi4uCiAgLy8gLiBQRVItVFlQRSBBREFQVEVSUwogIC8vIC4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4KCiAgLyoqCiAgICBSZXR1cm5zIHRoZSBhZGFwdGVy
        IGZvciBhIGdpdmVuIHR5cGUuCgogICAgQG1ldGhvZCBhZGFwdGVyRm9yVHlw
        ZQogICAgQHByaXZhdGUKICAgIEBwYXJhbSB7c3ViY2xhc3Mgb2YgRFMuTW9k
        ZWx9IHR5cGUKICAgIEByZXR1cm5zIERTLkFkYXB0ZXIKICAqLwogIGFkYXB0
        ZXJGb3JUeXBlOiBmdW5jdGlvbih0eXBlKSB7CiAgICB2YXIgY29udGFpbmVy
        ID0gdGhpcy5jb250YWluZXIsIGFkYXB0ZXI7CgogICAgaWYgKGNvbnRhaW5l
        cikgewogICAgICBhZGFwdGVyID0gY29udGFpbmVyLmxvb2t1cCgnYWRhcHRl
        cjonICsgdHlwZS50eXBlS2V5KSB8fCBjb250YWluZXIubG9va3VwKCdhZGFw
        dGVyOmFwcGxpY2F0aW9uJyk7CiAgICB9CgogICAgcmV0dXJuIGFkYXB0ZXIg
        fHwgZ2V0KHRoaXMsICdfYWRhcHRlcicpOwogIH0sCgogIC8vIC4uLi4uLi4u
        Li4uLi4uLi4uLi4uLi4uLi4uLi4uLgogIC8vIC4gUkVDT1JEIENIQU5HRSBO
        T1RJRklDQVRJT04gLgogIC8vIC4uLi4uLi4uLi4uLi4uLi4uLi4uLi4uLi4u
        Li4uLgoKICAvKioKICAgIFJldHVybnMgYW4gaW5zdGFuY2Ugb2YgdGhlIHNl
        cmlhbGl6ZXIgZm9yIGEgZ2l2ZW4gdHlwZS4gRm9yCiAgICBleGFtcGxlLCBg
        c2VyaWFsaXplckZvcigncGVyc29uJylgIHdpbGwgcmV0dXJuIGFuIGluc3Rh
        bmNlIG9mCiAgICBgQXBwLlBlcnNvblNlcmlhbGl6ZXJgLgoKICAgIElmIG5v
        IGBBcHAuUGVyc29uU2VyaWFsaXplcmAgaXMgZm91bmQsIHRoaXMgbWV0aG9k
        IHdpbGwgbG9vawogICAgZm9yIGFuIGBBcHAuQXBwbGljYXRpb25TZXJpYWxp
        emVyYCAodGhlIGRlZmF1bHQgc2VyaWFsaXplciBmb3IKICAgIHlvdXIgZW50
        aXJlIGFwcGxpY2F0aW9uKS4KCiAgICBJZiBubyBgQXBwLkFwcGxpY2F0aW9u
        U2VyaWFsaXplcmAgaXMgZm91bmQsIGl0IHdpbGwgZmFsbCBiYWNrCiAgICB0
        byBhbiBpbnN0YW5jZSBvZiBgRFMuSlNPTlNlcmlhbGl6ZXJgLgoKICAgIEBt
        ZXRob2Qgc2VyaWFsaXplckZvcgogICAgQHByaXZhdGUKICAgIEBwYXJhbSB7
        U3RyaW5nfSB0eXBlIHRoZSByZWNvcmQgdG8gc2VyaWFsaXplCiAgKi8KICBz
        ZXJpYWxpemVyRm9yOiBmdW5jdGlvbih0eXBlKSB7CiAgICB2YXIgY29udGFp
        bmVyID0gdGhpcy5jb250YWluZXI7CgogICAgLy8gVE9ETzogTWFrZSB0ZXN0
        cyBwYXNzIHdpdGhvdXQgdGhpcwoKICAgIGlmICghY29udGFpbmVyKSB7CiAg
        ICAgIHJldHVybiBEUy5KU09OU2VyaWFsaXplci5jcmVhdGUoeyBzdG9yZTog
        dGhpcyB9KTsKICAgIH0KCiAgICByZXR1cm4gY29udGFpbmVyLmxvb2t1cCgn
        c2VyaWFsaXplcjonK3R5cGUpIHx8CiAgICAgICAgICAgY29udGFpbmVyLmxv
        b2t1cCgnc2VyaWFsaXplcjphcHBsaWNhdGlvbicpIHx8CiAgICAgICAgICAg
        Y29udGFpbmVyLmxvb2t1cCgnc2VyaWFsaXplcjpfZGVmYXVsdCcpOwogIH0K
        fSk7CgovLyBEZWxlZ2F0aW9uIHRvIHRoZSBhZGFwdGVyIGFuZCBwcm9taXNl
        IG1hbmFnZW1lbnQKCkRTLlByb21pc2VBcnJheSA9IEVtYmVyLkFycmF5UHJv
        eHkuZXh0ZW5kKEVtYmVyLlByb21pc2VQcm94eU1peGluKTsKRFMuUHJvbWlz
        ZU9iamVjdCA9IEVtYmVyLk9iamVjdFByb3h5LmV4dGVuZChFbWJlci5Qcm9t
        aXNlUHJveHlNaXhpbik7CgpmdW5jdGlvbiBwcm9taXNlT2JqZWN0KHByb21p
        c2UpIHsKICByZXR1cm4gRFMuUHJvbWlzZU9iamVjdC5jcmVhdGUoeyBwcm9t
        aXNlOiBwcm9taXNlIH0pOwp9CgpmdW5jdGlvbiBwcm9taXNlQXJyYXkocHJv
        bWlzZSkgewogIHJldHVybiBEUy5Qcm9taXNlQXJyYXkuY3JlYXRlKHsgcHJv
        bWlzZTogcHJvbWlzZSB9KTsKfQoKZnVuY3Rpb24gaXNUaGVuYWJsZShvYmpl
        Y3QpIHsKICByZXR1cm4gb2JqZWN0ICYmIHR5cGVvZiBvYmplY3QudGhlbiA9
        PT0gJ2Z1bmN0aW9uJzsKfQoKZnVuY3Rpb24gc2VyaWFsaXplckZvcihhZGFw
        dGVyLCB0eXBlKSB7CiAgdmFyIHNlcmlhbGl6ZXIgPSBhZGFwdGVyLnNlcmlh
        bGl6ZXIsCiAgICAgIGRlZmF1bHRTZXJpYWxpemVyID0gYWRhcHRlci5kZWZh
        dWx0U2VyaWFsaXplciwKICAgICAgY29udGFpbmVyID0gYWRhcHRlci5jb250
        YWluZXI7CgogIGlmIChjb250YWluZXIgJiYgc2VyaWFsaXplciA9PT0gdW5k
        ZWZpbmVkKSB7CiAgICBzZXJpYWxpemVyID0gY29udGFpbmVyLmxvb2t1cCgn
        c2VyaWFsaXplcjonK3R5cGUudHlwZUtleSkgfHwKICAgICAgICAgICAgICAg
        ICBjb250YWluZXIubG9va3VwKCdzZXJpYWxpemVyOmFwcGxpY2F0aW9uJykg
        fHwKICAgICAgICAgICAgICAgICBjb250YWluZXIubG9va3VwKCdzZXJpYWxp
        emVyOicgKyBkZWZhdWx0U2VyaWFsaXplciB8fCAnc2VyaWFsaXplcjpfZGVm
        YXVsdCcpOwogIH0KCiAgaWYgKHNlcmlhbGl6ZXIgPT09IG51bGwgfHwgc2Vy
        aWFsaXplciA9PT0gdW5kZWZpbmVkKSB7CiAgICBzZXJpYWxpemVyID0gewog
        ICAgICBleHRyYWN0OiBmdW5jdGlvbihzdG9yZSwgdHlwZSwgcGF5bG9hZCkg
        eyByZXR1cm4gcGF5bG9hZDsgfQogICAgfTsKICB9CgogIHJldHVybiBzZXJp
        YWxpemVyOwp9CgpmdW5jdGlvbiBfZmluZChhZGFwdGVyLCBzdG9yZSwgdHlw
        ZSwgaWQsIHJlc29sdmVyKSB7CiAgdmFyIHByb21pc2UgPSBhZGFwdGVyLmZp
        bmQoc3RvcmUsIHR5cGUsIGlkKSwKICAgICAgc2VyaWFsaXplciA9IHNlcmlh
        bGl6ZXJGb3IoYWRhcHRlciwgdHlwZSk7CgogIHJldHVybiByZXNvbHZlKHBy
        b21pc2UpLnRoZW4oZnVuY3Rpb24ocGF5bG9hZCkgewogICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgbWFkZSBhIHJlcXVlc3QgZm9yIGEgIiArIHR5cGUudHlwZUtl
        eSArICIgd2l0aCBpZCAiICsgaWQgKyAiLCBidXQgdGhlIGFkYXB0ZXIncyBy
        ZXNwb25zZSBkaWQgbm90IGhhdmUgYW55IGRhdGEiLCBwYXlsb2FkKTsKICAg
        IHBheWxvYWQgPSBzZXJpYWxpemVyLmV4dHJhY3Qoc3RvcmUsIHR5cGUsIHBh
        eWxvYWQsIGlkLCAnZmluZCcpOwoKICAgIHJldHVybiBzdG9yZS5wdXNoKHR5
        cGUsIHBheWxvYWQpOwogIH0pLnRoZW4ocmVzb2x2ZXIucmVzb2x2ZSwgcmVz
        b2x2ZXIucmVqZWN0KTsKfQoKZnVuY3Rpb24gX2ZpbmRNYW55KGFkYXB0ZXIs
        IHN0b3JlLCB0eXBlLCBpZHMsIG93bmVyLCByZXNvbHZlcikgewogIHZhciBw
        cm9taXNlID0gYWRhcHRlci5maW5kTWFueShzdG9yZSwgdHlwZSwgaWRzLCBv
        d25lciksCiAgICAgIHNlcmlhbGl6ZXIgPSBzZXJpYWxpemVyRm9yKGFkYXB0
        ZXIsIHR5cGUpOwoKICByZXR1cm4gcmVzb2x2ZShwcm9taXNlKS50aGVuKGZ1
        bmN0aW9uKHBheWxvYWQpIHsKICAgIHBheWxvYWQgPSBzZXJpYWxpemVyLmV4
        dHJhY3Qoc3RvcmUsIHR5cGUsIHBheWxvYWQsIG51bGwsICdmaW5kTWFueScp
        OwoKICAgIHN0b3JlLnB1c2hNYW55KHR5cGUsIHBheWxvYWQpOwogIH0pLnRo
        ZW4ocmVzb2x2ZXIucmVzb2x2ZSwgcmVzb2x2ZXIucmVqZWN0KTsKfQoKZnVu
        Y3Rpb24gX2ZpbmRIYXNNYW55KGFkYXB0ZXIsIHN0b3JlLCByZWNvcmQsIGxp
        bmssIHJlbGF0aW9uc2hpcCwgcmVzb2x2ZXIpIHsKICB2YXIgcHJvbWlzZSA9
        IGFkYXB0ZXIuZmluZEhhc01hbnkoc3RvcmUsIHJlY29yZCwgbGluaywgcmVs
        YXRpb25zaGlwKSwKICAgICAgc2VyaWFsaXplciA9IHNlcmlhbGl6ZXJGb3Io
        YWRhcHRlciwgcmVsYXRpb25zaGlwLnR5cGUpOwoKICByZXR1cm4gcmVzb2x2
        ZShwcm9taXNlKS50aGVuKGZ1bmN0aW9uKHBheWxvYWQpIHsKICAgIHBheWxv
        YWQgPSBzZXJpYWxpemVyLmV4dHJhY3Qoc3RvcmUsIHJlbGF0aW9uc2hpcC50
        eXBlLCBwYXlsb2FkLCBudWxsLCAnZmluZEhhc01hbnknKTsKCiAgICB2YXIg
        cmVjb3JkcyA9IHN0b3JlLnB1c2hNYW55KHJlbGF0aW9uc2hpcC50eXBlLCBw
        YXlsb2FkKTsKICAgIHJlY29yZC51cGRhdGVIYXNNYW55KHJlbGF0aW9uc2hp
        cC5rZXksIHJlY29yZHMpOwogIH0pLnRoZW4ocmVzb2x2ZXIucmVzb2x2ZSwg
        cmVzb2x2ZXIucmVqZWN0KTsKfQoKZnVuY3Rpb24gX2ZpbmRBbGwoYWRhcHRl
        ciwgc3RvcmUsIHR5cGUsIHNpbmNlVG9rZW4sIHJlc29sdmVyKSB7CiAgdmFy
        IHByb21pc2UgPSBhZGFwdGVyLmZpbmRBbGwoc3RvcmUsIHR5cGUsIHNpbmNl
        VG9rZW4pLAogICAgICBzZXJpYWxpemVyID0gc2VyaWFsaXplckZvcihhZGFw
        dGVyLCB0eXBlKTsKCiAgcmV0dXJuIHJlc29sdmUocHJvbWlzZSkudGhlbihm
        dW5jdGlvbihwYXlsb2FkKSB7CiAgICBwYXlsb2FkID0gc2VyaWFsaXplci5l
        eHRyYWN0KHN0b3JlLCB0eXBlLCBwYXlsb2FkLCBudWxsLCAnZmluZEFsbCcp
        OwoKICAgIHN0b3JlLnB1c2hNYW55KHR5cGUsIHBheWxvYWQpOwogICAgc3Rv
        cmUuZGlkVXBkYXRlQWxsKHR5cGUpOwogICAgcmV0dXJuIHN0b3JlLmFsbCh0
        eXBlKTsKICB9KS50aGVuKHJlc29sdmVyLnJlc29sdmUsIHJlc29sdmVyLnJl
        amVjdCk7Cn0KCmZ1bmN0aW9uIF9maW5kUXVlcnkoYWRhcHRlciwgc3RvcmUs
        IHR5cGUsIHF1ZXJ5LCByZWNvcmRBcnJheSwgcmVzb2x2ZXIpIHsKICB2YXIg
        cHJvbWlzZSA9IGFkYXB0ZXIuZmluZFF1ZXJ5KHN0b3JlLCB0eXBlLCBxdWVy
        eSwgcmVjb3JkQXJyYXkpLAogICAgICBzZXJpYWxpemVyID0gc2VyaWFsaXpl
        ckZvcihhZGFwdGVyLCB0eXBlKTsKCiAgcmV0dXJuIHJlc29sdmUocHJvbWlz
        ZSkudGhlbihmdW5jdGlvbihwYXlsb2FkKSB7CiAgICBwYXlsb2FkID0gc2Vy
        aWFsaXplci5leHRyYWN0KHN0b3JlLCB0eXBlLCBwYXlsb2FkLCBudWxsLCAn
        ZmluZEFsbCcpOwoKICAgIHJlY29yZEFycmF5LmxvYWQocGF5bG9hZCk7CiAg
        ICByZXR1cm4gcmVjb3JkQXJyYXk7CiAgfSkudGhlbihyZXNvbHZlci5yZXNv
        bHZlLCByZXNvbHZlci5yZWplY3QpOwp9CgpmdW5jdGlvbiBfY29tbWl0KGFk
        YXB0ZXIsIHN0b3JlLCBvcGVyYXRpb24sIHJlY29yZCwgcmVzb2x2ZXIpIHsK
        ICB2YXIgdHlwZSA9IHJlY29yZC5jb25zdHJ1Y3RvciwKICAgICAgcHJvbWlz
        ZSA9IGFkYXB0ZXJbb3BlcmF0aW9uXShzdG9yZSwgdHlwZSwgcmVjb3JkKSwK
        ICAgICAgc2VyaWFsaXplciA9IHNlcmlhbGl6ZXJGb3IoYWRhcHRlciwgdHlw
        ZSk7CgogIEVtYmVyLmFzc2VydCgiWW91ciBhZGFwdGVyJ3MgJyIgKyBvcGVy
        YXRpb24gKyAiJyBtZXRob2QgbXVzdCByZXR1cm4gYSBwcm9taXNlLCBidXQg
        aXQgcmV0dXJuZWQgIiArIHByb21pc2UsIGlzVGhlbmFibGUocHJvbWlzZSkp
        OwoKICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHBheWxvYWQpIHsK
        ICAgIHBheWxvYWQgPSBzZXJpYWxpemVyLmV4dHJhY3Qoc3RvcmUsIHR5cGUs
        IHBheWxvYWQsIGdldChyZWNvcmQsICdpZCcpLCBvcGVyYXRpb24pOwogICAg
        c3RvcmUuZGlkU2F2ZVJlY29yZChyZWNvcmQsIHBheWxvYWQpOwogICAgcmV0
        dXJuIHJlY29yZDsKICB9LCBmdW5jdGlvbihyZWFzb24pIHsKICAgIGlmIChy
        ZWFzb24gaW5zdGFuY2VvZiBEUy5JbnZhbGlkRXJyb3IpIHsKICAgICAgc3Rv
        cmUucmVjb3JkV2FzSW52YWxpZChyZWNvcmQsIHJlYXNvbi5lcnJvcnMpOwog
        ICAgfSBlbHNlIHsKICAgICAgc3RvcmUucmVjb3JkV2FzRXJyb3IocmVjb3Jk
        LCByZWFzb24pOwogICAgfQoKICAgIHRocm93IHJlYXNvbjsKICB9KS50aGVu
        KHJlc29sdmVyLnJlc29sdmUsIHJlc29sdmVyLnJlamVjdCk7Cn0KCn0pKCk7
        CgoKCihmdW5jdGlvbigpIHsKLyoqCiAgQG1vZHVsZSBlbWJlci1kYXRhCiov
        Cgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQsCiAgICBv
        bmNlID0gRW1iZXIucnVuLm9uY2UsIGFycmF5TWFwID0gRW1iZXIuQXJyYXlQ
        b2x5ZmlsbHMubWFwOwoKLyoKICBXQVJOSU5HOiBNdWNoIG9mIHRoZXNlIGRv
        Y3MgYXJlIGluYWNjdXJhdGUgYXMgb2YgYmY4NDk3LgoKICBUaGlzIGZpbGUg
        ZW5jYXBzdWxhdGVzIHRoZSB2YXJpb3VzIHN0YXRlcyB0aGF0IGEgcmVjb3Jk
        IGNhbiB0cmFuc2l0aW9uCiAgdGhyb3VnaCBkdXJpbmcgaXRzIGxpZmVjeWNs
        ZS4KCiAgIyMjIFN0YXRlIE1hbmFnZXIKCiAgQSByZWNvcmQncyBzdGF0ZSBt
        YW5hZ2VyIGV4cGxpY2l0bHkgdHJhY2tzIHdoYXQgc3RhdGUgYSByZWNvcmQg
        aXMgaW4KICBhdCBhbnkgZ2l2ZW4gdGltZS4gRm9yIGluc3RhbmNlLCBpZiBh
        IHJlY29yZCBpcyBuZXdseSBjcmVhdGVkIGFuZCBoYXMKICBub3QgeWV0IGJl
        ZW4gc2VudCB0byB0aGUgYWRhcHRlciB0byBiZSBzYXZlZCwgaXQgd291bGQg
        YmUgaW4gdGhlCiAgYGNyZWF0ZWQudW5jb21taXR0ZWRgIHN0YXRlLiAgSWYg
        YSByZWNvcmQgaGFzIGhhZCBsb2NhbCBtb2RpZmljYXRpb25zCiAgbWFkZSB0
        byBpdCB0aGF0IGFyZSBpbiB0aGUgcHJvY2VzcyBvZiBiZWluZyBzYXZlZCwg
        dGhlIHJlY29yZCB3b3VsZCBiZQogIGluIHRoZSBgdXBkYXRlZC5pbkZsaWdo
        dGAgc3RhdGUuIChUaGVzZSBzdGF0ZSBwYXRocyB3aWxsIGJlIGV4cGxhaW5l
        ZAogIGluIG1vcmUgZGV0YWlsIGJlbG93LikKCiAgRXZlbnRzIGFyZSBzZW50
        IGJ5IHRoZSByZWNvcmQgb3IgaXRzIHN0b3JlIHRvIHRoZSByZWNvcmQncyBz
        dGF0ZSBtYW5hZ2VyLgogIEhvdyB0aGUgc3RhdGUgbWFuYWdlciByZWFjdHMg
        dG8gdGhlc2UgZXZlbnRzIGlzIGRlcGVuZGVudCBvbiB3aGljaCBzdGF0ZQog
        IGl0IGlzIGluLiBJbiBzb21lIHN0YXRlcywgY2VydGFpbiBldmVudHMgd2ls
        bCBiZSBpbnZhbGlkIGFuZCB3aWxsIGNhdXNlCiAgYW4gZXhjZXB0aW9uIHRv
        IGJlIHJhaXNlZC4KCiAgU3RhdGVzIGFyZSBoaWVyYXJjaGljYWwuIEZvciBl
        eGFtcGxlLCBhIHJlY29yZCBjYW4gYmUgaW4gdGhlCiAgYGRlbGV0ZWQuc3Rh
        cnRgIHN0YXRlLCB0aGVuIHRyYW5zaXRpb24gaW50byB0aGUgYGRlbGV0ZWQu
        aW5GbGlnaHRgIHN0YXRlLgogIElmIGEgY2hpbGQgc3RhdGUgZG9lcyBub3Qg
        aW1wbGVtZW50IGFuIGV2ZW50IGhhbmRsZXIsIHRoZSBzdGF0ZSBtYW5hZ2Vy
        CiAgd2lsbCBhdHRlbXB0IHRvIGludm9rZSB0aGUgZXZlbnQgb24gYWxsIHBh
        cmVudCBzdGF0ZXMgdW50aWwgdGhlIHJvb3Qgc3RhdGUgaXMKICByZWFjaGVk
        LiBUaGUgc3RhdGUgaGllcmFyY2h5IG9mIGEgcmVjb3JkIGlzIGRlc2NyaWJl
        ZCBpbiB0ZXJtcyBvZiBhIHBhdGgKICBzdHJpbmcuIFlvdSBjYW4gZGV0ZXJt
        aW5lIGEgcmVjb3JkJ3MgY3VycmVudCBzdGF0ZSBieSBnZXR0aW5nIGl0cyBt
        YW5hZ2VyJ3MKICBjdXJyZW50IHN0YXRlIHBhdGg6CgogICAgICByZWNvcmQu
        Z2V0KCdzdGF0ZU1hbmFnZXIuY3VycmVudFBhdGgnKTsKICAgICAgLy89PiAi
        Y3JlYXRlZC51bmNvbW1pdHRlZCIKCiAgVGhlIGBEUy5Nb2RlbGAgc3RhdGVz
        IGFyZSB0aGVtc2VsdmVzIHN0YXRlbGVzcy4gV2hhdCB3ZSBtZWFuIGlzIHRo
        YXQsCiAgdGhvdWdoIGVhY2ggaW5zdGFuY2Ugb2YgYSByZWNvcmQgYWxzbyBo
        YXMgYSB1bmlxdWUgaW5zdGFuY2Ugb2YgYQogIGBEUy5TdGF0ZU1hbmFnZXJg
        LCB0aGUgaGllcmFyY2hpY2FsIHN0YXRlcyB0aGF0IGVhY2ggb2YgKnRob3Nl
        KiBwb2ludHMKICB0byBpcyBhIHNoYXJlZCBkYXRhIHN0cnVjdHVyZS4gRm9y
        IHBlcmZvcm1hbmNlIHJlYXNvbnMsIGluc3RlYWQgb2YgZWFjaAogIHJlY29y
        ZCBnZXR0aW5nIGl0cyBvd24gY29weSBvZiB0aGUgaGllcmFyY2h5IG9mIHN0
        YXRlcywgZWFjaCBzdGF0ZQogIG1hbmFnZXIgcG9pbnRzIHRvIHRoaXMgZ2xv
        YmFsLCBpbW11dGFibGUgc2hhcmVkIGluc3RhbmNlLiBIb3cgZG9lcyBhCiAg
        c3RhdGUga25vdyB3aGljaCByZWNvcmQgaXQgc2hvdWxkIGJlIGFjdGluZyBv
        bj8gIFdlIHBhc3MgYSByZWZlcmVuY2UgdG8KICB0aGUgY3VycmVudCBzdGF0
        ZSBtYW5hZ2VyIGFzIHRoZSBmaXJzdCBwYXJhbWV0ZXIgdG8gZXZlcnkgbWV0
        aG9kIGludm9rZWQKICBvbiBhIHN0YXRlLgoKICBUaGUgc3RhdGUgbWFuYWdl
        ciBwYXNzZWQgYXMgdGhlIGZpcnN0IHBhcmFtZXRlciBpcyB3aGVyZSB5b3Ug
        c2hvdWxkIHN0YXNoCiAgc3RhdGUgYWJvdXQgdGhlIHJlY29yZCBpZiBuZWVk
        ZWQ7IHlvdSBzaG91bGQgbmV2ZXIgc3RvcmUgZGF0YSBvbiB0aGUgc3RhdGUK
        ICBvYmplY3QgaXRzZWxmLiBJZiB5b3UgbmVlZCBhY2Nlc3MgdG8gdGhlIHJl
        Y29yZCBiZWluZyBhY3RlZCBvbiwgeW91IGNhbgogIHJldHJpZXZlIHRoZSBz
        dGF0ZSBtYW5hZ2VyJ3MgYHJlY29yZGAgcHJvcGVydHkuIEZvciBleGFtcGxl
        LCBpZiB5b3UgaGFkCiAgYW4gZXZlbnQgaGFuZGxlciBgbXlFdmVudGA6Cgog
        ICAgICBteUV2ZW50OiBmdW5jdGlvbihtYW5hZ2VyKSB7CiAgICAgICAgdmFy
        IHJlY29yZCA9IG1hbmFnZXIuZ2V0KCdyZWNvcmQnKTsKICAgICAgICByZWNv
        cmQuZG9Tb21ldGhpbmcoKTsKICAgICAgfQoKICBGb3IgbW9yZSBpbmZvcm1h
        dGlvbiBhYm91dCBzdGF0ZSBtYW5hZ2VycyBpbiBnZW5lcmFsLCBzZWUgdGhl
        IEVtYmVyLmpzCiAgZG9jdW1lbnRhdGlvbiBvbiBgRW1iZXIuU3RhdGVNYW5h
        Z2VyYC4KCiAgIyMjIEV2ZW50cywgRmxhZ3MsIGFuZCBUcmFuc2l0aW9ucwoK
        ICBBIHN0YXRlIG1heSBpbXBsZW1lbnQgemVybyBvciBtb3JlIGV2ZW50cywg
        ZmxhZ3MsIG9yIHRyYW5zaXRpb25zLgoKICAjIyMjIEV2ZW50cwoKICBFdmVu
        dHMgYXJlIG5hbWVkIGZ1bmN0aW9ucyB0aGF0IGFyZSBpbnZva2VkIHdoZW4g
        c2VudCB0byBhIHJlY29yZC4gVGhlCiAgc3RhdGUgbWFuYWdlciB3aWxsIGZp
        cnN0IGxvb2sgZm9yIGEgbWV0aG9kIHdpdGggdGhlIGdpdmVuIG5hbWUgb24g
        dGhlCiAgY3VycmVudCBzdGF0ZS4gSWYgbm8gbWV0aG9kIGlzIGZvdW5kLCBp
        dCB3aWxsIHNlYXJjaCB0aGUgY3VycmVudCBzdGF0ZSdzCiAgcGFyZW50LCBh
        bmQgdGhlbiBpdHMgZ3JhbmRwYXJlbnQsIGFuZCBzbyBvbiB1bnRpbCByZWFj
        aGluZyB0aGUgdG9wIG9mCiAgdGhlIGhpZXJhcmNoeS4gSWYgdGhlIHJvb3Qg
        aXMgcmVhY2hlZCB3aXRob3V0IGFuIGV2ZW50IGhhbmRsZXIgYmVpbmcgZm91
        bmQsCiAgYW4gZXhjZXB0aW9uIHdpbGwgYmUgcmFpc2VkLiBUaGlzIGNhbiBi
        ZSB2ZXJ5IGhlbHBmdWwgd2hlbiBkZWJ1Z2dpbmcgbmV3CiAgZmVhdHVyZXMu
        CgogIEhlcmUncyBhbiBleGFtcGxlIGltcGxlbWVudGF0aW9uIG9mIGEgc3Rh
        dGUgd2l0aCBhIGBteUV2ZW50YCBldmVudCBoYW5kbGVyOgoKICAgICAgYVN0
        YXRlOiBEUy5TdGF0ZS5jcmVhdGUoewogICAgICAgIG15RXZlbnQ6IGZ1bmN0
        aW9uKG1hbmFnZXIsIHBhcmFtKSB7CiAgICAgICAgICBjb25zb2xlLmxvZygi
        UmVjZWl2ZWQgbXlFdmVudCB3aXRoICIrcGFyYW0pOwogICAgICAgIH0KICAg
        ICAgfSkKCiAgVG8gdHJpZ2dlciB0aGlzIGV2ZW50OgoKICAgICAgcmVjb3Jk
        LnNlbmQoJ215RXZlbnQnLCAnZm9vJyk7CiAgICAgIC8vPT4gIlJlY2VpdmVk
        IG15RXZlbnQgd2l0aCBmb28iCgogIE5vdGUgdGhhdCBhbiBvcHRpb25hbCBw
        YXJhbWV0ZXIgY2FuIGJlIHNlbnQgdG8gYSByZWNvcmQncyBgc2VuZCgpYCBt
        ZXRob2QsCiAgd2hpY2ggd2lsbCBiZSBwYXNzZWQgYXMgdGhlIHNlY29uZCBw
        YXJhbWV0ZXIgdG8gdGhlIGV2ZW50IGhhbmRsZXIuCgogIEV2ZW50cyBzaG91
        bGQgdHJhbnNpdGlvbiB0byBhIGRpZmZlcmVudCBzdGF0ZSBpZiBhcHByb3By
        aWF0ZS4gVGhpcyBjYW4gYmUKICBkb25lIGJ5IGNhbGxpbmcgdGhlIHN0YXRl
        IG1hbmFnZXIncyBgdHJhbnNpdGlvblRvKClgIG1ldGhvZCB3aXRoIGEgcGF0
        aCB0byB0aGUKICBkZXNpcmVkIHN0YXRlLiBUaGUgc3RhdGUgbWFuYWdlciB3
        aWxsIGF0dGVtcHQgdG8gcmVzb2x2ZSB0aGUgc3RhdGUgcGF0aAogIHJlbGF0
        aXZlIHRvIHRoZSBjdXJyZW50IHN0YXRlLiBJZiBubyBzdGF0ZSBpcyBmb3Vu
        ZCBhdCB0aGF0IHBhdGgsIGl0IHdpbGwKICBhdHRlbXB0IHRvIHJlc29sdmUg
        aXQgcmVsYXRpdmUgdG8gdGhlIGN1cnJlbnQgc3RhdGUncyBwYXJlbnQsIGFu
        ZCB0aGVuIGl0cwogIHBhcmVudCwgYW5kIHNvIG9uIHVudGlsIHRoZSByb290
        IGlzIHJlYWNoZWQuIEZvciBleGFtcGxlLCBpbWFnaW5lIGEgaGllcmFyY2h5
        CiAgbGlrZSB0aGlzOgoKICAgICAgKiBjcmVhdGVkCiAgICAgICAgKiBzdGFy
        dCA8LS0gY3VycmVudFN0YXRlCiAgICAgICAgKiBpbkZsaWdodAogICAgICAq
        IHVwZGF0ZWQKICAgICAgICAqIGluRmxpZ2h0CgogIElmIHdlIGFyZSBjdXJy
        ZW50bHkgaW4gdGhlIGBzdGFydGAgc3RhdGUsIGNhbGxpbmcKICBgdHJhbnNp
        dGlvblRvKCdpbkZsaWdodCcpYCB3b3VsZCB0cmFuc2l0aW9uIHRvIHRoZSBg
        Y3JlYXRlZC5pbkZsaWdodGAgc3RhdGUsCiAgd2hpbGUgY2FsbGluZyBgdHJh
        bnNpdGlvblRvKCd1cGRhdGVkLmluRmxpZ2h0JylgIHdvdWxkIHRyYW5zaXRp
        b24gdG8KICB0aGUgYHVwZGF0ZWQuaW5GbGlnaHRgIHN0YXRlLgoKICBSZW1l
        bWJlciB0aGF0ICpvbmx5IGV2ZW50cyogc2hvdWxkIGV2ZXIgY2F1c2UgYSBz
        dGF0ZSB0cmFuc2l0aW9uLiBZb3Ugc2hvdWxkCiAgbmV2ZXIgY2FsbCBgdHJh
        bnNpdGlvblRvKClgIGZyb20gb3V0c2lkZSBhIHN0YXRlJ3MgZXZlbnQgaGFu
        ZGxlci4gSWYgeW91IGFyZQogIHRlbXB0ZWQgdG8gZG8gc28sIGNyZWF0ZSBh
        IG5ldyBldmVudCBhbmQgc2VuZCB0aGF0IHRvIHRoZSBzdGF0ZSBtYW5hZ2Vy
        LgoKICAjIyMjIEZsYWdzCgogIEZsYWdzIGFyZSBCb29sZWFuIHZhbHVlcyB0
        aGF0IGNhbiBiZSB1c2VkIHRvIGludHJvc3BlY3QgYSByZWNvcmQncyBjdXJy
        ZW50CiAgc3RhdGUgaW4gYSBtb3JlIHVzZXItZnJpZW5kbHkgd2F5IHRoYW4g
        ZXhhbWluaW5nIGl0cyBzdGF0ZSBwYXRoLiBGb3IgZXhhbXBsZSwKICBpbnN0
        ZWFkIG9mIGRvaW5nIHRoaXM6CgogICAgICB2YXIgc3RhdGVQYXRoID0gcmVj
        b3JkLmdldCgnc3RhdGVNYW5hZ2VyLmN1cnJlbnRQYXRoJyk7CiAgICAgIGlm
        IChzdGF0ZVBhdGggPT09ICdjcmVhdGVkLmluRmxpZ2h0JykgewogICAgICAg
        IGRvU29tZXRoaW5nKCk7CiAgICAgIH0KCiAgWW91IGNhbiBzYXk6CgogICAg
        ICBpZiAocmVjb3JkLmdldCgnaXNOZXcnKSAmJiByZWNvcmQuZ2V0KCdpc1Nh
        dmluZycpKSB7CiAgICAgICAgZG9Tb21ldGhpbmcoKTsKICAgICAgfQoKICBJ
        ZiB5b3VyIHN0YXRlIGRvZXMgbm90IHNldCBhIHZhbHVlIGZvciBhIGdpdmVu
        IGZsYWcsIHRoZSB2YWx1ZSB3aWxsCiAgYmUgaW5oZXJpdGVkIGZyb20gaXRz
        IHBhcmVudCAob3IgdGhlIGZpcnN0IHBsYWNlIGluIHRoZSBzdGF0ZSBoaWVy
        YXJjaHkKICB3aGVyZSBpdCBpcyBkZWZpbmVkKS4KCiAgVGhlIGN1cnJlbnQg
        c2V0IG9mIGZsYWdzIGFyZSBkZWZpbmVkIGJlbG93LiBJZiB5b3Ugd2FudCB0
        byBhZGQgYSBuZXcgZmxhZywKICBpbiBhZGRpdGlvbiB0byB0aGUgYXJlYSBi
        ZWxvdywgeW91IHdpbGwgYWxzbyBuZWVkIHRvIGRlY2xhcmUgaXQgaW4gdGhl
        CiAgYERTLk1vZGVsYCBjbGFzcy4KCiAgIyMjIyBUcmFuc2l0aW9ucwoKICBU
        cmFuc2l0aW9ucyBhcmUgbGlrZSBldmVudCBoYW5kbGVycyBidXQgYXJlIGNh
        bGxlZCBhdXRvbWF0aWNhbGx5IHVwb24KICBlbnRlcmluZyBvciBleGl0aW5n
        IGEgc3RhdGUuIFRvIGltcGxlbWVudCBhIHRyYW5zaXRpb24sIGp1c3QgY2Fs
        bCBhIG1ldGhvZAogIGVpdGhlciBgZW50ZXJgIG9yIGBleGl0YDoKCiAgICAg
        IG15U3RhdGU6IERTLlN0YXRlLmNyZWF0ZSh7CiAgICAgICAgLy8gR2V0cyBj
        YWxsZWQgYXV0b21hdGljYWxseSB3aGVuIGVudGVyaW5nCiAgICAgICAgLy8g
        dGhpcyBzdGF0ZS4KICAgICAgICBlbnRlcjogZnVuY3Rpb24obWFuYWdlcikg
        ewogICAgICAgICAgY29uc29sZS5sb2coIkVudGVyZWQgbXlTdGF0ZSIpOwog
        ICAgICAgIH0KICAgICAgfSkKCiAgTm90ZSB0aGF0IGVudGVyIGFuZCBleGl0
        IGV2ZW50cyBhcmUgY2FsbGVkIG9uY2UgcGVyIHRyYW5zaXRpb24uIElmIHRo
        ZQogIGN1cnJlbnQgc3RhdGUgY2hhbmdlcywgYnV0IGNoYW5nZXMgdG8gYW5v
        dGhlciBjaGlsZCBzdGF0ZSBvZiB0aGUgcGFyZW50LAogIHRoZSB0cmFuc2l0
        aW9uIGV2ZW50IG9uIHRoZSBwYXJlbnQgd2lsbCBub3QgYmUgdHJpZ2dlcmVk
        LgoqLwoKdmFyIGhhc0RlZmluZWRQcm9wZXJ0aWVzID0gZnVuY3Rpb24ob2Jq
        ZWN0KSB7CiAgLy8gSWdub3JlIGludGVybmFsIHByb3BlcnR5IGRlZmluZWQg
        Ynkgc2ltdWxhdGVkIGBFbWJlci5jcmVhdGVgLgogIHZhciBuYW1lcyA9IEVt
        YmVyLmtleXMob2JqZWN0KTsKICB2YXIgaSwgbCwgbmFtZTsKICBmb3IgKGkg
        PSAwLCBsID0gbmFtZXMubGVuZ3RoOyBpIDwgbDsgaSsrICkgewogICAgbmFt
        ZSA9IG5hbWVzW2ldOwogICAgaWYgKG9iamVjdC5oYXNPd25Qcm9wZXJ0eShu
        YW1lKSAmJiBvYmplY3RbbmFtZV0pIHsgcmV0dXJuIHRydWU7IH0KICB9Cgog
        IHJldHVybiBmYWxzZTsKfTsKCnZhciBkaWRTZXRQcm9wZXJ0eSA9IGZ1bmN0
        aW9uKHJlY29yZCwgY29udGV4dCkgewogIGlmIChjb250ZXh0LnZhbHVlICE9
        PSBjb250ZXh0Lm9sZFZhbHVlKSB7CiAgICByZWNvcmQuc2VuZCgnYmVjb21l
        RGlydHknKTsKICAgIHJlY29yZC51cGRhdGVSZWNvcmRBcnJheXNMYXRlcigp
        OwogIH0KfTsKCi8vIEltcGxlbWVudGF0aW9uIG5vdGVzOgovLwovLyBFYWNo
        IHN0YXRlIGhhcyBhIGJvb2xlYW4gdmFsdWUgZm9yIGFsbCBvZiB0aGUgZm9s
        bG93aW5nIGZsYWdzOgovLwovLyAqIGlzTG9hZGVkOiBUaGUgcmVjb3JkIGhh
        cyBhIHBvcHVsYXRlZCBgZGF0YWAgcHJvcGVydHkuIFdoZW4gYQovLyAgIHJl
        Y29yZCBpcyBsb2FkZWQgdmlhIGBzdG9yZS5maW5kYCwgYGlzTG9hZGVkYCBp
        cyBmYWxzZQovLyAgIHVudGlsIHRoZSBhZGFwdGVyIHNldHMgaXQuIFdoZW4g
        YSByZWNvcmQgaXMgY3JlYXRlZCBsb2NhbGx5LAovLyAgIGl0cyBgaXNMb2Fk
        ZWRgIHByb3BlcnR5IGlzIGFsd2F5cyB0cnVlLgovLyAqIGlzRGlydHk6IFRo
        ZSByZWNvcmQgaGFzIGxvY2FsIGNoYW5nZXMgdGhhdCBoYXZlIG5vdCB5ZXQg
        YmVlbgovLyAgIHNhdmVkIGJ5IHRoZSBhZGFwdGVyLiBUaGlzIGluY2x1ZGVz
        IHJlY29yZHMgdGhhdCBoYXZlIGJlZW4KLy8gICBjcmVhdGVkIChidXQgbm90
        IHlldCBzYXZlZCkgb3IgZGVsZXRlZC4KLy8gKiBpc1NhdmluZzogVGhlIHJl
        Y29yZCBoYXMgYmVlbiBjb21taXR0ZWQsIGJ1dAovLyAgIHRoZSBhZGFwdGVy
        IGhhcyBub3QgeWV0IGFja25vd2xlZGdlZCB0aGF0IHRoZSBjaGFuZ2VzIGhh
        dmUKLy8gICBiZWVuIHBlcnNpc3RlZCB0byB0aGUgYmFja2VuZC4KLy8gKiBp
        c0RlbGV0ZWQ6IFRoZSByZWNvcmQgd2FzIG1hcmtlZCBmb3IgZGVsZXRpb24u
        IFdoZW4gYGlzRGVsZXRlZGAKLy8gICBpcyB0cnVlIGFuZCBgaXNEaXJ0eWAg
        aXMgdHJ1ZSwgdGhlIHJlY29yZCBpcyBkZWxldGVkIGxvY2FsbHkKLy8gICBi
        dXQgdGhlIGRlbGV0aW9uIHdhcyBub3QgeWV0IHBlcnNpc3RlZC4gV2hlbiBg
        aXNTYXZpbmdgIGlzCi8vICAgdHJ1ZSwgdGhlIGNoYW5nZSBpcyBpbi1mbGln
        aHQuIFdoZW4gYm90aCBgaXNEaXJ0eWAgYW5kCi8vICAgYGlzU2F2aW5nYCBh
        cmUgZmFsc2UsIHRoZSBjaGFuZ2UgaGFzIHBlcnNpc3RlZC4KLy8gKiBpc0Vy
        cm9yOiBUaGUgYWRhcHRlciByZXBvcnRlZCB0aGF0IGl0IHdhcyB1bmFibGUg
        dG8gc2F2ZQovLyAgIGxvY2FsIGNoYW5nZXMgdG8gdGhlIGJhY2tlbmQuIFRo
        aXMgbWF5IGFsc28gcmVzdWx0IGluIHRoZQovLyAgIHJlY29yZCBoYXZpbmcg
        aXRzIGBpc1ZhbGlkYCBwcm9wZXJ0eSBiZWNvbWUgZmFsc2UgaWYgdGhlCi8v
        ICAgYWRhcHRlciByZXBvcnRlZCB0aGF0IHNlcnZlci1zaWRlIHZhbGlkYXRp
        b25zIGZhaWxlZC4KLy8gKiBpc05ldzogVGhlIHJlY29yZCB3YXMgY3JlYXRl
        ZCBvbiB0aGUgY2xpZW50IGFuZCB0aGUgYWRhcHRlcgovLyAgIGRpZCBub3Qg
        eWV0IHJlcG9ydCB0aGF0IGl0IHdhcyBzdWNjZXNzZnVsbHkgc2F2ZWQuCi8v
        ICogaXNWYWxpZDogTm8gY2xpZW50LXNpZGUgdmFsaWRhdGlvbnMgaGF2ZSBm
        YWlsZWQgYW5kIHRoZQovLyAgIGFkYXB0ZXIgZGlkIG5vdCByZXBvcnQgYW55
        IHNlcnZlci1zaWRlIHZhbGlkYXRpb24gZmFpbHVyZXMuCgovLyBUaGUgZGly
        dHkgc3RhdGUgaXMgYSBhYnN0cmFjdCBzdGF0ZSB3aG9zZSBmdW5jdGlvbmFs
        aXR5IGlzCi8vIHNoYXJlZCBiZXR3ZWVuIHRoZSBgY3JlYXRlZGAgYW5kIGB1
        cGRhdGVkYCBzdGF0ZXMuCi8vCi8vIFRoZSBkZWxldGVkIHN0YXRlIHNoYXJl
        cyB0aGUgYGlzRGlydHlgIGZsYWcgd2l0aCB0aGUKLy8gc3ViY2xhc3NlcyBv
        ZiBgRGlydHlTdGF0ZWAsIGJ1dCB3aXRoIGEgdmVyeSBkaWZmZXJlbnQKLy8g
        aW1wbGVtZW50YXRpb24uCi8vCi8vIERpcnR5IHN0YXRlcyBoYXZlIHRocmVl
        IGNoaWxkIHN0YXRlczoKLy8KLy8gYHVuY29tbWl0dGVkYDogdGhlIHN0b3Jl
        IGhhcyBub3QgeWV0IGhhbmRlZCBvZmYgdGhlIHJlY29yZAovLyAgIHRvIGJl
        IHNhdmVkLgovLyBgaW5GbGlnaHRgOiB0aGUgc3RvcmUgaGFzIGhhbmRlZCBv
        ZmYgdGhlIHJlY29yZCB0byBiZSBzYXZlZCwKLy8gICBidXQgdGhlIGFkYXB0
        ZXIgaGFzIG5vdCB5ZXQgYWNrbm93bGVkZ2VkIHN1Y2Nlc3MuCi8vIGBpbnZh
        bGlkYDogdGhlIHJlY29yZCBoYXMgaW52YWxpZCBpbmZvcm1hdGlvbiBhbmQg
        Y2Fubm90IGJlCi8vICAgc2VuZCB0byB0aGUgYWRhcHRlciB5ZXQuCnZhciBE
        aXJ0eVN0YXRlID0gewogIGluaXRpYWxTdGF0ZTogJ3VuY29tbWl0dGVkJywK
        CiAgLy8gRkxBR1MKICBpc0RpcnR5OiB0cnVlLAoKICAvLyBTVUJTVEFURVMK
        CiAgLy8gV2hlbiBhIHJlY29yZCBmaXJzdCBiZWNvbWVzIGRpcnR5LCBpdCBp
        cyBgdW5jb21taXR0ZWRgLgogIC8vIFRoaXMgbWVhbnMgdGhhdCB0aGVyZSBh
        cmUgbG9jYWwgcGVuZGluZyBjaGFuZ2VzLCBidXQgdGhleQogIC8vIGhhdmUg
        bm90IHlldCBiZWd1biB0byBiZSBzYXZlZCwgYW5kIGFyZSBub3QgaW52YWxp
        ZC4KICB1bmNvbW1pdHRlZDogewoKICAgIC8vIEVWRU5UUwogICAgZGlkU2V0
        UHJvcGVydHk6IGRpZFNldFByb3BlcnR5LAoKICAgIHB1c2hlZERhdGE6IEVt
        YmVyLkssCgogICAgYmVjb21lRGlydHk6IEVtYmVyLkssCgogICAgd2lsbENv
        bW1pdDogZnVuY3Rpb24ocmVjb3JkKSB7CiAgICAgIHJlY29yZC50cmFuc2l0
        aW9uVG8oJ2luRmxpZ2h0Jyk7CiAgICB9LAoKICAgIHJlbG9hZFJlY29yZDog
        ZnVuY3Rpb24ocmVjb3JkLCByZXNvbHZlcikgewogICAgICBnZXQocmVjb3Jk
        LCAnc3RvcmUnKS5yZWxvYWRSZWNvcmQocmVjb3JkLCByZXNvbHZlcik7CiAg
        ICB9LAoKICAgIGJlY2FtZUNsZWFuOiBmdW5jdGlvbihyZWNvcmQpIHsKICAg
        ICAgcmVjb3JkLnRyYW5zaXRpb25UbygnbG9hZGVkLnNhdmVkJyk7CiAgICB9
        LAoKICAgIGJlY2FtZUludmFsaWQ6IGZ1bmN0aW9uKHJlY29yZCkgewogICAg
        ICByZWNvcmQudHJhbnNpdGlvblRvKCdpbnZhbGlkJyk7CiAgICB9LAoKICAg
        IHJvbGxiYWNrOiBmdW5jdGlvbihyZWNvcmQpIHsKICAgICAgcmVjb3JkLnJv
        bGxiYWNrKCk7CiAgICB9CiAgfSwKCiAgLy8gT25jZSBhIHJlY29yZCBoYXMg
        YmVlbiBoYW5kZWQgb2ZmIHRvIHRoZSBhZGFwdGVyIHRvIGJlCiAgLy8gc2F2
        ZWQsIGl0IGlzIGluIHRoZSAnaW4gZmxpZ2h0JyBzdGF0ZS4gQ2hhbmdlcyB0
        byB0aGUKICAvLyByZWNvcmQgY2Fubm90IGJlIG1hZGUgZHVyaW5nIHRoaXMg
        d2luZG93LgogIGluRmxpZ2h0OiB7CiAgICAvLyBGTEFHUwogICAgaXNTYXZp
        bmc6IHRydWUsCgogICAgLy8gRVZFTlRTCiAgICBkaWRTZXRQcm9wZXJ0eTog
        ZGlkU2V0UHJvcGVydHksCiAgICBiZWNvbWVEaXJ0eTogRW1iZXIuSywKICAg
        IHB1c2hlZERhdGE6IEVtYmVyLkssCgogICAgLy8gVE9ETzogTW9yZSByb2J1
        c3Qgc2VtYW50aWNzIGFyb3VuZCBzYXZlLXdoaWxlLWluLWZsaWdodAogICAg
        d2lsbENvbW1pdDogRW1iZXIuSywKCiAgICBkaWRDb21taXQ6IGZ1bmN0aW9u
        KHJlY29yZCkgewogICAgICB2YXIgZGlydHlUeXBlID0gZ2V0KHRoaXMsICdk
        aXJ0eVR5cGUnKTsKCiAgICAgIHJlY29yZC50cmFuc2l0aW9uVG8oJ3NhdmVk
        Jyk7CiAgICAgIHJlY29yZC5zZW5kKCdpbnZva2VMaWZlY3ljbGVDYWxsYmFj
        a3MnLCBkaXJ0eVR5cGUpOwogICAgfSwKCiAgICBiZWNhbWVJbnZhbGlkOiBm
        dW5jdGlvbihyZWNvcmQsIGVycm9ycykgewogICAgICBzZXQocmVjb3JkLCAn
        ZXJyb3JzJywgZXJyb3JzKTsKCiAgICAgIHJlY29yZC50cmFuc2l0aW9uVG8o
        J2ludmFsaWQnKTsKICAgICAgcmVjb3JkLnNlbmQoJ2ludm9rZUxpZmVjeWNs
        ZUNhbGxiYWNrcycpOwogICAgfSwKCiAgICBiZWNhbWVFcnJvcjogZnVuY3Rp
        b24ocmVjb3JkKSB7CiAgICAgIHJlY29yZC50cmFuc2l0aW9uVG8oJ3VuY29t
        bWl0dGVkJyk7CiAgICAgIHJlY29yZC50cmlnZ2VyTGF0ZXIoJ2JlY2FtZUVy
        cm9yJywgcmVjb3JkKTsKICAgIH0KICB9LAoKICAvLyBBIHJlY29yZCBpcyBp
        biB0aGUgYGludmFsaWRgIHN0YXRlIHdoZW4gaXRzIGNsaWVudC1zaWRlCiAg
        Ly8gaW52YWxpZGF0aW9ucyBoYXZlIGZhaWxlZCwgb3IgaWYgdGhlIGFkYXB0
        ZXIgaGFzIGluZGljYXRlZAogIC8vIHRoZSB0aGUgcmVjb3JkIGZhaWxlZCBz
        ZXJ2ZXItc2lkZSBpbnZhbGlkYXRpb25zLgogIGludmFsaWQ6IHsKICAgIC8v
        IEZMQUdTCiAgICBpc1ZhbGlkOiBmYWxzZSwKCiAgICAvLyBFVkVOVFMKICAg
        IGRlbGV0ZVJlY29yZDogZnVuY3Rpb24ocmVjb3JkKSB7CiAgICAgIHJlY29y
        ZC50cmFuc2l0aW9uVG8oJ2RlbGV0ZWQudW5jb21taXR0ZWQnKTsKICAgICAg
        cmVjb3JkLmNsZWFyUmVsYXRpb25zaGlwcygpOwogICAgfSwKCiAgICBkaWRT
        ZXRQcm9wZXJ0eTogZnVuY3Rpb24ocmVjb3JkLCBjb250ZXh0KSB7CiAgICAg
        IHZhciBlcnJvcnMgPSBnZXQocmVjb3JkLCAnZXJyb3JzJyksCiAgICAgICAg
        ICBrZXkgPSBjb250ZXh0Lm5hbWU7CgogICAgICBzZXQoZXJyb3JzLCBrZXks
        IG51bGwpOwoKICAgICAgaWYgKCFoYXNEZWZpbmVkUHJvcGVydGllcyhlcnJv
        cnMpKSB7CiAgICAgICAgcmVjb3JkLnNlbmQoJ2JlY2FtZVZhbGlkJyk7CiAg
        ICAgIH0KCiAgICAgIGRpZFNldFByb3BlcnR5KHJlY29yZCwgY29udGV4dCk7
        CiAgICB9LAoKICAgIGJlY29tZURpcnR5OiBFbWJlci5LLAoKICAgIHJvbGxi
        YWNrOiBmdW5jdGlvbihyZWNvcmQpIHsKICAgICAgcmVjb3JkLnNlbmQoJ2Jl
        Y2FtZVZhbGlkJyk7CiAgICAgIHJlY29yZC5zZW5kKCdyb2xsYmFjaycpOwog
        ICAgfSwKCiAgICBiZWNhbWVWYWxpZDogZnVuY3Rpb24ocmVjb3JkKSB7CiAg
        ICAgIHJlY29yZC50cmFuc2l0aW9uVG8oJ3VuY29tbWl0dGVkJyk7CiAgICB9
        LAoKICAgIGludm9rZUxpZmVjeWNsZUNhbGxiYWNrczogZnVuY3Rpb24ocmVj
        b3JkKSB7CiAgICAgIHJlY29yZC50cmlnZ2VyTGF0ZXIoJ2JlY2FtZUludmFs
        aWQnLCByZWNvcmQpOwogICAgfQogIH0KfTsKCi8vIFRoZSBjcmVhdGVkIGFu
        ZCB1cGRhdGVkIHN0YXRlcyBhcmUgY3JlYXRlZCBvdXRzaWRlIHRoZSBzdGF0
        ZQovLyBjaGFydCBzbyB3ZSBjYW4gcmVvcGVuIHRoZWlyIHN1YnN0YXRlcyBh
        bmQgYWRkIG1peGlucyBhcwovLyBuZWNlc3NhcnkuCgpmdW5jdGlvbiBkZWVw
        Q2xvbmUob2JqZWN0KSB7CiAgdmFyIGNsb25lID0ge30sIHZhbHVlOwoKICBm
        b3IgKHZhciBwcm9wIGluIG9iamVjdCkgewogICAgdmFsdWUgPSBvYmplY3Rb
        cHJvcF07CiAgICBpZiAodmFsdWUgJiYgdHlwZW9mIHZhbHVlID09PSAnb2Jq
        ZWN0JykgewogICAgICBjbG9uZVtwcm9wXSA9IGRlZXBDbG9uZSh2YWx1ZSk7
        CiAgICB9IGVsc2UgewogICAgICBjbG9uZVtwcm9wXSA9IHZhbHVlOwogICAg
        fQogIH0KCiAgcmV0dXJuIGNsb25lOwp9CgpmdW5jdGlvbiBtaXhpbihvcmln
        aW5hbCwgaGFzaCkgewogIGZvciAodmFyIHByb3AgaW4gaGFzaCkgewogICAg
        b3JpZ2luYWxbcHJvcF0gPSBoYXNoW3Byb3BdOwogIH0KCiAgcmV0dXJuIG9y
        aWdpbmFsOwp9CgpmdW5jdGlvbiBkaXJ0eVN0YXRlKG9wdGlvbnMpIHsKICB2
        YXIgbmV3U3RhdGUgPSBkZWVwQ2xvbmUoRGlydHlTdGF0ZSk7CiAgcmV0dXJu
        IG1peGluKG5ld1N0YXRlLCBvcHRpb25zKTsKfQoKdmFyIGNyZWF0ZWRTdGF0
        ZSA9IGRpcnR5U3RhdGUoewogIGRpcnR5VHlwZTogJ2NyZWF0ZWQnLAoKICAv
        LyBGTEFHUwogIGlzTmV3OiB0cnVlCn0pOwoKdmFyIHVwZGF0ZWRTdGF0ZSA9
        IGRpcnR5U3RhdGUoewogIGRpcnR5VHlwZTogJ3VwZGF0ZWQnCn0pOwoKY3Jl
        YXRlZFN0YXRlLnVuY29tbWl0dGVkLmRlbGV0ZVJlY29yZCA9IGZ1bmN0aW9u
        KHJlY29yZCkgewogIHJlY29yZC5jbGVhclJlbGF0aW9uc2hpcHMoKTsKICBy
        ZWNvcmQudHJhbnNpdGlvblRvKCdkZWxldGVkLnNhdmVkJyk7Cn07CgpjcmVh
        dGVkU3RhdGUudW5jb21taXR0ZWQucm9sbGJhY2sgPSBmdW5jdGlvbihyZWNv
        cmQpIHsKICBEaXJ0eVN0YXRlLnVuY29tbWl0dGVkLnJvbGxiYWNrLmFwcGx5
        KHRoaXMsIGFyZ3VtZW50cyk7CiAgcmVjb3JkLnRyYW5zaXRpb25UbygnZGVs
        ZXRlZC5zYXZlZCcpOwp9OwoKdXBkYXRlZFN0YXRlLnVuY29tbWl0dGVkLmRl
        bGV0ZVJlY29yZCA9IGZ1bmN0aW9uKHJlY29yZCkgewogIHJlY29yZC50cmFu
        c2l0aW9uVG8oJ2RlbGV0ZWQudW5jb21taXR0ZWQnKTsKICByZWNvcmQuY2xl
        YXJSZWxhdGlvbnNoaXBzKCk7Cn07Cgp2YXIgUm9vdFN0YXRlID0gewogIC8v
        IEZMQUdTCiAgaXNFbXB0eTogZmFsc2UsCiAgaXNMb2FkaW5nOiBmYWxzZSwK
        ICBpc0xvYWRlZDogZmFsc2UsCiAgaXNEaXJ0eTogZmFsc2UsCiAgaXNTYXZp
        bmc6IGZhbHNlLAogIGlzRGVsZXRlZDogZmFsc2UsCiAgaXNOZXc6IGZhbHNl
        LAogIGlzVmFsaWQ6IHRydWUsCgogIC8vIFNVQlNUQVRFUwoKICAvLyBBIHJl
        Y29yZCBiZWdpbnMgaXRzIGxpZmVjeWNsZSBpbiB0aGUgYGVtcHR5YCBzdGF0
        ZS4KICAvLyBJZiBpdHMgZGF0YSB3aWxsIGNvbWUgZnJvbSB0aGUgYWRhcHRl
        ciwgaXQgd2lsbAogIC8vIHRyYW5zaXRpb24gaW50byB0aGUgYGxvYWRpbmdg
        IHN0YXRlLiBPdGhlcndpc2UsIGlmCiAgLy8gdGhlIHJlY29yZCBpcyBiZWlu
        ZyBjcmVhdGVkIG9uIHRoZSBjbGllbnQsIGl0IHdpbGwKICAvLyB0cmFuc2l0
        aW9uIGludG8gdGhlIGBjcmVhdGVkYCBzdGF0ZS4KICBlbXB0eTogewogICAg
        aXNFbXB0eTogdHJ1ZSwKCiAgICAvLyBFVkVOVFMKICAgIGxvYWRpbmdEYXRh
        OiBmdW5jdGlvbihyZWNvcmQpIHsKICAgICAgcmVjb3JkLnRyYW5zaXRpb25U
        bygnbG9hZGluZycpOwogICAgfSwKCiAgICBsb2FkZWREYXRhOiBmdW5jdGlv
        bihyZWNvcmQpIHsKICAgICAgcmVjb3JkLnRyYW5zaXRpb25UbygnbG9hZGVk
        LmNyZWF0ZWQudW5jb21taXR0ZWQnKTsKCiAgICAgIHJlY29yZC5zdXNwZW5k
        UmVsYXRpb25zaGlwT2JzZXJ2ZXJzKGZ1bmN0aW9uKCkgewogICAgICAgIHJl
        Y29yZC5ub3RpZnlQcm9wZXJ0eUNoYW5nZSgnZGF0YScpOwogICAgICB9KTsK
        ICAgIH0sCgogICAgcHVzaGVkRGF0YTogZnVuY3Rpb24ocmVjb3JkKSB7CiAg
        ICAgIHJlY29yZC50cmFuc2l0aW9uVG8oJ2xvYWRlZC5zYXZlZCcpOwogICAg
        fQogIH0sCgogIC8vIEEgcmVjb3JkIGVudGVycyB0aGlzIHN0YXRlIHdoZW4g
        dGhlIHN0b3JlIGFza2VzCiAgLy8gdGhlIGFkYXB0ZXIgZm9yIGl0cyBkYXRh
        LiBJdCByZW1haW5zIGluIHRoaXMgc3RhdGUKICAvLyB1bnRpbCB0aGUgYWRh
        cHRlciBwcm92aWRlcyB0aGUgcmVxdWVzdGVkIGRhdGEuCiAgLy8KICAvLyBV
        c3VhbGx5LCB0aGlzIHByb2Nlc3MgaXMgYXN5bmNocm9ub3VzLCB1c2luZyBh
        bgogIC8vIFhIUiB0byByZXRyaWV2ZSB0aGUgZGF0YS4KICBsb2FkaW5nOiB7
        CiAgICAvLyBGTEFHUwogICAgaXNMb2FkaW5nOiB0cnVlLAoKICAgIC8vIEVW
        RU5UUwogICAgcHVzaGVkRGF0YTogZnVuY3Rpb24ocmVjb3JkKSB7CiAgICAg
        IHJlY29yZC50cmFuc2l0aW9uVG8oJ2xvYWRlZC5zYXZlZCcpOwogICAgICBy
        ZWNvcmQudHJpZ2dlckxhdGVyKCdkaWRMb2FkJyk7CiAgICAgIHNldChyZWNv
        cmQsICdpc0Vycm9yJywgZmFsc2UpOwogICAgfSwKCiAgICBiZWNhbWVFcnJv
        cjogZnVuY3Rpb24ocmVjb3JkKSB7CiAgICAgIHJlY29yZC50cmlnZ2VyTGF0
        ZXIoJ2JlY2FtZUVycm9yJywgcmVjb3JkKTsKICAgIH0KICB9LAoKICAvLyBB
        IHJlY29yZCBlbnRlcnMgdGhpcyBzdGF0ZSB3aGVuIGl0cyBkYXRhIGlzIHBv
        cHVsYXRlZC4KICAvLyBNb3N0IG9mIGEgcmVjb3JkJ3MgbGlmZWN5Y2xlIGlz
        IHNwZW50IGluc2lkZSBzdWJzdGF0ZXMKICAvLyBvZiB0aGUgYGxvYWRlZGAg
        c3RhdGUuCiAgbG9hZGVkOiB7CiAgICBpbml0aWFsU3RhdGU6ICdzYXZlZCcs
        CgogICAgLy8gRkxBR1MKICAgIGlzTG9hZGVkOiB0cnVlLAoKICAgIC8vIFNV
        QlNUQVRFUwoKICAgIC8vIElmIHRoZXJlIGFyZSBubyBsb2NhbCBjaGFuZ2Vz
        IHRvIGEgcmVjb3JkLCBpdCByZW1haW5zCiAgICAvLyBpbiB0aGUgYHNhdmVk
        YCBzdGF0ZS4KICAgIHNhdmVkOiB7CiAgICAgIHNldHVwOiBmdW5jdGlvbihy
        ZWNvcmQpIHsKICAgICAgICB2YXIgYXR0cnMgPSByZWNvcmQuX2F0dHJpYnV0
        ZXMsCiAgICAgICAgICAgIGlzRGlydHkgPSBmYWxzZTsKCiAgICAgICAgZm9y
        ICh2YXIgcHJvcCBpbiBhdHRycykgewogICAgICAgICAgaWYgKGF0dHJzLmhh
        c093blByb3BlcnR5KHByb3ApKSB7CiAgICAgICAgICAgIGlzRGlydHkgPSB0
        cnVlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9
        CgogICAgICAgIGlmIChpc0RpcnR5KSB7CiAgICAgICAgICByZWNvcmQuYWRh
        cHRlckRpZERpcnR5KCk7CiAgICAgICAgfQogICAgICB9LAoKICAgICAgLy8g
        RVZFTlRTCiAgICAgIGRpZFNldFByb3BlcnR5OiBkaWRTZXRQcm9wZXJ0eSwK
        CiAgICAgIHB1c2hlZERhdGE6IEVtYmVyLkssCgogICAgICBiZWNvbWVEaXJ0
        eTogZnVuY3Rpb24ocmVjb3JkKSB7CiAgICAgICAgcmVjb3JkLnRyYW5zaXRp
        b25UbygndXBkYXRlZC51bmNvbW1pdHRlZCcpOwogICAgICB9LAoKICAgICAg
        d2lsbENvbW1pdDogZnVuY3Rpb24ocmVjb3JkKSB7CiAgICAgICAgcmVjb3Jk
        LnRyYW5zaXRpb25UbygndXBkYXRlZC5pbkZsaWdodCcpOwogICAgICB9LAoK
        ICAgICAgcmVsb2FkUmVjb3JkOiBmdW5jdGlvbihyZWNvcmQsIHJlc29sdmVy
        KSB7CiAgICAgICAgZ2V0KHJlY29yZCwgJ3N0b3JlJykucmVsb2FkUmVjb3Jk
        KHJlY29yZCwgcmVzb2x2ZXIpOwogICAgICB9LAoKICAgICAgZGVsZXRlUmVj
        b3JkOiBmdW5jdGlvbihyZWNvcmQpIHsKICAgICAgICByZWNvcmQudHJhbnNp
        dGlvblRvKCdkZWxldGVkLnVuY29tbWl0dGVkJyk7CiAgICAgICAgcmVjb3Jk
        LmNsZWFyUmVsYXRpb25zaGlwcygpOwogICAgICB9LAoKICAgICAgdW5sb2Fk
        UmVjb3JkOiBmdW5jdGlvbihyZWNvcmQpIHsKICAgICAgICAvLyBjbGVhciBy
        ZWxhdGlvbnNoaXBzIGJlZm9yZSBtb3ZpbmcgdG8gZGVsZXRlZCBzdGF0ZQog
        ICAgICAgIC8vIG90aGVyd2lzZSBpdCBmYWlscwogICAgICAgIHJlY29yZC5j
        bGVhclJlbGF0aW9uc2hpcHMoKTsKICAgICAgICByZWNvcmQudHJhbnNpdGlv
        blRvKCdkZWxldGVkLnNhdmVkJyk7CiAgICAgIH0sCgogICAgICBkaWRDb21t
        aXQ6IGZ1bmN0aW9uKHJlY29yZCkgewogICAgICAgIHJlY29yZC5zZW5kKCdp
        bnZva2VMaWZlY3ljbGVDYWxsYmFja3MnLCBnZXQocmVjb3JkLCAnbGFzdERp
        cnR5VHlwZScpKTsKICAgICAgfSwKCiAgICB9LAoKICAgIC8vIEEgcmVjb3Jk
        IGlzIGluIHRoaXMgc3RhdGUgYWZ0ZXIgaXQgaGFzIGJlZW4gbG9jYWxseQog
        ICAgLy8gY3JlYXRlZCBidXQgYmVmb3JlIHRoZSBhZGFwdGVyIGhhcyBpbmRp
        Y2F0ZWQgdGhhdAogICAgLy8gaXQgaGFzIGJlZW4gc2F2ZWQuCiAgICBjcmVh
        dGVkOiBjcmVhdGVkU3RhdGUsCgogICAgLy8gQSByZWNvcmQgaXMgaW4gdGhp
        cyBzdGF0ZSBpZiBpdCBoYXMgYWxyZWFkeSBiZWVuCiAgICAvLyBzYXZlZCB0
        byB0aGUgc2VydmVyLCBidXQgdGhlcmUgYXJlIG5ldyBsb2NhbCBjaGFuZ2Vz
        CiAgICAvLyB0aGF0IGhhdmUgbm90IHlldCBiZWVuIHNhdmVkLgogICAgdXBk
        YXRlZDogdXBkYXRlZFN0YXRlCiAgfSwKCiAgLy8gQSByZWNvcmQgaXMgaW4g
        dGhpcyBzdGF0ZSBpZiBpdCB3YXMgZGVsZXRlZCBmcm9tIHRoZSBzdG9yZS4K
        ICBkZWxldGVkOiB7CiAgICBpbml0aWFsU3RhdGU6ICd1bmNvbW1pdHRlZCcs
        CiAgICBkaXJ0eVR5cGU6ICdkZWxldGVkJywKCiAgICAvLyBGTEFHUwogICAg
        aXNEZWxldGVkOiB0cnVlLAogICAgaXNMb2FkZWQ6IHRydWUsCiAgICBpc0Rp
        cnR5OiB0cnVlLAoKICAgIC8vIFRSQU5TSVRJT05TCiAgICBzZXR1cDogZnVu
        Y3Rpb24ocmVjb3JkKSB7CiAgICAgIHZhciBzdG9yZSA9IGdldChyZWNvcmQs
        ICdzdG9yZScpOwoKICAgICAgc3RvcmUucmVjb3JkQXJyYXlNYW5hZ2VyLnJl
        bW92ZShyZWNvcmQpOwogICAgfSwKCiAgICAvLyBTVUJTVEFURVMKCiAgICAv
        LyBXaGVuIGEgcmVjb3JkIGlzIGRlbGV0ZWQsIGl0IGVudGVycyB0aGUgYHN0
        YXJ0YAogICAgLy8gc3RhdGUuIEl0IHdpbGwgZXhpdCB0aGlzIHN0YXRlIHdo
        ZW4gdGhlIHJlY29yZAogICAgLy8gc3RhcnRzIHRvIGNvbW1pdC4KICAgIHVu
        Y29tbWl0dGVkOiB7CgogICAgICAvLyBFVkVOVFMKCiAgICAgIHdpbGxDb21t
        aXQ6IGZ1bmN0aW9uKHJlY29yZCkgewogICAgICAgIHJlY29yZC50cmFuc2l0
        aW9uVG8oJ2luRmxpZ2h0Jyk7CiAgICAgIH0sCgogICAgICByb2xsYmFjazog
        ZnVuY3Rpb24ocmVjb3JkKSB7CiAgICAgICAgcmVjb3JkLnJvbGxiYWNrKCk7
        CiAgICAgIH0sCgogICAgICBiZWNvbWVEaXJ0eTogRW1iZXIuSywKICAgICAg
        ZGVsZXRlUmVjb3JkOiBFbWJlci5LLAoKICAgICAgYmVjYW1lQ2xlYW46IGZ1
        bmN0aW9uKHJlY29yZCkgewogICAgICAgIHJlY29yZC50cmFuc2l0aW9uVG8o
        J2xvYWRlZC5zYXZlZCcpOwogICAgICB9CiAgICB9LAoKICAgIC8vIEFmdGVy
        IGEgcmVjb3JkIHN0YXJ0cyBjb21taXR0aW5nLCBidXQKICAgIC8vIGJlZm9y
        ZSB0aGUgYWRhcHRlciBpbmRpY2F0ZXMgdGhhdCB0aGUgZGVsZXRpb24KICAg
        IC8vIGhhcyBzYXZlZCB0byB0aGUgc2VydmVyLCBhIHJlY29yZCBpcyBpbiB0
        aGUKICAgIC8vIGBpbkZsaWdodGAgc3Vic3RhdGUgb2YgYGRlbGV0ZWRgLgog
        ICAgaW5GbGlnaHQ6IHsKICAgICAgLy8gRkxBR1MKICAgICAgaXNTYXZpbmc6
        IHRydWUsCgogICAgICAvLyBFVkVOVFMKCiAgICAgIC8vIFRPRE86IE1vcmUg
        cm9idXN0IHNlbWFudGljcyBhcm91bmQgc2F2ZS13aGlsZS1pbi1mbGlnaHQK
        ICAgICAgd2lsbENvbW1pdDogRW1iZXIuSywKICAgICAgZGlkQ29tbWl0OiBm
        dW5jdGlvbihyZWNvcmQpIHsKICAgICAgICByZWNvcmQudHJhbnNpdGlvblRv
        KCdzYXZlZCcpOwoKICAgICAgICByZWNvcmQuc2VuZCgnaW52b2tlTGlmZWN5
        Y2xlQ2FsbGJhY2tzJyk7CiAgICAgIH0KICAgIH0sCgogICAgLy8gT25jZSB0
        aGUgYWRhcHRlciBpbmRpY2F0ZXMgdGhhdCB0aGUgZGVsZXRpb24gaGFzCiAg
        ICAvLyBiZWVuIHNhdmVkLCB0aGUgcmVjb3JkIGVudGVycyB0aGUgYHNhdmVk
        YCBzdWJzdGF0ZQogICAgLy8gb2YgYGRlbGV0ZWRgLgogICAgc2F2ZWQ6IHsK
        ICAgICAgLy8gRkxBR1MKICAgICAgaXNEaXJ0eTogZmFsc2UsCgogICAgICBz
        ZXR1cDogZnVuY3Rpb24ocmVjb3JkKSB7CiAgICAgICAgdmFyIHN0b3JlID0g
        Z2V0KHJlY29yZCwgJ3N0b3JlJyk7CiAgICAgICAgc3RvcmUuZGVtYXRlcmlh
        bGl6ZVJlY29yZChyZWNvcmQpOwogICAgICB9LAoKICAgICAgaW52b2tlTGlm
        ZWN5Y2xlQ2FsbGJhY2tzOiBmdW5jdGlvbihyZWNvcmQpIHsKICAgICAgICBy
        ZWNvcmQudHJpZ2dlckxhdGVyKCdkaWREZWxldGUnLCByZWNvcmQpOwogICAg
        ICAgIHJlY29yZC50cmlnZ2VyTGF0ZXIoJ2RpZENvbW1pdCcsIHJlY29yZCk7
        CiAgICAgIH0KICAgIH0KICB9LAoKICBpbnZva2VMaWZlY3ljbGVDYWxsYmFj
        a3M6IGZ1bmN0aW9uKHJlY29yZCwgZGlydHlUeXBlKSB7CiAgICBpZiAoZGly
        dHlUeXBlID09PSAnY3JlYXRlZCcpIHsKICAgICAgcmVjb3JkLnRyaWdnZXJM
        YXRlcignZGlkQ3JlYXRlJywgcmVjb3JkKTsKICAgIH0gZWxzZSB7CiAgICAg
        IHJlY29yZC50cmlnZ2VyTGF0ZXIoJ2RpZFVwZGF0ZScsIHJlY29yZCk7CiAg
        ICB9CgogICAgcmVjb3JkLnRyaWdnZXJMYXRlcignZGlkQ29tbWl0JywgcmVj
        b3JkKTsKICB9Cn07Cgp2YXIgaGFzT3duUHJvcCA9IHt9Lmhhc093blByb3Bl
        cnR5OwoKZnVuY3Rpb24gd2lyZVN0YXRlKG9iamVjdCwgcGFyZW50LCBuYW1l
        KSB7CiAgLypqc2hpbnQgcHJvdG86dHJ1ZSovCiAgLy8gVE9ETzogVXNlIE9i
        amVjdC5jcmVhdGUgYW5kIGNvcHkgaW5zdGVhZAogIG9iamVjdCA9IG1peGlu
        KHBhcmVudCA/IEVtYmVyLmNyZWF0ZShwYXJlbnQpIDoge30sIG9iamVjdCk7
        CiAgb2JqZWN0LnBhcmVudFN0YXRlID0gcGFyZW50OwogIG9iamVjdC5zdGF0
        ZU5hbWUgPSBuYW1lOwoKICBmb3IgKHZhciBwcm9wIGluIG9iamVjdCkgewog
        ICAgaWYgKCFvYmplY3QuaGFzT3duUHJvcGVydHkocHJvcCkgfHwgcHJvcCA9
        PT0gJ3BhcmVudFN0YXRlJyB8fCBwcm9wID09PSAnc3RhdGVOYW1lJykgeyBj
        b250aW51ZTsgfQogICAgaWYgKHR5cGVvZiBvYmplY3RbcHJvcF0gPT09ICdv
        YmplY3QnKSB7CiAgICAgIG9iamVjdFtwcm9wXSA9IHdpcmVTdGF0ZShvYmpl
        Y3RbcHJvcF0sIG9iamVjdCwgbmFtZSArICIuIiArIHByb3ApOwogICAgfQog
        IH0KCiAgcmV0dXJuIG9iamVjdDsKfQoKUm9vdFN0YXRlID0gd2lyZVN0YXRl
        KFJvb3RTdGF0ZSwgbnVsbCwgInJvb3QiKTsKCkRTLlJvb3RTdGF0ZSA9IFJv
        b3RTdGF0ZTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCiAgQG1vZHVs
        ZSBlbWJlci1kYXRhCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBF
        bWJlci5zZXQsIG1hcCA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5tYXAsCiAg
        ICBtZXJnZSA9IEVtYmVyLm1lcmdlLCBvbmNlID0gRW1iZXIucnVuLm9uY2U7
        Cgp2YXIgYXJyYXlNYXAgPSBFbWJlci5BcnJheVBvbHlmaWxscy5tYXA7Cgp2
        YXIgcmV0cmlldmVGcm9tQ3VycmVudFN0YXRlID0gRW1iZXIuY29tcHV0ZWQo
        ZnVuY3Rpb24oa2V5LCB2YWx1ZSkgewogIHJldHVybiBnZXQoZ2V0KHRoaXMs
        ICdjdXJyZW50U3RhdGUnKSwga2V5KTsKfSkucHJvcGVydHkoJ2N1cnJlbnRT
        dGF0ZScpLnJlYWRPbmx5KCk7CgovKioKCiAgVGhlIG1vZGVsIGNsYXNzIHRo
        YXQgYWxsIEVtYmVyIERhdGEgcmVjb3JkcyBkZXNjZW5kIGZyb20uCgogIEBj
        bGFzcyBNb2RlbAogIEBuYW1lc3BhY2UgRFMKICBAZXh0ZW5kcyBFbWJlci5P
        YmplY3QKICBAdXNlcyBFbWJlci5FdmVudGVkCiovCkRTLk1vZGVsID0gRW1i
        ZXIuT2JqZWN0LmV4dGVuZChFbWJlci5FdmVudGVkLCB7CiAgaXNFbXB0eTog
        cmV0cmlldmVGcm9tQ3VycmVudFN0YXRlLAogIGlzTG9hZGluZzogcmV0cmll
        dmVGcm9tQ3VycmVudFN0YXRlLAogIGlzTG9hZGVkOiByZXRyaWV2ZUZyb21D
        dXJyZW50U3RhdGUsCiAgaXNEaXJ0eTogcmV0cmlldmVGcm9tQ3VycmVudFN0
        YXRlLAogIGlzU2F2aW5nOiByZXRyaWV2ZUZyb21DdXJyZW50U3RhdGUsCiAg
        aXNEZWxldGVkOiByZXRyaWV2ZUZyb21DdXJyZW50U3RhdGUsCiAgaXNOZXc6
        IHJldHJpZXZlRnJvbUN1cnJlbnRTdGF0ZSwKICBpc1ZhbGlkOiByZXRyaWV2
        ZUZyb21DdXJyZW50U3RhdGUsCiAgZGlydHlUeXBlOiByZXRyaWV2ZUZyb21D
        dXJyZW50U3RhdGUsCgogIGlzRXJyb3I6IGZhbHNlLAogIGlzUmVsb2FkaW5n
        OiBmYWxzZSwKCiAgY2xpZW50SWQ6IG51bGwsCiAgaWQ6IG51bGwsCiAgdHJh
        bnNhY3Rpb246IG51bGwsCiAgY3VycmVudFN0YXRlOiBudWxsLAogIGVycm9y
        czogbnVsbCwKCiAgLyoqCiAgICBDcmVhdGUgYSBKU09OIHJlcHJlc2VudGF0
        aW9uIG9mIHRoZSByZWNvcmQsIHVzaW5nIHRoZSBzZXJpYWxpemF0aW9uCiAg
        ICBzdHJhdGVneSBvZiB0aGUgc3RvcmUncyBhZGFwdGVyLgoKICAgIEBtZXRo
        b2Qgc2VyaWFsaXplCiAgICBAcGFyYW0ge09iamVjdH0gb3B0aW9ucyBBdmFp
        bGFibGUgb3B0aW9uczoKCiAgICAqIGBpbmNsdWRlSWRgOiBgdHJ1ZWAgaWYg
        dGhlIHJlY29yZCdzIElEIHNob3VsZCBiZSBpbmNsdWRlZCBpbiB0aGUKICAg
        ICAgSlNPTiByZXByZXNlbnRhdGlvbi4KCiAgICBAcmV0dXJucyB7T2JqZWN0
        fSBhbiBvYmplY3Qgd2hvc2UgdmFsdWVzIGFyZSBwcmltaXRpdmUgSlNPTiB2
        YWx1ZXMgb25seQogICovCiAgc2VyaWFsaXplOiBmdW5jdGlvbihvcHRpb25z
        KSB7CiAgICB2YXIgc3RvcmUgPSBnZXQodGhpcywgJ3N0b3JlJyk7CiAgICBy
        ZXR1cm4gc3RvcmUuc2VyaWFsaXplKHRoaXMsIG9wdGlvbnMpOwogIH0sCgog
        IC8qKgogICAgVXNlIHt7I2Nyb3NzTGluayAiRFMuSlNPTlNlcmlhbGl6ZXIi
        fX1EUy5KU09OU2VyaWFsaXplcnt7L2Nyb3NzTGlua319IHRvCiAgICBnZXQg
        dGhlIEpTT04gcmVwcmVzZW50YXRpb24gb2YgYSByZWNvcmQuCgogICAgQG1l
        dGhvZCB0b0pTT04KICAgIEBwYXJhbSB7T2JqZWN0fSBvcHRpb25zIEF2YWls
        YWJsZSBvcHRpb25zOgoKICAgICogYGluY2x1ZGVJZGA6IGB0cnVlYCBpZiB0
        aGUgcmVjb3JkJ3MgSUQgc2hvdWxkIGJlIGluY2x1ZGVkIGluIHRoZQogICAg
        ICBKU09OIHJlcHJlc2VudGF0aW9uLgoKICAgIEByZXR1cm5zIHtPYmplY3R9
        IEEgSlNPTiByZXByZXNlbnRhdGlvbiBvZiB0aGUgb2JqZWN0LgogICovCiAg
        dG9KU09OOiBmdW5jdGlvbihvcHRpb25zKSB7CiAgICB2YXIgc2VyaWFsaXpl
        ciA9IERTLkpTT05TZXJpYWxpemVyLmNyZWF0ZSgpOwogICAgcmV0dXJuIHNl
        cmlhbGl6ZXIuc2VyaWFsaXplKHRoaXMsIG9wdGlvbnMpOwogIH0sCgogIC8q
        KgogICAgRmlyZWQgd2hlbiB0aGUgcmVjb3JkIGlzIGxvYWRlZCBmcm9tIHRo
        ZSBzZXJ2ZXIuCgogICAgQGV2ZW50IGRpZExvYWQKICAqLwogIGRpZExvYWQ6
        IEVtYmVyLkssCgogIC8qKgogICAgRmlyZWQgd2hlbiB0aGUgcmVjb3JkIGlz
        IHJlbG9hZGVkIGZyb20gdGhlIHNlcnZlci4KCiAgICBAZXZlbnQgZGlkUmVs
        b2FkCiAgKi8KICBkaWRSZWxvYWQ6IEVtYmVyLkssCgogIC8qKgogICAgRmly
        ZWQgd2hlbiB0aGUgcmVjb3JkIGlzIHVwZGF0ZWQuCgogICAgQGV2ZW50IGRp
        ZFVwZGF0ZQogICovCiAgZGlkVXBkYXRlOiBFbWJlci5LLAoKICAvKioKICAg
        IEZpcmVkIHdoZW4gdGhlIHJlY29yZCBpcyBjcmVhdGVkLgoKICAgIEBldmVu
        dCBkaWRDcmVhdGUKICAqLwogIGRpZENyZWF0ZTogRW1iZXIuSywKCiAgLyoq
        CiAgICBGaXJlZCB3aGVuIHRoZSByZWNvcmQgaXMgZGVsZXRlZC4KCiAgICBA
        ZXZlbnQgZGlkRGVsZXRlCiAgKi8KICBkaWREZWxldGU6IEVtYmVyLkssCgog
        IC8qKgogICAgRmlyZWQgd2hlbiB0aGUgcmVjb3JkIGJlY29tZXMgaW52YWxp
        ZC4KCiAgICBAZXZlbnQgYmVjYW1lSW52YWxpZAogICovCiAgYmVjYW1lSW52
        YWxpZDogRW1iZXIuSywKCiAgLyoqCiAgICBGaXJlZCB3aGVuIHRoZSByZWNv
        cmQgZW50ZXJzIHRoZSBlcnJvciBzdGF0ZS4KCiAgICBAZXZlbnQgYmVjYW1l
        RXJyb3IKICAqLwogIGJlY2FtZUVycm9yOiBFbWJlci5LLAoKICBkYXRhOiBF
        bWJlci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHRoaXMuX2RhdGEgPSB0
        aGlzLl9kYXRhIHx8IHt9OwogICAgcmV0dXJuIHRoaXMuX2RhdGE7CiAgfSku
        cHJvcGVydHkoKSwKCiAgX2RhdGE6IG51bGwsCgogIGluaXQ6IGZ1bmN0aW9u
        KCkgewogICAgc2V0KHRoaXMsICdjdXJyZW50U3RhdGUnLCBEUy5Sb290U3Rh
        dGUuZW1wdHkpOwogICAgdGhpcy5fc3VwZXIoKTsKICAgIHRoaXMuX3NldHVw
        KCk7CiAgfSwKCiAgX3NldHVwOiBmdW5jdGlvbigpIHsKICAgIHRoaXMuX2No
        YW5nZXNUb1N5bmMgPSB7fTsKICAgIHRoaXMuX2RlZmVycmVkVHJpZ2dlcnMg
        PSBbXTsKICAgIHRoaXMuX2RhdGEgPSB7fTsKICAgIHRoaXMuX2F0dHJpYnV0
        ZXMgPSB7fTsKICAgIHRoaXMuX2luRmxpZ2h0QXR0cmlidXRlcyA9IHt9Owog
        ICAgdGhpcy5fcmVsYXRpb25zaGlwcyA9IHt9OwogIH0sCgogIHNlbmQ6IGZ1
        bmN0aW9uKG5hbWUsIGNvbnRleHQpIHsKICAgIHZhciBjdXJyZW50U3RhdGUg
        PSBnZXQodGhpcywgJ2N1cnJlbnRTdGF0ZScpOwoKICAgIGlmICghY3VycmVu
        dFN0YXRlW25hbWVdKSB7CiAgICAgIHRoaXMuX3VuaGFuZGxlZEV2ZW50KGN1
        cnJlbnRTdGF0ZSwgbmFtZSwgY29udGV4dCk7CiAgICB9CgogICAgcmV0dXJu
        IGN1cnJlbnRTdGF0ZVtuYW1lXSh0aGlzLCBjb250ZXh0KTsKICB9LAoKICB0
        cmFuc2l0aW9uVG86IGZ1bmN0aW9uKG5hbWUpIHsKICAgIC8vIFBPU1NJQkxF
        IFRPRE86IFJlbW92ZSB0aGlzIGNvZGUgYW5kIHJlcGxhY2Ugd2l0aAogICAg
        Ly8gYWx3YXlzIGhhdmluZyBkaXJlY3QgcmVmZXJlbmNlcyB0byBzdGF0ZSBv
        YmplY3RzCgogICAgdmFyIHBpdm90TmFtZSA9IG5hbWUuc3BsaXQoIi4iLCAx
        KSwKICAgICAgICBjdXJyZW50U3RhdGUgPSBnZXQodGhpcywgJ2N1cnJlbnRT
        dGF0ZScpLAogICAgICAgIHN0YXRlID0gY3VycmVudFN0YXRlOwoKICAgIGRv
        IHsKICAgICAgaWYgKHN0YXRlLmV4aXQpIHsgc3RhdGUuZXhpdCh0aGlzKTsg
        fQogICAgICBzdGF0ZSA9IHN0YXRlLnBhcmVudFN0YXRlOwogICAgfSB3aGls
        ZSAoIXN0YXRlLmhhc093blByb3BlcnR5KHBpdm90TmFtZSkpOwoKICAgIHZh
        ciBwYXRoID0gbmFtZS5zcGxpdCgiLiIpOwoKICAgIHZhciBzZXR1cHMgPSBb
        XSwgZW50ZXJzID0gW10sIGksIGw7CgogICAgZm9yIChpPTAsIGw9cGF0aC5s
        ZW5ndGg7IGk8bDsgaSsrKSB7CiAgICAgIHN0YXRlID0gc3RhdGVbcGF0aFtp
        XV07CgogICAgICBpZiAoc3RhdGUuZW50ZXIpIHsgZW50ZXJzLnB1c2goc3Rh
        dGUpOyB9CiAgICAgIGlmIChzdGF0ZS5zZXR1cCkgeyBzZXR1cHMucHVzaChz
        dGF0ZSk7IH0KICAgIH0KCiAgICBmb3IgKGk9MCwgbD1lbnRlcnMubGVuZ3Ro
        OyBpPGw7IGkrKykgewogICAgICBlbnRlcnNbaV0uZW50ZXIodGhpcyk7CiAg
        ICB9CgogICAgc2V0KHRoaXMsICdjdXJyZW50U3RhdGUnLCBzdGF0ZSk7Cgog
        ICAgZm9yIChpPTAsIGw9c2V0dXBzLmxlbmd0aDsgaTxsOyBpKyspIHsKICAg
        ICAgc2V0dXBzW2ldLnNldHVwKHRoaXMpOwogICAgfQogIH0sCgogIF91bmhh
        bmRsZWRFdmVudDogZnVuY3Rpb24oc3RhdGUsIG5hbWUsIGNvbnRleHQpIHsK
        ICAgIHZhciBlcnJvck1lc3NhZ2UgPSAiQXR0ZW1wdGVkIHRvIGhhbmRsZSBl
        dmVudCBgIiArIG5hbWUgKyAiYCAiOwogICAgZXJyb3JNZXNzYWdlICAgICs9
        ICJvbiAiICsgU3RyaW5nKHRoaXMpICsgIiB3aGlsZSBpbiBzdGF0ZSAiOwog
        ICAgZXJyb3JNZXNzYWdlICAgICs9IHN0YXRlLnN0YXRlTmFtZSArICIuICI7
        CgogICAgaWYgKGNvbnRleHQgIT09IHVuZGVmaW5lZCkgewogICAgICBlcnJv
        ck1lc3NhZ2UgICs9ICJDYWxsZWQgd2l0aCAiICsgRW1iZXIuaW5zcGVjdChj
        b250ZXh0KSArICIuIjsKICAgIH0KCiAgICB0aHJvdyBuZXcgRW1iZXIuRXJy
        b3IoZXJyb3JNZXNzYWdlKTsKICB9LAoKICB3aXRoVHJhbnNhY3Rpb246IGZ1
        bmN0aW9uKGZuKSB7CiAgICB2YXIgdHJhbnNhY3Rpb24gPSBnZXQodGhpcywg
        J3RyYW5zYWN0aW9uJyk7CiAgICBpZiAodHJhbnNhY3Rpb24pIHsgZm4odHJh
        bnNhY3Rpb24pOyB9CiAgfSwKCiAgbG9hZGluZ0RhdGE6IGZ1bmN0aW9uKCkg
        ewogICAgdGhpcy5zZW5kKCdsb2FkaW5nRGF0YScpOwogIH0sCgogIGxvYWRl
        ZERhdGE6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5zZW5kKCdsb2FkZWREYXRh
        Jyk7CiAgfSwKCiAgcHVzaGVkRGF0YTogZnVuY3Rpb24oKSB7CiAgICB0aGlz
        LnNlbmQoJ3B1c2hlZERhdGEnKTsKICB9LAoKICBkZWxldGVSZWNvcmQ6IGZ1
        bmN0aW9uKCkgewogICAgdGhpcy5zZW5kKCdkZWxldGVSZWNvcmQnKTsKICB9
        LAoKICB1bmxvYWRSZWNvcmQ6IGZ1bmN0aW9uKCkgewogICAgRW1iZXIuYXNz
        ZXJ0KCJZb3UgY2FuIG9ubHkgdW5sb2FkIGEgbG9hZGVkLCBub24tZGlydHkg
        cmVjb3JkLiIsICFnZXQodGhpcywgJ2lzRGlydHknKSk7CgogICAgdGhpcy5z
        ZW5kKCd1bmxvYWRSZWNvcmQnKTsKICB9LAoKICBjbGVhclJlbGF0aW9uc2hp
        cHM6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5lYWNoUmVsYXRpb25zaGlwKGZ1
        bmN0aW9uKG5hbWUsIHJlbGF0aW9uc2hpcCkgewogICAgICBpZiAocmVsYXRp
        b25zaGlwLmtpbmQgPT09ICdiZWxvbmdzVG8nKSB7CiAgICAgICAgc2V0KHRo
        aXMsIG5hbWUsIG51bGwpOwogICAgICB9IGVsc2UgaWYgKHJlbGF0aW9uc2hp
        cC5raW5kID09PSAnaGFzTWFueScpIHsKICAgICAgICB2YXIgaGFzTWFueSA9
        IHRoaXMuX3JlbGF0aW9uc2hpcHNbcmVsYXRpb25zaGlwLm5hbWVdOwogICAg
        ICAgIGlmIChoYXNNYW55KSB7IGhhc01hbnkuY2xlYXIoKTsgfQogICAgICB9
        CiAgICB9LCB0aGlzKTsKICB9LAoKICB1cGRhdGVSZWNvcmRBcnJheXM6IGZ1
        bmN0aW9uKCkgewogICAgdmFyIHN0b3JlID0gZ2V0KHRoaXMsICdzdG9yZScp
        OwogICAgaWYgKHN0b3JlKSB7CiAgICAgIHN0b3JlLmRhdGFXYXNVcGRhdGVk
        KHRoaXMuY29uc3RydWN0b3IsIHRoaXMpOwogICAgfQogIH0sCgogIGFkYXB0
        ZXJXaWxsQ29tbWl0OiBmdW5jdGlvbigpIHsKICAgIHRoaXMuc2VuZCgnd2ls
        bENvbW1pdCcpOwogIH0sCgogIC8qKgogICAgSWYgdGhlIGFkYXB0ZXIgZGlk
        IG5vdCByZXR1cm4gYSBoYXNoIGluIHJlc3BvbnNlIHRvIGEgY29tbWl0LAog
        ICAgbWVyZ2UgdGhlIGNoYW5nZWQgYXR0cmlidXRlcyBhbmQgcmVsYXRpb25z
        aGlwcyBpbnRvIHRoZSBleGlzdGluZwogICAgc2F2ZWQgZGF0YS4KCiAgICBA
        bWV0aG9kIGFkYXB0ZXJEaWRDb21taXQKICAqLwogIGFkYXB0ZXJEaWRDb21t
        aXQ6IGZ1bmN0aW9uKGRhdGEpIHsKICAgIHNldCh0aGlzLCAnaXNFcnJvcics
        IGZhbHNlKTsKCiAgICBpZiAoZGF0YSkgewogICAgICB0aGlzLl9kYXRhID0g
        ZGF0YTsKICAgIH0gZWxzZSB7CiAgICAgIEVtYmVyLm1peGluKHRoaXMuX2Rh
        dGEsIHRoaXMuX2luRmxpZ2h0QXR0cmlidXRlcyk7CiAgICB9CgogICAgdGhp
        cy5faW5GbGlnaHRBdHRyaWJ1dGVzID0ge307CgogICAgdGhpcy5zZW5kKCdk
        aWRDb21taXQnKTsKICAgIHRoaXMudXBkYXRlUmVjb3JkQXJyYXlzTGF0ZXIo
        KTsKCiAgICBpZiAoIWRhdGEpIHsgcmV0dXJuOyB9CgogICAgdGhpcy5zdXNw
        ZW5kUmVsYXRpb25zaGlwT2JzZXJ2ZXJzKGZ1bmN0aW9uKCkgewogICAgICB0
        aGlzLm5vdGlmeVByb3BlcnR5Q2hhbmdlKCdkYXRhJyk7CiAgICB9KTsKICB9
        LAoKICBhZGFwdGVyRGlkRGlydHk6IGZ1bmN0aW9uKCkgewogICAgdGhpcy5z
        ZW5kKCdiZWNvbWVEaXJ0eScpOwogICAgdGhpcy51cGRhdGVSZWNvcmRBcnJh
        eXNMYXRlcigpOwogIH0sCgogIGRhdGFEaWRDaGFuZ2U6IEVtYmVyLm9ic2Vy
        dmVyKGZ1bmN0aW9uKCkgewogICAgdGhpcy5yZWxvYWRIYXNNYW55cygpOwog
        IH0sICdkYXRhJyksCgogIHJlbG9hZEhhc01hbnlzOiBmdW5jdGlvbigpIHsK
        ICAgIHZhciByZWxhdGlvbnNoaXBzID0gZ2V0KHRoaXMuY29uc3RydWN0b3Is
        ICdyZWxhdGlvbnNoaXBzQnlOYW1lJyk7CiAgICB0aGlzLnVwZGF0ZVJlY29y
        ZEFycmF5c0xhdGVyKCk7CiAgICByZWxhdGlvbnNoaXBzLmZvckVhY2goZnVu
        Y3Rpb24obmFtZSwgcmVsYXRpb25zaGlwKSB7CiAgICAgIGlmIChyZWxhdGlv
        bnNoaXAua2luZCA9PT0gJ2hhc01hbnknKSB7CiAgICAgICAgdGhpcy5oYXNN
        YW55RGlkQ2hhbmdlKHJlbGF0aW9uc2hpcC5rZXkpOwogICAgICB9CiAgICB9
        LCB0aGlzKTsKICB9LAoKICBoYXNNYW55RGlkQ2hhbmdlOiBmdW5jdGlvbihr
        ZXkpIHsKICAgIHZhciBoYXNNYW55ID0gdGhpcy5fcmVsYXRpb25zaGlwc1tr
        ZXldOwoKICAgIGlmIChoYXNNYW55KSB7CiAgICAgIHZhciB0eXBlID0gZ2V0
        KHRoaXMuY29uc3RydWN0b3IsICdyZWxhdGlvbnNoaXBzQnlOYW1lJykuZ2V0
        KGtleSkudHlwZTsKICAgICAgdmFyIHN0b3JlID0gZ2V0KHRoaXMsICdzdG9y
        ZScpOwogICAgICB2YXIgcmVjb3JkcyA9IHRoaXMuX2RhdGFba2V5XSB8fCBb
        XTsKCiAgICAgIHNldChoYXNNYW55LCAnY29udGVudCcsIEVtYmVyLkEocmVj
        b3JkcykpOwogICAgICBzZXQoaGFzTWFueSwgJ2lzTG9hZGVkJywgdHJ1ZSk7
        CiAgICAgIGhhc01hbnkudHJpZ2dlcignZGlkTG9hZCcpOwogICAgfQogIH0s
        CgogIHVwZGF0ZVJlY29yZEFycmF5c0xhdGVyOiBmdW5jdGlvbigpIHsKICAg
        IEVtYmVyLnJ1bi5vbmNlKHRoaXMsIHRoaXMudXBkYXRlUmVjb3JkQXJyYXlz
        KTsKICB9LAoKICBzZXR1cERhdGE6IGZ1bmN0aW9uKGRhdGEpIHsKICAgIHRo
        aXMuX2RhdGEgPSBkYXRhOwoKICAgIGlmIChkYXRhKSB7IHRoaXMucHVzaGVk
        RGF0YSgpOyB9CgogICAgdGhpcy5zdXNwZW5kUmVsYXRpb25zaGlwT2JzZXJ2
        ZXJzKGZ1bmN0aW9uKCkgewogICAgICB0aGlzLm5vdGlmeVByb3BlcnR5Q2hh
        bmdlKCdkYXRhJyk7CiAgICB9KTsKICB9LAoKICBtYXRlcmlhbGl6ZUlkOiBm
        dW5jdGlvbihpZCkgewogICAgc2V0KHRoaXMsICdpZCcsIGlkKTsKICB9LAoK
        ICBtYXRlcmlhbGl6ZUF0dHJpYnV0ZXM6IGZ1bmN0aW9uKGF0dHJpYnV0ZXMp
        IHsKICAgIEVtYmVyLmFzc2VydCgiTXVzdCBwYXNzIGEgaGFzaCBvZiBhdHRy
        aWJ1dGVzIHRvIG1hdGVyaWFsaXplQXR0cmlidXRlcyIsICEhYXR0cmlidXRl
        cyk7CiAgICBtZXJnZSh0aGlzLl9kYXRhLCBhdHRyaWJ1dGVzKTsKICB9LAoK
        ICBtYXRlcmlhbGl6ZUF0dHJpYnV0ZTogZnVuY3Rpb24obmFtZSwgdmFsdWUp
        IHsKICAgIHRoaXMuX2RhdGFbbmFtZV0gPSB2YWx1ZTsKICB9LAoKICB1cGRh
        dGVIYXNNYW55OiBmdW5jdGlvbihuYW1lLCByZWNvcmRzKSB7CiAgICB0aGlz
        Ll9kYXRhW25hbWVdID0gcmVjb3JkczsKICAgIHRoaXMuaGFzTWFueURpZENo
        YW5nZShuYW1lKTsKICB9LAoKICByb2xsYmFjazogZnVuY3Rpb24oKSB7CiAg
        ICB0aGlzLl9zZXR1cCgpOwogICAgdGhpcy5zZW5kKCdiZWNhbWVDbGVhbicp
        OwoKICAgIHRoaXMuc3VzcGVuZFJlbGF0aW9uc2hpcE9ic2VydmVycyhmdW5j
        dGlvbigpIHsKICAgICAgdGhpcy5ub3RpZnlQcm9wZXJ0eUNoYW5nZSgnZGF0
        YScpOwogICAgfSk7CiAgfSwKCiAgdG9TdHJpbmdFeHRlbnNpb246IGZ1bmN0
        aW9uKCkgewogICAgcmV0dXJuIGdldCh0aGlzLCAnaWQnKTsKICB9LAoKICAv
        KioKICAgIFRoZSBnb2FsIG9mIHRoaXMgbWV0aG9kIGlzIHRvIHRlbXBvcmFy
        aWx5IGRpc2FibGUgc3BlY2lmaWMgb2JzZXJ2ZXJzCiAgICB0aGF0IHRha2Ug
        YWN0aW9uIGluIHJlc3BvbnNlIHRvIGFwcGxpY2F0aW9uIGNoYW5nZXMuCgog
        ICAgVGhpcyBhbGxvd3MgdGhlIHN5c3RlbSB0byBtYWtlIGNoYW5nZXMgKHN1
        Y2ggYXMgbWF0ZXJpYWxpemF0aW9uIGFuZAogICAgcm9sbGJhY2spIHRoYXQg
        c2hvdWxkIG5vdCB0cmlnZ2VyIHNlY29uZGFyeSBiZWhhdmlvciAoc3VjaCBh
        cyBzZXR0aW5nIGFuCiAgICBpbnZlcnNlIHJlbGF0aW9uc2hpcCBvciBtYXJr
        aW5nIHJlY29yZHMgYXMgZGlydHkpLgoKICAgIFRoZSBzcGVjaWZpYyBpbXBs
        ZW1lbnRhdGlvbiB3aWxsIGxpa2VseSBjaGFuZ2UgYXMgRW1iZXIgcHJvcGVy
        IHByb3ZpZGVzCiAgICBiZXR0ZXIgaW5mcmFzdHJ1Y3R1cmUgZm9yIHN1c3Bl
        bmRpbmcgZ3JvdXBzIG9mIG9ic2VydmVycywgYW5kIGlmIEFycmF5CiAgICBv
        YnNlcnZhdGlvbiBiZWNvbWVzIG1vcmUgdW5pZmllZCB3aXRoIHJlZ3VsYXIg
        b2JzZXJ2ZXJzLgoKICAgIEBtZXRob2Qgc3VzcGVuZFJlbGF0aW9uc2hpcE9i
        c2VydmVycwogICAgQHByaXZhdGUKICAgIEBwYXJhbSBjYWxsYmFjawogICAg
        QHBhcmFtIGJpbmRpbmcKICAqLwogIHN1c3BlbmRSZWxhdGlvbnNoaXBPYnNl
        cnZlcnM6IGZ1bmN0aW9uKGNhbGxiYWNrLCBiaW5kaW5nKSB7CiAgICB2YXIg
        b2JzZXJ2ZXJzID0gZ2V0KHRoaXMuY29uc3RydWN0b3IsICdyZWxhdGlvbnNo
        aXBOYW1lcycpLmJlbG9uZ3NUbzsKICAgIHZhciBzZWxmID0gdGhpczsKCiAg
        ICB0cnkgewogICAgICB0aGlzLl9zdXNwZW5kZWRSZWxhdGlvbnNoaXBzID0g
        dHJ1ZTsKICAgICAgRW1iZXIuX3N1c3BlbmRPYnNlcnZlcnMoc2VsZiwgb2Jz
        ZXJ2ZXJzLCBudWxsLCAnYmVsb25nc1RvRGlkQ2hhbmdlJywgZnVuY3Rpb24o
        KSB7CiAgICAgICAgRW1iZXIuX3N1c3BlbmRCZWZvcmVPYnNlcnZlcnMoc2Vs
        Ziwgb2JzZXJ2ZXJzLCBudWxsLCAnYmVsb25nc1RvV2lsbENoYW5nZScsIGZ1
        bmN0aW9uKCkgewogICAgICAgICAgY2FsbGJhY2suY2FsbChiaW5kaW5nIHx8
        IHNlbGYpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0gZmluYWxseSB7
        CiAgICAgIHRoaXMuX3N1c3BlbmRlZFJlbGF0aW9uc2hpcHMgPSBmYWxzZTsK
        ICAgIH0KICB9LAoKICAvKioKICAgIFNhdmUgdGhlIHJlY29yZC4KCiAgICBA
        bWV0aG9kIHNhdmUKICAqLwogIHNhdmU6IGZ1bmN0aW9uKCkgewogICAgdmFy
        IHJlc29sdmVyID0gRW1iZXIuUlNWUC5kZWZlcigpLCByZWNvcmQgPSB0aGlz
        OwoKICAgIHRoaXMuZ2V0KCdzdG9yZScpLnNjaGVkdWxlU2F2ZSh0aGlzLCBy
        ZXNvbHZlcik7CiAgICB0aGlzLl9pbkZsaWdodEF0dHJpYnV0ZXMgPSB0aGlz
        Ll9hdHRyaWJ1dGVzOwogICAgdGhpcy5fYXR0cmlidXRlcyA9IHt9OwoKICAg
        IHJldHVybiBEUy5Qcm9taXNlT2JqZWN0LmNyZWF0ZSh7IHByb21pc2U6IHJl
        c29sdmVyLnByb21pc2UgfSk7CiAgfSwKCiAgLyoqCiAgICBSZWxvYWQgdGhl
        IHJlY29yZCBmcm9tIHRoZSBhZGFwdGVyLgoKICAgIFRoaXMgd2lsbCBvbmx5
        IHdvcmsgaWYgdGhlIHJlY29yZCBoYXMgYWxyZWFkeSBmaW5pc2hlZCBsb2Fk
        aW5nCiAgICBhbmQgaGFzIG5vdCB5ZXQgYmVlbiBtb2RpZmllZCAoYGlzTG9h
        ZGVkYCBidXQgbm90IGBpc0RpcnR5YCwKICAgIG9yIGBpc1NhdmluZ2ApLgoK
        ICAgIEBtZXRob2QgcmVsb2FkCiAgKi8KICByZWxvYWQ6IGZ1bmN0aW9uKCkg
        ewogICAgc2V0KHRoaXMsICdpc1JlbG9hZGluZycsIHRydWUpOwoKICAgIHZh
        ciByZXNvbHZlciA9IEVtYmVyLlJTVlAuZGVmZXIoKSwgcmVjb3JkID0gdGhp
        czsKCiAgICByZXNvbHZlci5wcm9taXNlID0gcmVzb2x2ZXIucHJvbWlzZS50
        aGVuKGZ1bmN0aW9uKCkgewogICAgICByZWNvcmQuc2V0KCdpc1JlbG9hZGlu
        ZycsIGZhbHNlKTsKICAgICAgcmVjb3JkLnNldCgnaXNFcnJvcicsIGZhbHNl
        KTsKICAgICAgcmV0dXJuIHJlY29yZDsKICAgIH0sIGZ1bmN0aW9uKHJlYXNv
        bikgewogICAgICByZWNvcmQuc2V0KCdpc0Vycm9yJywgdHJ1ZSk7CiAgICAg
        IHRocm93IHJlYXNvbjsKICAgIH0pOwoKICAgIHRoaXMuc2VuZCgncmVsb2Fk
        UmVjb3JkJywgcmVzb2x2ZXIpOwoKICAgIHJldHVybiBEUy5Qcm9taXNlT2Jq
        ZWN0LmNyZWF0ZSh7IHByb21pc2U6IHJlc29sdmVyLnByb21pc2UgfSk7CiAg
        fSwKCiAgLy8gRk9SIFVTRSBEVVJJTkcgQ09NTUlUIFBST0NFU1MKCiAgYWRh
        cHRlckRpZFVwZGF0ZUF0dHJpYnV0ZTogZnVuY3Rpb24oYXR0cmlidXRlTmFt
        ZSwgdmFsdWUpIHsKCiAgICAvLyBJZiBhIHZhbHVlIGlzIHBhc3NlZCBpbiwg
        dXBkYXRlIHRoZSBpbnRlcm5hbCBhdHRyaWJ1dGVzIGFuZCBjbGVhcgogICAg
        Ly8gdGhlIGF0dHJpYnV0ZSBjYWNoZSBzbyBpdCBwaWNrcyB1cCB0aGUgbmV3
        IHZhbHVlLiBPdGhlcndpc2UsCiAgICAvLyBjb2xsYXBzZSB0aGUgY3VycmVu
        dCB2YWx1ZSBpbnRvIHRoZSBpbnRlcm5hbCBhdHRyaWJ1dGVzIGJlY2F1c2UK
        ICAgIC8vIHRoZSBhZGFwdGVyIGhhcyBhY2tub3dsZWRnZWQgaXQuCiAgICBp
        ZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICB0aGlzLl9kYXRhW2F0
        dHJpYnV0ZU5hbWVdID0gdmFsdWU7CiAgICAgIHRoaXMubm90aWZ5UHJvcGVy
        dHlDaGFuZ2UoYXR0cmlidXRlTmFtZSk7CiAgICB9IGVsc2UgewogICAgICB0
        aGlzLl9kYXRhW2F0dHJpYnV0ZU5hbWVdID0gdGhpcy5faW5GbGlnaHRBdHRy
        aWJ1dGVzW2F0dHJpYnV0ZU5hbWVdOwogICAgfQoKICAgIHRoaXMudXBkYXRl
        UmVjb3JkQXJyYXlzTGF0ZXIoKTsKICB9LAoKICBhZGFwdGVyRGlkSW52YWxp
        ZGF0ZTogZnVuY3Rpb24oZXJyb3JzKSB7CiAgICB0aGlzLnNlbmQoJ2JlY2Ft
        ZUludmFsaWQnLCBlcnJvcnMpOwogIH0sCgogIGFkYXB0ZXJEaWRFcnJvcjog
        ZnVuY3Rpb24oKSB7CiAgICB0aGlzLnNlbmQoJ2JlY2FtZUVycm9yJyk7CiAg
        ICBzZXQodGhpcywgJ2lzRXJyb3InLCB0cnVlKTsKICB9LAoKICAvKioKICAg
        IE92ZXJyaWRlIHRoZSBkZWZhdWx0IGV2ZW50IGZpcmluZyBmcm9tIEVtYmVy
        LkV2ZW50ZWQgdG8KICAgIGFsc28gY2FsbCBtZXRob2RzIHdpdGggdGhlIGdp
        dmVuIG5hbWUuCgogICAgQG1ldGhvZCB0cmlnZ2VyCiAgICBAcHJpdmF0ZQog
        ICAgQHBhcmFtIG5hbWUKICAqLwogIHRyaWdnZXI6IGZ1bmN0aW9uKG5hbWUp
        IHsKICAgIEVtYmVyLnRyeUludm9rZSh0aGlzLCBuYW1lLCBbXS5zbGljZS5j
        YWxsKGFyZ3VtZW50cywgMSkpOwogICAgdGhpcy5fc3VwZXIuYXBwbHkodGhp
        cywgYXJndW1lbnRzKTsKICB9LAoKICB0cmlnZ2VyTGF0ZXI6IGZ1bmN0aW9u
        KCkgewogICAgdGhpcy5fZGVmZXJyZWRUcmlnZ2Vycy5wdXNoKGFyZ3VtZW50
        cyk7CiAgICBvbmNlKHRoaXMsICdfdHJpZ2dlckRlZmVycmVkVHJpZ2dlcnMn
        KTsKICB9LAoKICBfdHJpZ2dlckRlZmVycmVkVHJpZ2dlcnM6IGZ1bmN0aW9u
        KCkgewogICAgZm9yICh2YXIgaT0wLCBsPXRoaXMuX2RlZmVycmVkVHJpZ2dl
        cnMubGVuZ3RoOyBpPGw7IGkrKykgewogICAgICB0aGlzLnRyaWdnZXIuYXBw
        bHkodGhpcywgdGhpcy5fZGVmZXJyZWRUcmlnZ2Vyc1tpXSk7CiAgICB9Cgog
        ICAgdGhpcy5fZGVmZXJyZWRUcmlnZ2VycyA9IFtdOwogIH0KfSk7CgpEUy5N
        b2RlbC5yZW9wZW5DbGFzcyh7CgogIC8qKgogICAgQWxpYXMgRFMuTW9kZWwn
        cyBgY3JlYXRlYCBtZXRob2QgdG8gYF9jcmVhdGVgLiBUaGlzIGFsbG93cyB1
        cyB0byBjcmVhdGUgRFMuTW9kZWwKICAgIGluc3RhbmNlcyBmcm9tIHdpdGhp
        biB0aGUgc3RvcmUsIGJ1dCBpZiBlbmQgdXNlcnMgYWNjaWRlbnRhbGx5IGNh
        bGwgYGNyZWF0ZSgpYAogICAgKGluc3RlYWQgb2YgYGNyZWF0ZVJlY29yZCgp
        YCksIHdlIGNhbiByYWlzZSBhbiBlcnJvci4KCiAgICBAbWV0aG9kIF9jcmVh
        dGUKICAgIEBwcml2YXRlCiAgICBAc3RhdGljCiAgKi8KICBfY3JlYXRlOiBE
        Uy5Nb2RlbC5jcmVhdGUsCgogIC8qKgogICAgT3ZlcnJpZGUgdGhlIGNsYXNz
        JyBgY3JlYXRlKClgIG1ldGhvZCB0byByYWlzZSBhbiBlcnJvci4gVGhpcyBw
        cmV2ZW50cyBlbmQgdXNlcnMKICAgIGZyb20gaW5hZHZlcnRlbnRseSBjYWxs
        aW5nIGBjcmVhdGUoKWAgaW5zdGVhZCBvZiBgY3JlYXRlUmVjb3JkKClgLiBU
        aGUgc3RvcmUgaXMKICAgIHN0aWxsIGFibGUgdG8gY3JlYXRlIGluc3RhbmNl
        cyBieSBjYWxsaW5nIHRoZSBgX2NyZWF0ZSgpYCBtZXRob2QuCgogICAgQG1l
        dGhvZCBjcmVhdGUKICAgIEBwcml2YXRlCiAgICBAc3RhdGljCiAgKi8KICBj
        cmVhdGU6IGZ1bmN0aW9uKCkgewogICAgdGhyb3cgbmV3IEVtYmVyLkVycm9y
        KCJZb3Ugc2hvdWxkIG5vdCBjYWxsIGBjcmVhdGVgIG9uIGEgbW9kZWwuIElu
        c3RlYWQsIGNhbGwgYHN0b3JlLmNyZWF0ZVJlY29yZGAgd2l0aCB0aGUgYXR0
        cmlidXRlcyB5b3Ugd291bGQgbGlrZSB0byBzZXQuIik7CiAgfQp9KTsKCn0p
        KCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCiAgQG1vZHVsZSBlbWJlci1kYXRh
        CiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0OwoKLyoqCiAgQGNsYXNzIE1vZGVs
        CiAgQG5hbWVzcGFjZSBEUwoqLwpEUy5Nb2RlbC5yZW9wZW5DbGFzcyh7CiAg
        YXR0cmlidXRlczogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICB2
        YXIgbWFwID0gRW1iZXIuTWFwLmNyZWF0ZSgpOwoKICAgIHRoaXMuZWFjaENv
        bXB1dGVkUHJvcGVydHkoZnVuY3Rpb24obmFtZSwgbWV0YSkgewogICAgICBp
        ZiAobWV0YS5pc0F0dHJpYnV0ZSkgewogICAgICAgIEVtYmVyLmFzc2VydCgi
        WW91IG1heSBub3Qgc2V0IGBpZGAgYXMgYW4gYXR0cmlidXRlIG9uIHlvdXIg
        bW9kZWwuIFBsZWFzZSByZW1vdmUgYW55IGxpbmVzIHRoYXQgbG9vayBsaWtl
        OiBgaWQ6IERTLmF0dHIoJzx0eXBlPicpYCBmcm9tICIgKyB0aGlzLnRvU3Ry
        aW5nKCksIG5hbWUgIT09ICdpZCcpOwoKICAgICAgICBtZXRhLm5hbWUgPSBu
        YW1lOwogICAgICAgIG1hcC5zZXQobmFtZSwgbWV0YSk7CiAgICAgIH0KICAg
        IH0pOwoKICAgIHJldHVybiBtYXA7CiAgfSksCgogIHRyYW5zZm9ybWVkQXR0
        cmlidXRlczogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICB2YXIg
        bWFwID0gRW1iZXIuTWFwLmNyZWF0ZSgpOwoKICAgIHRoaXMuZWFjaEF0dHJp
        YnV0ZShmdW5jdGlvbihrZXksIG1ldGEpIHsKICAgICAgaWYgKG1ldGEudHlw
        ZSkgewogICAgICAgIG1hcC5zZXQoa2V5LCBtZXRhLnR5cGUpOwogICAgICB9
        CiAgICB9KTsKCiAgICByZXR1cm4gbWFwOwogIH0pLAoKICBlYWNoQXR0cmli
        dXRlOiBmdW5jdGlvbihjYWxsYmFjaywgYmluZGluZykgewogICAgZ2V0KHRo
        aXMsICdhdHRyaWJ1dGVzJykuZm9yRWFjaChmdW5jdGlvbihuYW1lLCBtZXRh
        KSB7CiAgICAgIGNhbGxiYWNrLmNhbGwoYmluZGluZywgbmFtZSwgbWV0YSk7
        CiAgICB9LCBiaW5kaW5nKTsKICB9LAoKICBlYWNoVHJhbnNmb3JtZWRBdHRy
        aWJ1dGU6IGZ1bmN0aW9uKGNhbGxiYWNrLCBiaW5kaW5nKSB7CiAgICBnZXQo
        dGhpcywgJ3RyYW5zZm9ybWVkQXR0cmlidXRlcycpLmZvckVhY2goZnVuY3Rp
        b24obmFtZSwgdHlwZSkgewogICAgICBjYWxsYmFjay5jYWxsKGJpbmRpbmcs
        IG5hbWUsIHR5cGUpOwogICAgfSk7CiAgfQp9KTsKCgpEUy5Nb2RlbC5yZW9w
        ZW4oewogIGVhY2hBdHRyaWJ1dGU6IGZ1bmN0aW9uKGNhbGxiYWNrLCBiaW5k
        aW5nKSB7CiAgICB0aGlzLmNvbnN0cnVjdG9yLmVhY2hBdHRyaWJ1dGUoY2Fs
        bGJhY2ssIGJpbmRpbmcpOwogIH0KfSk7CgpmdW5jdGlvbiBnZXRBdHRyKHJl
        Y29yZCwgb3B0aW9ucywga2V5KSB7CiAgdmFyIGF0dHJpYnV0ZXMgPSBnZXQo
        cmVjb3JkLCAnZGF0YScpOwogIHZhciB2YWx1ZSA9IGF0dHJpYnV0ZXNba2V5
        XTsKCiAgaWYgKHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgIGlmICh0eXBl
        b2Ygb3B0aW9ucy5kZWZhdWx0VmFsdWUgPT09ICJmdW5jdGlvbiIpIHsKICAg
        ICAgdmFsdWUgPSBvcHRpb25zLmRlZmF1bHRWYWx1ZSgpOwogICAgfSBlbHNl
        IHsKICAgICAgdmFsdWUgPSBvcHRpb25zLmRlZmF1bHRWYWx1ZTsKICAgIH0K
        ICB9CgogIHJldHVybiB2YWx1ZTsKfQoKRFMuYXR0ciA9IGZ1bmN0aW9uKHR5
        cGUsIG9wdGlvbnMpIHsKICBvcHRpb25zID0gb3B0aW9ucyB8fCB7fTsKCiAg
        dmFyIG1ldGEgPSB7CiAgICB0eXBlOiB0eXBlLAogICAgaXNBdHRyaWJ1dGU6
        IHRydWUsCiAgICBvcHRpb25zOiBvcHRpb25zCiAgfTsKCiAgcmV0dXJuIEVt
        YmVyLmNvbXB1dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUsIG9sZFZhbHVlKSB7
        CiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA+IDEpIHsKICAgICAgRW1iZXIu
        YXNzZXJ0KCJZb3UgbWF5IG5vdCBzZXQgYGlkYCBhcyBhbiBhdHRyaWJ1dGUg
        b24geW91ciBtb2RlbC4gUGxlYXNlIHJlbW92ZSBhbnkgbGluZXMgdGhhdCBs
        b29rIGxpa2U6IGBpZDogRFMuYXR0cignPHR5cGU+JylgIGZyb20gIiArIHRo
        aXMuY29uc3RydWN0b3IudG9TdHJpbmcoKSwga2V5ICE9PSAnaWQnKTsKICAg
        ICAgdGhpcy5zZW5kKCdkaWRTZXRQcm9wZXJ0eScsIHsgbmFtZToga2V5LCBv
        bGRWYWx1ZTogdGhpcy5fYXR0cmlidXRlc1trZXldIHx8IHRoaXMuX2luRmxp
        Z2h0QXR0cmlidXRlc1trZXldIHx8IHRoaXMuX2RhdGFba2V5XSwgdmFsdWU6
        IHZhbHVlIH0pOwogICAgICB0aGlzLl9hdHRyaWJ1dGVzW2tleV0gPSB2YWx1
        ZTsKICAgIH0gZWxzZSBpZiAodGhpcy5fYXR0cmlidXRlc1trZXldKSB7CiAg
        ICAgIHJldHVybiB0aGlzLl9hdHRyaWJ1dGVzW2tleV07CiAgICB9IGVsc2Ug
        ewogICAgICB2YWx1ZSA9IGdldEF0dHIodGhpcywgb3B0aW9ucywga2V5KTsK
        ICAgIH0KCiAgICByZXR1cm4gdmFsdWU7CiAgLy8gYGRhdGFgIGlzIG5ldmVy
        IHNldCBkaXJlY3RseS4gSG93ZXZlciwgaXQgbWF5IGJlCiAgLy8gaW52YWxp
        ZGF0ZWQgZnJvbSB0aGUgc3RhdGUgbWFuYWdlcidzIHNldERhdGEKICAvLyBl
        dmVudC4KICB9KS5wcm9wZXJ0eSgnZGF0YScpLm1ldGEobWV0YSk7Cn07CgoK
        fSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKICBAbW9kdWxlIGVtYmVyLWRh
        dGEKKi8KCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCiAgQG1vZHVsZSBl
        bWJlci1kYXRhCiovCgovKioKICBBbiBBdHRyaWJ1dGVDaGFuZ2Ugb2JqZWN0
        IGlzIGNyZWF0ZWQgd2hlbmV2ZXIgYSByZWNvcmQncwogIGF0dHJpYnV0ZSBj
        aGFuZ2VzIHZhbHVlLiBJdCBpcyB1c2VkIHRvIHRyYWNrIGNoYW5nZXMgdG8g
        YQogIHJlY29yZCBiZXR3ZWVuIHRyYW5zYWN0aW9uIGNvbW1pdHMuCgogIEBj
        bGFzcyBBdHRyaWJ1dGVDaGFuZ2UKICBAbmFtZXNwYWNlIERTCiAgQHByaXZh
        dGUKICBAY29uc3RydWN0b3IKKi8KdmFyIEF0dHJpYnV0ZUNoYW5nZSA9IERT
        LkF0dHJpYnV0ZUNoYW5nZSA9IGZ1bmN0aW9uKG9wdGlvbnMpIHsKICB0aGlz
        LnJlY29yZCA9IG9wdGlvbnMucmVjb3JkOwogIHRoaXMuc3RvcmUgPSBvcHRp
        b25zLnN0b3JlOwogIHRoaXMubmFtZSA9IG9wdGlvbnMubmFtZTsKICB0aGlz
        LnZhbHVlID0gb3B0aW9ucy52YWx1ZTsKICB0aGlzLm9sZFZhbHVlID0gb3B0
        aW9ucy5vbGRWYWx1ZTsKfTsKCkF0dHJpYnV0ZUNoYW5nZS5jcmVhdGVDaGFu
        Z2UgPSBmdW5jdGlvbihvcHRpb25zKSB7CiAgcmV0dXJuIG5ldyBBdHRyaWJ1
        dGVDaGFuZ2Uob3B0aW9ucyk7Cn07CgpBdHRyaWJ1dGVDaGFuZ2UucHJvdG90
        eXBlID0gewogIHN5bmM6IGZ1bmN0aW9uKCkgewogICAgaWYgKHRoaXMudmFs
        dWUgIT09IHRoaXMub2xkVmFsdWUpIHsKICAgICAgdGhpcy5yZWNvcmQuc2Vu
        ZCgnYmVjb21lRGlydHknKTsKICAgICAgdGhpcy5yZWNvcmQudXBkYXRlUmVj
        b3JkQXJyYXlzTGF0ZXIoKTsKICAgIH0KCiAgICAvLyBUT0RPOiBVc2UgdGhp
        cyBvYmplY3QgaW4gdGhlIGNvbW1pdCBwcm9jZXNzCiAgICB0aGlzLmRlc3Ry
        b3koKTsKICB9LAoKICAvKioKICAgIElmIHRoZSBBdHRyaWJ1dGVDaGFuZ2Ug
        aXMgZGVzdHJveWVkIChlaXRoZXIgYnkgYmVpbmcgcm9sbGVkIGJhY2sKICAg
        IG9yIGJlaW5nIGNvbW1pdHRlZCksIHJlbW92ZSBpdCBmcm9tIHRoZSBsaXN0
        IG9mIHBlbmRpbmcgY2hhbmdlcwogICAgb24gdGhlIHJlY29yZC4KCiAgICBA
        bWV0aG9kIGRlc3Ryb3kKICAqLwogIGRlc3Ryb3k6IGZ1bmN0aW9uKCkgewog
        ICAgZGVsZXRlIHRoaXMucmVjb3JkLl9jaGFuZ2VzVG9TeW5jW3RoaXMubmFt
        ZV07CiAgfQp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioKICBAbW9k
        dWxlIGVtYmVyLWRhdGEKKi8KCnZhciBnZXQgPSBFbWJlci5nZXQsIHNldCA9
        IEVtYmVyLnNldDsKdmFyIGZvckVhY2ggPSBFbWJlci5FbnVtZXJhYmxlVXRp
        bHMuZm9yRWFjaDsKCi8qKgogIEBjbGFzcyBSZWxhdGlvbnNoaXBDaGFuZ2UK
        ICBAbmFtZXNwYWNlIERTCiAgQHByaXZhdGUKICBAY29uc3RydXRvcgoqLwpE
        Uy5SZWxhdGlvbnNoaXBDaGFuZ2UgPSBmdW5jdGlvbihvcHRpb25zKSB7CiAg
        dGhpcy5wYXJlbnRSZWNvcmQgPSBvcHRpb25zLnBhcmVudFJlY29yZDsKICB0
        aGlzLmNoaWxkUmVjb3JkID0gb3B0aW9ucy5jaGlsZFJlY29yZDsKICB0aGlz
        LmZpcnN0UmVjb3JkID0gb3B0aW9ucy5maXJzdFJlY29yZDsKICB0aGlzLmZp
        cnN0UmVjb3JkS2luZCA9IG9wdGlvbnMuZmlyc3RSZWNvcmRLaW5kOwogIHRo
        aXMuZmlyc3RSZWNvcmROYW1lID0gb3B0aW9ucy5maXJzdFJlY29yZE5hbWU7
        CiAgdGhpcy5zZWNvbmRSZWNvcmQgPSBvcHRpb25zLnNlY29uZFJlY29yZDsK
        ICB0aGlzLnNlY29uZFJlY29yZEtpbmQgPSBvcHRpb25zLnNlY29uZFJlY29y
        ZEtpbmQ7CiAgdGhpcy5zZWNvbmRSZWNvcmROYW1lID0gb3B0aW9ucy5zZWNv
        bmRSZWNvcmROYW1lOwogIHRoaXMuY2hhbmdlVHlwZSA9IG9wdGlvbnMuY2hh
        bmdlVHlwZTsKICB0aGlzLnN0b3JlID0gb3B0aW9ucy5zdG9yZTsKCiAgdGhp
        cy5jb21taXR0ZWQgPSB7fTsKfTsKCi8qKgogIEBjbGFzcyBSZWxhdGlvbnNo
        aXBDaGFuZ2VBZGQKICBAbmFtZXNwYWNlIERTCiAgQHByaXZhdGUKICBAY29u
        c3RydXRvcgoqLwpEUy5SZWxhdGlvbnNoaXBDaGFuZ2VBZGQgPSBmdW5jdGlv
        bihvcHRpb25zKXsKICBEUy5SZWxhdGlvbnNoaXBDaGFuZ2UuY2FsbCh0aGlz
        LCBvcHRpb25zKTsKfTsKCi8qKgogIEBjbGFzcyBSZWxhdGlvbnNoaXBDaGFu
        Z2VSZW1vdmUKICBAbmFtZXNwYWNlIERTCiAgQHByaXZhdGUKICBAY29uc3Ry
        dXRvcgoqLwpEUy5SZWxhdGlvbnNoaXBDaGFuZ2VSZW1vdmUgPSBmdW5jdGlv
        bihvcHRpb25zKXsKICBEUy5SZWxhdGlvbnNoaXBDaGFuZ2UuY2FsbCh0aGlz
        LCBvcHRpb25zKTsKfTsKCkRTLlJlbGF0aW9uc2hpcENoYW5nZS5jcmVhdGUg
        PSBmdW5jdGlvbihvcHRpb25zKSB7CiAgcmV0dXJuIG5ldyBEUy5SZWxhdGlv
        bnNoaXBDaGFuZ2Uob3B0aW9ucyk7Cn07CgpEUy5SZWxhdGlvbnNoaXBDaGFu
        Z2VBZGQuY3JlYXRlID0gZnVuY3Rpb24ob3B0aW9ucykgewogIHJldHVybiBu
        ZXcgRFMuUmVsYXRpb25zaGlwQ2hhbmdlQWRkKG9wdGlvbnMpOwp9OwoKRFMu
        UmVsYXRpb25zaGlwQ2hhbmdlUmVtb3ZlLmNyZWF0ZSA9IGZ1bmN0aW9uKG9w
        dGlvbnMpIHsKICByZXR1cm4gbmV3IERTLlJlbGF0aW9uc2hpcENoYW5nZVJl
        bW92ZShvcHRpb25zKTsKfTsKCkRTLk9uZVRvTWFueUNoYW5nZSA9IHt9OwpE
        Uy5PbmVUb05vbmVDaGFuZ2UgPSB7fTsKRFMuTWFueVRvTm9uZUNoYW5nZSA9
        IHt9OwpEUy5PbmVUb09uZUNoYW5nZSA9IHt9OwpEUy5NYW55VG9NYW55Q2hh
        bmdlID0ge307CgpEUy5SZWxhdGlvbnNoaXBDaGFuZ2UuX2NyZWF0ZUNoYW5n
        ZSA9IGZ1bmN0aW9uKG9wdGlvbnMpewogIGlmKG9wdGlvbnMuY2hhbmdlVHlw
        ZSA9PT0gImFkZCIpewogICAgcmV0dXJuIERTLlJlbGF0aW9uc2hpcENoYW5n
        ZUFkZC5jcmVhdGUob3B0aW9ucyk7CiAgfQogIGlmKG9wdGlvbnMuY2hhbmdl
        VHlwZSA9PT0gInJlbW92ZSIpewogICAgcmV0dXJuIERTLlJlbGF0aW9uc2hp
        cENoYW5nZVJlbW92ZS5jcmVhdGUob3B0aW9ucyk7CiAgfQp9OwoKCkRTLlJl
        bGF0aW9uc2hpcENoYW5nZS5kZXRlcm1pbmVSZWxhdGlvbnNoaXBUeXBlID0g
        ZnVuY3Rpb24ocmVjb3JkVHlwZSwga25vd25TaWRlKXsKICB2YXIga25vd25L
        ZXkgPSBrbm93blNpZGUua2V5LCBrZXksIG90aGVyS2luZDsKICB2YXIga25v
        d25LaW5kID0ga25vd25TaWRlLmtpbmQ7CgogIHZhciBpbnZlcnNlID0gcmVj
        b3JkVHlwZS5pbnZlcnNlRm9yKGtub3duS2V5KTsKCiAgaWYgKGludmVyc2Up
        ewogICAga2V5ID0gaW52ZXJzZS5uYW1lOwogICAgb3RoZXJLaW5kID0gaW52
        ZXJzZS5raW5kOwogIH0KCiAgaWYgKCFpbnZlcnNlKXsKICAgIHJldHVybiBr
        bm93bktpbmQgPT09ICJiZWxvbmdzVG8iID8gIm9uZVRvTm9uZSIgOiAibWFu
        eVRvTm9uZSI7CiAgfQogIGVsc2V7CiAgICBpZihvdGhlcktpbmQgPT09ICJi
        ZWxvbmdzVG8iKXsKICAgICAgcmV0dXJuIGtub3duS2luZCA9PT0gImJlbG9u
        Z3NUbyIgPyAib25lVG9PbmUiIDogIm1hbnlUb09uZSI7CiAgICB9CiAgICBl
        bHNlewogICAgICByZXR1cm4ga25vd25LaW5kID09PSAiYmVsb25nc1RvIiA/
        ICJvbmVUb01hbnkiIDogIm1hbnlUb01hbnkiOwogICAgfQogIH0KCn07CgpE
        Uy5SZWxhdGlvbnNoaXBDaGFuZ2UuY3JlYXRlQ2hhbmdlID0gZnVuY3Rpb24o
        Zmlyc3RSZWNvcmQsIHNlY29uZFJlY29yZCwgc3RvcmUsIG9wdGlvbnMpewog
        IC8vIEdldCB0aGUgdHlwZSBvZiB0aGUgY2hpbGQgYmFzZWQgb24gdGhlIGNo
        aWxkJ3MgY2xpZW50IElECiAgdmFyIGZpcnN0UmVjb3JkVHlwZSA9IGZpcnN0
        UmVjb3JkLmNvbnN0cnVjdG9yLCBjaGFuZ2VUeXBlOwogIGNoYW5nZVR5cGUg
        PSBEUy5SZWxhdGlvbnNoaXBDaGFuZ2UuZGV0ZXJtaW5lUmVsYXRpb25zaGlw
        VHlwZShmaXJzdFJlY29yZFR5cGUsIG9wdGlvbnMpOwogIGlmIChjaGFuZ2VU
        eXBlID09PSAib25lVG9NYW55Iil7CiAgICByZXR1cm4gRFMuT25lVG9NYW55
        Q2hhbmdlLmNyZWF0ZUNoYW5nZShmaXJzdFJlY29yZCwgc2Vjb25kUmVjb3Jk
        LCBzdG9yZSwgb3B0aW9ucyk7CiAgfQogIGVsc2UgaWYgKGNoYW5nZVR5cGUg
        PT09ICJtYW55VG9PbmUiKXsKICAgIHJldHVybiBEUy5PbmVUb01hbnlDaGFu
        Z2UuY3JlYXRlQ2hhbmdlKHNlY29uZFJlY29yZCwgZmlyc3RSZWNvcmQsIHN0
        b3JlLCBvcHRpb25zKTsKICB9CiAgZWxzZSBpZiAoY2hhbmdlVHlwZSA9PT0g
        Im9uZVRvTm9uZSIpewogICAgcmV0dXJuIERTLk9uZVRvTm9uZUNoYW5nZS5j
        cmVhdGVDaGFuZ2UoZmlyc3RSZWNvcmQsIHNlY29uZFJlY29yZCwgc3RvcmUs
        IG9wdGlvbnMpOwogIH0KICBlbHNlIGlmIChjaGFuZ2VUeXBlID09PSAibWFu
        eVRvTm9uZSIpewogICAgcmV0dXJuIERTLk1hbnlUb05vbmVDaGFuZ2UuY3Jl
        YXRlQ2hhbmdlKGZpcnN0UmVjb3JkLCBzZWNvbmRSZWNvcmQsIHN0b3JlLCBv
        cHRpb25zKTsKICB9CiAgZWxzZSBpZiAoY2hhbmdlVHlwZSA9PT0gIm9uZVRv
        T25lIil7CiAgICByZXR1cm4gRFMuT25lVG9PbmVDaGFuZ2UuY3JlYXRlQ2hh
        bmdlKGZpcnN0UmVjb3JkLCBzZWNvbmRSZWNvcmQsIHN0b3JlLCBvcHRpb25z
        KTsKICB9CiAgZWxzZSBpZiAoY2hhbmdlVHlwZSA9PT0gIm1hbnlUb01hbnki
        KXsKICAgIHJldHVybiBEUy5NYW55VG9NYW55Q2hhbmdlLmNyZWF0ZUNoYW5n
        ZShmaXJzdFJlY29yZCwgc2Vjb25kUmVjb3JkLCBzdG9yZSwgb3B0aW9ucyk7
        CiAgfQp9OwoKRFMuT25lVG9Ob25lQ2hhbmdlLmNyZWF0ZUNoYW5nZSA9IGZ1
        bmN0aW9uKGNoaWxkUmVjb3JkLCBwYXJlbnRSZWNvcmQsIHN0b3JlLCBvcHRp
        b25zKSB7CiAgdmFyIGtleSA9IG9wdGlvbnMua2V5OwogIHZhciBjaGFuZ2Ug
        PSBEUy5SZWxhdGlvbnNoaXBDaGFuZ2UuX2NyZWF0ZUNoYW5nZSh7CiAgICAg
        IHBhcmVudFJlY29yZDogcGFyZW50UmVjb3JkLAogICAgICBjaGlsZFJlY29y
        ZDogY2hpbGRSZWNvcmQsCiAgICAgIGZpcnN0UmVjb3JkOiBjaGlsZFJlY29y
        ZCwKICAgICAgc3RvcmU6IHN0b3JlLAogICAgICBjaGFuZ2VUeXBlOiBvcHRp
        b25zLmNoYW5nZVR5cGUsCiAgICAgIGZpcnN0UmVjb3JkTmFtZToga2V5LAog
        ICAgICBmaXJzdFJlY29yZEtpbmQ6ICJiZWxvbmdzVG8iCiAgfSk7CgogIHN0
        b3JlLmFkZFJlbGF0aW9uc2hpcENoYW5nZUZvcihjaGlsZFJlY29yZCwga2V5
        LCBwYXJlbnRSZWNvcmQsIG51bGwsIGNoYW5nZSk7CgogIHJldHVybiBjaGFu
        Z2U7Cn07CgpEUy5NYW55VG9Ob25lQ2hhbmdlLmNyZWF0ZUNoYW5nZSA9IGZ1
        bmN0aW9uKGNoaWxkUmVjb3JkLCBwYXJlbnRSZWNvcmQsIHN0b3JlLCBvcHRp
        b25zKSB7CiAgdmFyIGtleSA9IG9wdGlvbnMua2V5OwogIHZhciBjaGFuZ2Ug
        PSBEUy5SZWxhdGlvbnNoaXBDaGFuZ2UuX2NyZWF0ZUNoYW5nZSh7CiAgICAg
        IHBhcmVudFJlY29yZDogY2hpbGRSZWNvcmQsCiAgICAgIGNoaWxkUmVjb3Jk
        OiBwYXJlbnRSZWNvcmQsCiAgICAgIHNlY29uZFJlY29yZDogY2hpbGRSZWNv
        cmQsCiAgICAgIHN0b3JlOiBzdG9yZSwKICAgICAgY2hhbmdlVHlwZTogb3B0
        aW9ucy5jaGFuZ2VUeXBlLAogICAgICBzZWNvbmRSZWNvcmROYW1lOiBvcHRp
        b25zLmtleSwKICAgICAgc2Vjb25kUmVjb3JkS2luZDogImhhc01hbnkiCiAg
        fSk7CgogIHN0b3JlLmFkZFJlbGF0aW9uc2hpcENoYW5nZUZvcihjaGlsZFJl
        Y29yZCwga2V5LCBwYXJlbnRSZWNvcmQsIG51bGwsIGNoYW5nZSk7CiAgcmV0
        dXJuIGNoYW5nZTsKfTsKCgpEUy5NYW55VG9NYW55Q2hhbmdlLmNyZWF0ZUNo
        YW5nZSA9IGZ1bmN0aW9uKGNoaWxkUmVjb3JkLCBwYXJlbnRSZWNvcmQsIHN0
        b3JlLCBvcHRpb25zKSB7CiAgLy8gSWYgdGhlIG5hbWUgb2YgdGhlIGJlbG9u
        Z3NUbyBzaWRlIG9mIHRoZSByZWxhdGlvbnNoaXAgaXMgc3BlY2lmaWVkLAog
        IC8vIHVzZSB0aGF0CiAgLy8gSWYgdGhlIHR5cGUgb2YgdGhlIHBhcmVudCBp
        cyBzcGVjaWZpZWQsIGxvb2sgaXQgdXAgb24gdGhlIGNoaWxkJ3MgdHlwZQog
        IC8vIGRlZmluaXRpb24uCiAgdmFyIGtleSA9IG9wdGlvbnMua2V5OwoKICB2
        YXIgY2hhbmdlID0gRFMuUmVsYXRpb25zaGlwQ2hhbmdlLl9jcmVhdGVDaGFu
        Z2UoewogICAgICBwYXJlbnRSZWNvcmQ6IHBhcmVudFJlY29yZCwKICAgICAg
        Y2hpbGRSZWNvcmQ6IGNoaWxkUmVjb3JkLAogICAgICBmaXJzdFJlY29yZDog
        Y2hpbGRSZWNvcmQsCiAgICAgIHNlY29uZFJlY29yZDogcGFyZW50UmVjb3Jk
        LAogICAgICBmaXJzdFJlY29yZEtpbmQ6ICJoYXNNYW55IiwKICAgICAgc2Vj
        b25kUmVjb3JkS2luZDogImhhc01hbnkiLAogICAgICBzdG9yZTogc3RvcmUs
        CiAgICAgIGNoYW5nZVR5cGU6IG9wdGlvbnMuY2hhbmdlVHlwZSwKICAgICAg
        Zmlyc3RSZWNvcmROYW1lOiAga2V5CiAgfSk7CgogIHN0b3JlLmFkZFJlbGF0
        aW9uc2hpcENoYW5nZUZvcihjaGlsZFJlY29yZCwga2V5LCBwYXJlbnRSZWNv
        cmQsIG51bGwsIGNoYW5nZSk7CgoKICByZXR1cm4gY2hhbmdlOwp9OwoKRFMu
        T25lVG9PbmVDaGFuZ2UuY3JlYXRlQ2hhbmdlID0gZnVuY3Rpb24oY2hpbGRS
        ZWNvcmQsIHBhcmVudFJlY29yZCwgc3RvcmUsIG9wdGlvbnMpIHsKICB2YXIg
        a2V5OwoKICAvLyBJZiB0aGUgbmFtZSBvZiB0aGUgYmVsb25nc1RvIHNpZGUg
        b2YgdGhlIHJlbGF0aW9uc2hpcCBpcyBzcGVjaWZpZWQsCiAgLy8gdXNlIHRo
        YXQKICAvLyBJZiB0aGUgdHlwZSBvZiB0aGUgcGFyZW50IGlzIHNwZWNpZmll
        ZCwgbG9vayBpdCB1cCBvbiB0aGUgY2hpbGQncyB0eXBlCiAgLy8gZGVmaW5p
        dGlvbi4KICBpZiAob3B0aW9ucy5wYXJlbnRUeXBlKSB7CiAgICBrZXkgPSBv
        cHRpb25zLnBhcmVudFR5cGUuaW52ZXJzZUZvcihvcHRpb25zLmtleSkubmFt
        ZTsKICB9IGVsc2UgaWYgKG9wdGlvbnMua2V5KSB7CiAgICBrZXkgPSBvcHRp
        b25zLmtleTsKICB9IGVsc2UgewogICAgRW1iZXIuYXNzZXJ0KCJZb3UgbXVz
        dCBwYXNzIGVpdGhlciBhIHBhcmVudFR5cGUgb3IgYmVsb25nc1RvTmFtZSBv
        cHRpb24gdG8gT25lVG9NYW55Q2hhbmdlLmZvckNoaWxkQW5kUGFyZW50Iiwg
        ZmFsc2UpOwogIH0KCiAgdmFyIGNoYW5nZSA9IERTLlJlbGF0aW9uc2hpcENo
        YW5nZS5fY3JlYXRlQ2hhbmdlKHsKICAgICAgcGFyZW50UmVjb3JkOiBwYXJl
        bnRSZWNvcmQsCiAgICAgIGNoaWxkUmVjb3JkOiBjaGlsZFJlY29yZCwKICAg
        ICAgZmlyc3RSZWNvcmQ6IGNoaWxkUmVjb3JkLAogICAgICBzZWNvbmRSZWNv
        cmQ6IHBhcmVudFJlY29yZCwKICAgICAgZmlyc3RSZWNvcmRLaW5kOiAiYmVs
        b25nc1RvIiwKICAgICAgc2Vjb25kUmVjb3JkS2luZDogImJlbG9uZ3NUbyIs
        CiAgICAgIHN0b3JlOiBzdG9yZSwKICAgICAgY2hhbmdlVHlwZTogb3B0aW9u
        cy5jaGFuZ2VUeXBlLAogICAgICBmaXJzdFJlY29yZE5hbWU6ICBrZXkKICB9
        KTsKCiAgc3RvcmUuYWRkUmVsYXRpb25zaGlwQ2hhbmdlRm9yKGNoaWxkUmVj
        b3JkLCBrZXksIHBhcmVudFJlY29yZCwgbnVsbCwgY2hhbmdlKTsKCgogIHJl
        dHVybiBjaGFuZ2U7Cn07CgpEUy5PbmVUb09uZUNoYW5nZS5tYWludGFpbklu
        dmFyaWFudCA9IGZ1bmN0aW9uKG9wdGlvbnMsIHN0b3JlLCBjaGlsZFJlY29y
        ZCwga2V5KXsKICBpZiAob3B0aW9ucy5jaGFuZ2VUeXBlID09PSAiYWRkIiAm
        JiBzdG9yZS5yZWNvcmRJc01hdGVyaWFsaXplZChjaGlsZFJlY29yZCkpIHsK
        ICAgIHZhciBvbGRQYXJlbnQgPSBnZXQoY2hpbGRSZWNvcmQsIGtleSk7CiAg
        ICBpZiAob2xkUGFyZW50KXsKICAgICAgdmFyIGNvcnJlc3BvbmRpbmdDaGFu
        Z2UgPSBEUy5PbmVUb09uZUNoYW5nZS5jcmVhdGVDaGFuZ2UoY2hpbGRSZWNv
        cmQsIG9sZFBhcmVudCwgc3RvcmUsIHsKICAgICAgICAgIHBhcmVudFR5cGU6
        IG9wdGlvbnMucGFyZW50VHlwZSwKICAgICAgICAgIGhhc01hbnlOYW1lOiBv
        cHRpb25zLmhhc01hbnlOYW1lLAogICAgICAgICAgY2hhbmdlVHlwZTogInJl
        bW92ZSIsCiAgICAgICAgICBrZXk6IG9wdGlvbnMua2V5CiAgICAgICAgfSk7
        CiAgICAgIHN0b3JlLmFkZFJlbGF0aW9uc2hpcENoYW5nZUZvcihjaGlsZFJl
        Y29yZCwga2V5LCBvcHRpb25zLnBhcmVudFJlY29yZCAsIG51bGwsIGNvcnJl
        c3BvbmRpbmdDaGFuZ2UpOwogICAgIGNvcnJlc3BvbmRpbmdDaGFuZ2Uuc3lu
        YygpOwogICAgfQogIH0KfTsKCkRTLk9uZVRvTWFueUNoYW5nZS5jcmVhdGVD
        aGFuZ2UgPSBmdW5jdGlvbihjaGlsZFJlY29yZCwgcGFyZW50UmVjb3JkLCBz
        dG9yZSwgb3B0aW9ucykgewogIHZhciBrZXk7CgogIC8vIElmIHRoZSBuYW1l
        IG9mIHRoZSBiZWxvbmdzVG8gc2lkZSBvZiB0aGUgcmVsYXRpb25zaGlwIGlz
        IHNwZWNpZmllZCwKICAvLyB1c2UgdGhhdAogIC8vIElmIHRoZSB0eXBlIG9m
        IHRoZSBwYXJlbnQgaXMgc3BlY2lmaWVkLCBsb29rIGl0IHVwIG9uIHRoZSBj
        aGlsZCdzIHR5cGUKICAvLyBkZWZpbml0aW9uLgogIGlmIChvcHRpb25zLnBh
        cmVudFR5cGUpIHsKICAgIGtleSA9IG9wdGlvbnMucGFyZW50VHlwZS5pbnZl
        cnNlRm9yKG9wdGlvbnMua2V5KS5uYW1lOwogICAgRFMuT25lVG9NYW55Q2hh
        bmdlLm1haW50YWluSW52YXJpYW50KCBvcHRpb25zLCBzdG9yZSwgY2hpbGRS
        ZWNvcmQsIGtleSApOwogIH0gZWxzZSBpZiAob3B0aW9ucy5rZXkpIHsKICAg
        IGtleSA9IG9wdGlvbnMua2V5OwogIH0gZWxzZSB7CiAgICBFbWJlci5hc3Nl
        cnQoIllvdSBtdXN0IHBhc3MgZWl0aGVyIGEgcGFyZW50VHlwZSBvciBiZWxv
        bmdzVG9OYW1lIG9wdGlvbiB0byBPbmVUb01hbnlDaGFuZ2UuZm9yQ2hpbGRB
        bmRQYXJlbnQiLCBmYWxzZSk7CiAgfQoKICB2YXIgY2hhbmdlID0gRFMuUmVs
        YXRpb25zaGlwQ2hhbmdlLl9jcmVhdGVDaGFuZ2UoewogICAgICBwYXJlbnRS
        ZWNvcmQ6IHBhcmVudFJlY29yZCwKICAgICAgY2hpbGRSZWNvcmQ6IGNoaWxk
        UmVjb3JkLAogICAgICBmaXJzdFJlY29yZDogY2hpbGRSZWNvcmQsCiAgICAg
        IHNlY29uZFJlY29yZDogcGFyZW50UmVjb3JkLAogICAgICBmaXJzdFJlY29y
        ZEtpbmQ6ICJiZWxvbmdzVG8iLAogICAgICBzZWNvbmRSZWNvcmRLaW5kOiAi
        aGFzTWFueSIsCiAgICAgIHN0b3JlOiBzdG9yZSwKICAgICAgY2hhbmdlVHlw
        ZTogb3B0aW9ucy5jaGFuZ2VUeXBlLAogICAgICBmaXJzdFJlY29yZE5hbWU6
        ICBrZXkKICB9KTsKCiAgc3RvcmUuYWRkUmVsYXRpb25zaGlwQ2hhbmdlRm9y
        KGNoaWxkUmVjb3JkLCBrZXksIHBhcmVudFJlY29yZCwgY2hhbmdlLmdldFNl
        Y29uZFJlY29yZE5hbWUoKSwgY2hhbmdlKTsKCgogIHJldHVybiBjaGFuZ2U7
        Cn07CgoKRFMuT25lVG9NYW55Q2hhbmdlLm1haW50YWluSW52YXJpYW50ID0g
        ZnVuY3Rpb24ob3B0aW9ucywgc3RvcmUsIGNoaWxkUmVjb3JkLCBrZXkpewog
        IGlmIChvcHRpb25zLmNoYW5nZVR5cGUgPT09ICJhZGQiICYmIGNoaWxkUmVj
        b3JkKSB7CiAgICB2YXIgb2xkUGFyZW50ID0gZ2V0KGNoaWxkUmVjb3JkLCBr
        ZXkpOwogICAgaWYgKG9sZFBhcmVudCl7CiAgICAgIHZhciBjb3JyZXNwb25k
        aW5nQ2hhbmdlID0gRFMuT25lVG9NYW55Q2hhbmdlLmNyZWF0ZUNoYW5nZShj
        aGlsZFJlY29yZCwgb2xkUGFyZW50LCBzdG9yZSwgewogICAgICAgICAgcGFy
        ZW50VHlwZTogb3B0aW9ucy5wYXJlbnRUeXBlLAogICAgICAgICAgaGFzTWFu
        eU5hbWU6IG9wdGlvbnMuaGFzTWFueU5hbWUsCiAgICAgICAgICBjaGFuZ2VU
        eXBlOiAicmVtb3ZlIiwKICAgICAgICAgIGtleTogb3B0aW9ucy5rZXkKICAg
        ICAgICB9KTsKICAgICAgc3RvcmUuYWRkUmVsYXRpb25zaGlwQ2hhbmdlRm9y
        KGNoaWxkUmVjb3JkLCBrZXksIG9wdGlvbnMucGFyZW50UmVjb3JkLCBjb3Jy
        ZXNwb25kaW5nQ2hhbmdlLmdldFNlY29uZFJlY29yZE5hbWUoKSwgY29ycmVz
        cG9uZGluZ0NoYW5nZSk7CiAgICAgIGNvcnJlc3BvbmRpbmdDaGFuZ2Uuc3lu
        YygpOwogICAgfQogIH0KfTsKCi8qKgogIEBjbGFzcyBSZWxhdGlvbnNoaXBD
        aGFuZ2UKICBAbmFtZXNwYWNlIERTCiovCkRTLlJlbGF0aW9uc2hpcENoYW5n
        ZS5wcm90b3R5cGUgPSB7CgogIGdldFNlY29uZFJlY29yZE5hbWU6IGZ1bmN0
        aW9uKCkgewogICAgdmFyIG5hbWUgPSB0aGlzLnNlY29uZFJlY29yZE5hbWUs
        IHBhcmVudDsKCiAgICBpZiAoIW5hbWUpIHsKICAgICAgcGFyZW50ID0gdGhp
        cy5zZWNvbmRSZWNvcmQ7CiAgICAgIGlmICghcGFyZW50KSB7IHJldHVybjsg
        fQoKICAgICAgdmFyIGNoaWxkVHlwZSA9IHRoaXMuZmlyc3RSZWNvcmQuY29u
        c3RydWN0b3I7CiAgICAgIHZhciBpbnZlcnNlID0gY2hpbGRUeXBlLmludmVy
        c2VGb3IodGhpcy5maXJzdFJlY29yZE5hbWUpOwogICAgICB0aGlzLnNlY29u
        ZFJlY29yZE5hbWUgPSBpbnZlcnNlLm5hbWU7CiAgICB9CgogICAgcmV0dXJu
        IHRoaXMuc2Vjb25kUmVjb3JkTmFtZTsKICB9LAoKICAvKioKICAgIEdldCB0
        aGUgbmFtZSBvZiB0aGUgcmVsYXRpb25zaGlwIG9uIHRoZSBiZWxvbmdzVG8g
        c2lkZS4KCiAgICBAbWV0aG9kIGdldEZpcnN0UmVjb3JkTmFtZQogICAgQHJl
        dHVybiB7U3RyaW5nfQogICovCiAgZ2V0Rmlyc3RSZWNvcmROYW1lOiBmdW5j
        dGlvbigpIHsKICAgIHZhciBuYW1lID0gdGhpcy5maXJzdFJlY29yZE5hbWU7
        CiAgICByZXR1cm4gbmFtZTsKICB9LAoKICAvKioKICAgIEBtZXRob2QgZGVz
        dHJveQogICAgQHByaXZhdGUKICAqLwogIGRlc3Ryb3k6IGZ1bmN0aW9uKCkg
        ewogICAgdmFyIGNoaWxkUmVjb3JkID0gdGhpcy5jaGlsZFJlY29yZCwKICAg
        ICAgICBiZWxvbmdzVG9OYW1lID0gdGhpcy5nZXRGaXJzdFJlY29yZE5hbWUo
        KSwKICAgICAgICBoYXNNYW55TmFtZSA9IHRoaXMuZ2V0U2Vjb25kUmVjb3Jk
        TmFtZSgpLAogICAgICAgIHN0b3JlID0gdGhpcy5zdG9yZTsKCiAgICBzdG9y
        ZS5yZW1vdmVSZWxhdGlvbnNoaXBDaGFuZ2VGb3IoY2hpbGRSZWNvcmQsIGJl
        bG9uZ3NUb05hbWUsIHRoaXMucGFyZW50UmVjb3JkLCBoYXNNYW55TmFtZSwg
        dGhpcy5jaGFuZ2VUeXBlKTsKICB9LAoKICBnZXRTZWNvbmRSZWNvcmQ6IGZ1
        bmN0aW9uKCl7CiAgICByZXR1cm4gdGhpcy5zZWNvbmRSZWNvcmQ7CiAgfSwK
        CiAgLyoqCiAgICBAbWV0aG9kIGdldEZpcnN0UmVjb3JkCiAgICBAcHJpdmF0
        ZQogICovCiAgZ2V0Rmlyc3RSZWNvcmQ6IGZ1bmN0aW9uKCkgewogICAgcmV0
        dXJuIHRoaXMuZmlyc3RSZWNvcmQ7CiAgfSwKCiAgY29hbGVzY2U6IGZ1bmN0
        aW9uKCl7CiAgICB2YXIgcmVsYXRpb25zaGlwUGFpcnMgPSB0aGlzLnN0b3Jl
        LnJlbGF0aW9uc2hpcENoYW5nZVBhaXJzRm9yKHRoaXMuZmlyc3RSZWNvcmQp
        OwogICAgZm9yRWFjaChyZWxhdGlvbnNoaXBQYWlycywgZnVuY3Rpb24ocGFp
        cil7CiAgICAgIHZhciBhZGRlZENoYW5nZSA9IHBhaXJbImFkZCJdOwogICAg
        ICB2YXIgcmVtb3ZlZENoYW5nZSA9IHBhaXJbInJlbW92ZSJdOwogICAgICBp
        ZihhZGRlZENoYW5nZSAmJiByZW1vdmVkQ2hhbmdlKSB7CiAgICAgICAgYWRk
        ZWRDaGFuZ2UuZGVzdHJveSgpOwogICAgICAgIHJlbW92ZWRDaGFuZ2UuZGVz
        dHJveSgpOwogICAgICB9CiAgICB9KTsKICB9Cn07CgpEUy5SZWxhdGlvbnNo
        aXBDaGFuZ2VBZGQucHJvdG90eXBlID0gRW1iZXIuY3JlYXRlKERTLlJlbGF0
        aW9uc2hpcENoYW5nZS5jcmVhdGUoe30pKTsKRFMuUmVsYXRpb25zaGlwQ2hh
        bmdlUmVtb3ZlLnByb3RvdHlwZSA9IEVtYmVyLmNyZWF0ZShEUy5SZWxhdGlv
        bnNoaXBDaGFuZ2UuY3JlYXRlKHt9KSk7CgovLyB0aGUgb2JqZWN0IGlzIGEg
        dmFsdWUsIGFuZCBub3QgYSBwcm9taXNlCmZ1bmN0aW9uIGlzVmFsdWUob2Jq
        ZWN0KSB7CiAgcmV0dXJuIHR5cGVvZiBvYmplY3QgPT09ICdvYmplY3QnICYm
        ICghb2JqZWN0LnRoZW4gfHwgdHlwZW9mIG9iamVjdC50aGVuICE9PSAnZnVu
        Y3Rpb24nKTsKfQoKRFMuUmVsYXRpb25zaGlwQ2hhbmdlQWRkLnByb3RvdHlw
        ZS5jaGFuZ2VUeXBlID0gImFkZCI7CkRTLlJlbGF0aW9uc2hpcENoYW5nZUFk
        ZC5wcm90b3R5cGUuc3luYyA9IGZ1bmN0aW9uKCkgewogIHZhciBzZWNvbmRS
        ZWNvcmROYW1lID0gdGhpcy5nZXRTZWNvbmRSZWNvcmROYW1lKCksCiAgICAg
        IGZpcnN0UmVjb3JkTmFtZSA9IHRoaXMuZ2V0Rmlyc3RSZWNvcmROYW1lKCks
        CiAgICAgIGZpcnN0UmVjb3JkID0gdGhpcy5nZXRGaXJzdFJlY29yZCgpLAog
        ICAgICBzZWNvbmRSZWNvcmQgPSB0aGlzLmdldFNlY29uZFJlY29yZCgpOwoK
        ICAvL0VtYmVyLmFzc2VydCgiWW91IHNwZWNpZmllZCBhIGhhc01hbnkgKCIg
        KyBoYXNNYW55TmFtZSArICIpIG9uICIgKyAoIWJlbG9uZ3NUb05hbWUgJiYg
        KG5ld1BhcmVudCB8fCBvbGRQYXJlbnQgfHwgdGhpcy5sYXN0UGFyZW50KS5j
        b25zdHJ1Y3RvcikgKyAiIGJ1dCBkaWQgbm90IHNwZWNpZnkgYW4gaW52ZXJz
        ZSBiZWxvbmdzVG8gb24gIiArIGNoaWxkLmNvbnN0cnVjdG9yLCBiZWxvbmdz
        VG9OYW1lKTsKICAvL0VtYmVyLmFzc2VydCgiWW91IHNwZWNpZmllZCBhIGJl
        bG9uZ3NUbyAoIiArIGJlbG9uZ3NUb05hbWUgKyAiKSBvbiAiICsgY2hpbGQu
        Y29uc3RydWN0b3IgKyAiIGJ1dCBkaWQgbm90IHNwZWNpZnkgYW4gaW52ZXJz
        ZSBoYXNNYW55IG9uICIgKyAoIWhhc01hbnlOYW1lICYmIChuZXdQYXJlbnQg
        fHwgb2xkUGFyZW50IHx8IHRoaXMubGFzdFBhcmVudFJlY29yZCkuY29uc3Ry
        dWN0b3IpLCBoYXNNYW55TmFtZSk7CgogIGlmIChzZWNvbmRSZWNvcmQgaW5z
        dGFuY2VvZiBEUy5Nb2RlbCAmJiBmaXJzdFJlY29yZCBpbnN0YW5jZW9mIERT
        Lk1vZGVsKSB7CiAgICBpZih0aGlzLnNlY29uZFJlY29yZEtpbmQgPT09ICJi
        ZWxvbmdzVG8iKXsKICAgICAgc2Vjb25kUmVjb3JkLnN1c3BlbmRSZWxhdGlv
        bnNoaXBPYnNlcnZlcnMoZnVuY3Rpb24oKXsKICAgICAgICBzZXQoc2Vjb25k
        UmVjb3JkLCBzZWNvbmRSZWNvcmROYW1lLCBmaXJzdFJlY29yZCk7CiAgICAg
        IH0pOwoKICAgICB9CiAgICAgZWxzZSBpZih0aGlzLnNlY29uZFJlY29yZEtp
        bmQgPT09ICJoYXNNYW55Iil7CiAgICAgIHNlY29uZFJlY29yZC5zdXNwZW5k
        UmVsYXRpb25zaGlwT2JzZXJ2ZXJzKGZ1bmN0aW9uKCl7CiAgICAgICAgdmFy
        IHJlbGF0aW9uc2hpcCA9IGdldChzZWNvbmRSZWNvcmQsIHNlY29uZFJlY29y
        ZE5hbWUpOwogICAgICAgIGlmIChpc1ZhbHVlKHJlbGF0aW9uc2hpcCkpIHsg
        cmVsYXRpb25zaGlwLmFkZE9iamVjdChmaXJzdFJlY29yZCk7IH0KICAgICAg
        fSk7CiAgICB9CiAgfQoKICBpZiAoZmlyc3RSZWNvcmQgaW5zdGFuY2VvZiBE
        Uy5Nb2RlbCAmJiBzZWNvbmRSZWNvcmQgaW5zdGFuY2VvZiBEUy5Nb2RlbCAm
        JiBnZXQoZmlyc3RSZWNvcmQsIGZpcnN0UmVjb3JkTmFtZSkgIT09IHNlY29u
        ZFJlY29yZCkgewogICAgaWYodGhpcy5maXJzdFJlY29yZEtpbmQgPT09ICJi
        ZWxvbmdzVG8iKXsKICAgICAgZmlyc3RSZWNvcmQuc3VzcGVuZFJlbGF0aW9u
        c2hpcE9ic2VydmVycyhmdW5jdGlvbigpewogICAgICAgIHNldChmaXJzdFJl
        Y29yZCwgZmlyc3RSZWNvcmROYW1lLCBzZWNvbmRSZWNvcmQpOwogICAgICB9
        KTsKICAgIH0KICAgIGVsc2UgaWYodGhpcy5maXJzdFJlY29yZEtpbmQgPT09
        ICJoYXNNYW55Iil7CiAgICAgIGZpcnN0UmVjb3JkLnN1c3BlbmRSZWxhdGlv
        bnNoaXBPYnNlcnZlcnMoZnVuY3Rpb24oKXsKICAgICAgICB2YXIgcmVsYXRp
        b25zaGlwID0gZ2V0KGZpcnN0UmVjb3JkLCBmaXJzdFJlY29yZE5hbWUpOwog
        ICAgICAgIGlmIChpc1ZhbHVlKHJlbGF0aW9uc2hpcCkpIHsgcmVsYXRpb25z
        aGlwLmFkZE9iamVjdChzZWNvbmRSZWNvcmQpOyB9CiAgICAgIH0pOwogICAg
        fQogIH0KCiAgdGhpcy5jb2FsZXNjZSgpOwp9OwoKRFMuUmVsYXRpb25zaGlw
        Q2hhbmdlUmVtb3ZlLnByb3RvdHlwZS5jaGFuZ2VUeXBlID0gInJlbW92ZSI7
        CkRTLlJlbGF0aW9uc2hpcENoYW5nZVJlbW92ZS5wcm90b3R5cGUuc3luYyA9
        IGZ1bmN0aW9uKCkgewogIHZhciBzZWNvbmRSZWNvcmROYW1lID0gdGhpcy5n
        ZXRTZWNvbmRSZWNvcmROYW1lKCksCiAgICAgIGZpcnN0UmVjb3JkTmFtZSA9
        IHRoaXMuZ2V0Rmlyc3RSZWNvcmROYW1lKCksCiAgICAgIGZpcnN0UmVjb3Jk
        ID0gdGhpcy5nZXRGaXJzdFJlY29yZCgpLAogICAgICBzZWNvbmRSZWNvcmQg
        PSB0aGlzLmdldFNlY29uZFJlY29yZCgpOwoKICAvL0VtYmVyLmFzc2VydCgi
        WW91IHNwZWNpZmllZCBhIGhhc01hbnkgKCIgKyBoYXNNYW55TmFtZSArICIp
        IG9uICIgKyAoIWJlbG9uZ3NUb05hbWUgJiYgKG5ld1BhcmVudCB8fCBvbGRQ
        YXJlbnQgfHwgdGhpcy5sYXN0UGFyZW50KS5jb25zdHJ1Y3RvcikgKyAiIGJ1
        dCBkaWQgbm90IHNwZWNpZnkgYW4gaW52ZXJzZSBiZWxvbmdzVG8gb24gIiAr
        IGNoaWxkLmNvbnN0cnVjdG9yLCBiZWxvbmdzVG9OYW1lKTsKICAvL0VtYmVy
        LmFzc2VydCgiWW91IHNwZWNpZmllZCBhIGJlbG9uZ3NUbyAoIiArIGJlbG9u
        Z3NUb05hbWUgKyAiKSBvbiAiICsgY2hpbGQuY29uc3RydWN0b3IgKyAiIGJ1
        dCBkaWQgbm90IHNwZWNpZnkgYW4gaW52ZXJzZSBoYXNNYW55IG9uICIgKyAo
        IWhhc01hbnlOYW1lICYmIChuZXdQYXJlbnQgfHwgb2xkUGFyZW50IHx8IHRo
        aXMubGFzdFBhcmVudFJlY29yZCkuY29uc3RydWN0b3IpLCBoYXNNYW55TmFt
        ZSk7CgogIGlmIChzZWNvbmRSZWNvcmQgaW5zdGFuY2VvZiBEUy5Nb2RlbCAm
        JiBmaXJzdFJlY29yZCBpbnN0YW5jZW9mIERTLk1vZGVsKSB7CiAgICBpZih0
        aGlzLnNlY29uZFJlY29yZEtpbmQgPT09ICJiZWxvbmdzVG8iKXsKICAgICAg
        c2Vjb25kUmVjb3JkLnN1c3BlbmRSZWxhdGlvbnNoaXBPYnNlcnZlcnMoZnVu
        Y3Rpb24oKXsKICAgICAgICBzZXQoc2Vjb25kUmVjb3JkLCBzZWNvbmRSZWNv
        cmROYW1lLCBudWxsKTsKICAgICAgfSk7CiAgICB9CiAgICBlbHNlIGlmKHRo
        aXMuc2Vjb25kUmVjb3JkS2luZCA9PT0gImhhc01hbnkiKXsKICAgICAgc2Vj
        b25kUmVjb3JkLnN1c3BlbmRSZWxhdGlvbnNoaXBPYnNlcnZlcnMoZnVuY3Rp
        b24oKXsKICAgICAgICB2YXIgcmVsYXRpb25zaGlwID0gZ2V0KHNlY29uZFJl
        Y29yZCwgc2Vjb25kUmVjb3JkTmFtZSk7CiAgICAgICAgaWYgKGlzVmFsdWUo
        cmVsYXRpb25zaGlwKSkgeyByZWxhdGlvbnNoaXAucmVtb3ZlT2JqZWN0KGZp
        cnN0UmVjb3JkKTsgfQogICAgICB9KTsKICAgIH0KICB9CgogIGlmIChmaXJz
        dFJlY29yZCBpbnN0YW5jZW9mIERTLk1vZGVsICYmIGdldChmaXJzdFJlY29y
        ZCwgZmlyc3RSZWNvcmROYW1lKSkgewogICAgaWYodGhpcy5maXJzdFJlY29y
        ZEtpbmQgPT09ICJiZWxvbmdzVG8iKXsKICAgICAgZmlyc3RSZWNvcmQuc3Vz
        cGVuZFJlbGF0aW9uc2hpcE9ic2VydmVycyhmdW5jdGlvbigpewogICAgICAg
        IHNldChmaXJzdFJlY29yZCwgZmlyc3RSZWNvcmROYW1lLCBudWxsKTsKICAg
        ICAgfSk7CiAgICAgfQogICAgIGVsc2UgaWYodGhpcy5maXJzdFJlY29yZEtp
        bmQgPT09ICJoYXNNYW55Iil7CiAgICAgICBmaXJzdFJlY29yZC5zdXNwZW5k
        UmVsYXRpb25zaGlwT2JzZXJ2ZXJzKGZ1bmN0aW9uKCl7CiAgICAgICAgIHZh
        ciByZWxhdGlvbnNoaXAgPSBnZXQoZmlyc3RSZWNvcmQsIGZpcnN0UmVjb3Jk
        TmFtZSk7CiAgICAgICAgIGlmIChpc1ZhbHVlKHJlbGF0aW9uc2hpcCkpIHsg
        cmVsYXRpb25zaGlwLnJlbW92ZU9iamVjdChzZWNvbmRSZWNvcmQpOyB9CiAg
        ICAgIH0pOwogICAgfQogIH0KCiAgdGhpcy5jb2FsZXNjZSgpOwp9OwoKfSko
        KTsKCgoKKGZ1bmN0aW9uKCkgewovKioKICBAbW9kdWxlIGVtYmVyLWRhdGEK
        Ki8KCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKdmFyIGdldCA9IEVtYmVyLmdl
        dCwgc2V0ID0gRW1iZXIuc2V0LAogICAgaXNOb25lID0gRW1iZXIuaXNOb25l
        OwoKLyoqCiAgQG1vZHVsZSBlbWJlci1kYXRhCiovCgpmdW5jdGlvbiBhc3lu
        Y0JlbG9uZ3NUbyh0eXBlLCBvcHRpb25zLCBtZXRhKSB7CiAgcmV0dXJuIEVt
        YmVyLmNvbXB1dGVkKGZ1bmN0aW9uKGtleSwgdmFsdWUpIHsKICAgIHZhciBk
        YXRhID0gZ2V0KHRoaXMsICdkYXRhJyksCiAgICAgICAgc3RvcmUgPSBnZXQo
        dGhpcywgJ3N0b3JlJyk7CgogICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09
        IDIpIHsKICAgICAgRW1iZXIuYXNzZXJ0KCJZb3UgY2FuIG9ubHkgYWRkIGEg
        JyIgKyB0eXBlICsgIicgcmVjb3JkIHRvIHRoaXMgcmVsYXRpb25zaGlwIiwg
        IXZhbHVlIHx8IHN0b3JlLm1vZGVsRm9yKHR5cGUpLmRldGVjdEluc3RhbmNl
        KHZhbHVlKSk7CiAgICAgIHJldHVybiB2YWx1ZSA9PT0gdW5kZWZpbmVkID8g
        bnVsbCA6IHZhbHVlOwogICAgfQoKICAgIHJldHVybiBzdG9yZS5mZXRjaFJl
        Y29yZChkYXRhW2tleV0pOwogIH0pLnByb3BlcnR5KCdkYXRhJykubWV0YSht
        ZXRhKTsKfQoKRFMuYmVsb25nc1RvID0gZnVuY3Rpb24odHlwZSwgb3B0aW9u
        cykgewogIEVtYmVyLmFzc2VydCgiVGhlIGZpcnN0IGFyZ3VtZW50IERTLmJl
        bG9uZ3NUbyBtdXN0IGJlIGEgbW9kZWwgdHlwZSBvciBzdHJpbmcsIGxpa2Ug
        RFMuYmVsb25nc1RvKEFwcC5QZXJzb24pIiwgISF0eXBlICYmICh0eXBlb2Yg
        dHlwZSA9PT0gJ3N0cmluZycgfHwgRFMuTW9kZWwuZGV0ZWN0KHR5cGUpKSk7
        CgogIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9OwoKICB2YXIgbWV0YSA9IHsg
        dHlwZTogdHlwZSwgaXNSZWxhdGlvbnNoaXA6IHRydWUsIG9wdGlvbnM6IG9w
        dGlvbnMsIGtpbmQ6ICdiZWxvbmdzVG8nIH07CgogIGlmIChvcHRpb25zLmFz
        eW5jKSB7CiAgICByZXR1cm4gYXN5bmNCZWxvbmdzVG8odHlwZSwgb3B0aW9u
        cywgbWV0YSk7CiAgfQoKICByZXR1cm4gRW1iZXIuY29tcHV0ZWQoZnVuY3Rp
        b24oa2V5LCB2YWx1ZSkgewogICAgdmFyIGRhdGEgPSBnZXQodGhpcywgJ2Rh
        dGEnKSwKICAgICAgICBzdG9yZSA9IGdldCh0aGlzLCAnc3RvcmUnKSwgYmVs
        b25nc1RvLCB0eXBlQ2xhc3M7CgogICAgaWYgKHR5cGVvZiB0eXBlID09PSAn
        c3RyaW5nJykgewogICAgICBpZiAodHlwZS5pbmRleE9mKCIuIikgPT09IC0x
        KSB7CiAgICAgICAgdHlwZUNsYXNzID0gc3RvcmUubW9kZWxGb3IodHlwZSk7
        CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdHlwZUNsYXNzID0gZ2V0KEVtYmVy
        Lmxvb2t1cCwgdHlwZSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHR5
        cGVDbGFzcyA9IHR5cGU7CiAgICB9CgogICAgaWYgKGFyZ3VtZW50cy5sZW5n
        dGggPT09IDIpIHsKICAgICAgRW1iZXIuYXNzZXJ0KCJZb3UgY2FuIG9ubHkg
        YWRkIGEgJyIgKyB0eXBlICsgIicgcmVjb3JkIHRvIHRoaXMgcmVsYXRpb25z
        aGlwIiwgIXZhbHVlIHx8IHR5cGVDbGFzcy5kZXRlY3RJbnN0YW5jZSh2YWx1
        ZSkpOwogICAgICByZXR1cm4gdmFsdWUgPT09IHVuZGVmaW5lZCA/IG51bGwg
        OiB2YWx1ZTsKICAgIH0KCiAgICBiZWxvbmdzVG8gPSBkYXRhW2tleV07Cgog
        ICAgaWYgKGlzTm9uZShiZWxvbmdzVG8pKSB7IHJldHVybiBudWxsOyB9Cgog
        ICAgaWYgKGdldChiZWxvbmdzVG8sICdpc0VtcHR5JykpIHsKICAgICAgc3Rv
        cmUuZmV0Y2hSZWNvcmQoYmVsb25nc1RvKTsKICAgIH0KCiAgICByZXR1cm4g
        YmVsb25nc1RvOwogIH0pLnByb3BlcnR5KCdkYXRhJykubWV0YShtZXRhKTsK
        fTsKCi8qCiAgVGhlc2Ugb2JzZXJ2ZXJzIG9ic2VydmUgYWxsIGBiZWxvbmdz
        VG9gIHJlbGF0aW9uc2hpcHMgb24gdGhlIHJlY29yZC4gU2VlCiAgYHJlbGF0
        aW9uc2hpcHMvZXh0YCB0byBzZWUgaG93IHRoZXNlIG9ic2VydmVycyBnZXQg
        dGhlaXIgZGVwZW5kZW5jaWVzLgoKICBAY2xhc3MgTW9kZWwKICBAbmFtZXNw
        YWNlIERTCiovCkRTLk1vZGVsLnJlb3Blbih7CgogIC8qKgogICAgQG1ldGhv
        ZCBiZWxvbmdzVG9XaWxsQ2hhbmdlCiAgICBAcHJpdmF0ZQogICAgQHN0YXRp
        YwogICAgQHBhcmFtIHJlY29yZAogICAgQHBhcmFtIGtleQogICovCiAgYmVs
        b25nc1RvV2lsbENoYW5nZTogRW1iZXIuYmVmb3JlT2JzZXJ2ZXIoZnVuY3Rp
        b24ocmVjb3JkLCBrZXkpIHsKICAgIGlmIChnZXQocmVjb3JkLCAnaXNMb2Fk
        ZWQnKSkgewogICAgICB2YXIgb2xkUGFyZW50ID0gZ2V0KHJlY29yZCwga2V5
        KSwKICAgICAgICAgIHN0b3JlID0gZ2V0KHJlY29yZCwgJ3N0b3JlJyk7Cgog
        ICAgICBpZiAob2xkUGFyZW50KXsKICAgICAgICB2YXIgY2hhbmdlID0gRFMu
        UmVsYXRpb25zaGlwQ2hhbmdlLmNyZWF0ZUNoYW5nZShyZWNvcmQsIG9sZFBh
        cmVudCwgc3RvcmUsIHsga2V5OiBrZXksIGtpbmQ6ICJiZWxvbmdzVG8iLCBj
        aGFuZ2VUeXBlOiAicmVtb3ZlIiB9KTsKICAgICAgICBjaGFuZ2Uuc3luYygp
        OwogICAgICAgIHRoaXMuX2NoYW5nZXNUb1N5bmNba2V5XSA9IGNoYW5nZTsK
        ICAgICAgfQogICAgfQogIH0pLAoKICAvKioKICAgIEBtZXRob2QgYmVsb25n
        c1RvRGlkQ2hhbmdlCiAgICBAcHJpdmF0ZQogICAgQHN0YXRpYwogICAgQHBh
        cmFtIHJlY29yZAogICAgQHBhcmFtIGtleQogICovCiAgYmVsb25nc1RvRGlk
        Q2hhbmdlOiBFbWJlci5pbW1lZGlhdGVPYnNlcnZlcihmdW5jdGlvbihyZWNv
        cmQsIGtleSkgewogICAgaWYgKGdldChyZWNvcmQsICdpc0xvYWRlZCcpKSB7
        CiAgICAgIHZhciBuZXdQYXJlbnQgPSBnZXQocmVjb3JkLCBrZXkpOwogICAg
        ICBpZihuZXdQYXJlbnQpewogICAgICAgIHZhciBzdG9yZSA9IGdldChyZWNv
        cmQsICdzdG9yZScpLAogICAgICAgICAgICBjaGFuZ2UgPSBEUy5SZWxhdGlv
        bnNoaXBDaGFuZ2UuY3JlYXRlQ2hhbmdlKHJlY29yZCwgbmV3UGFyZW50LCBz
        dG9yZSwgeyBrZXk6IGtleSwga2luZDogImJlbG9uZ3NUbyIsIGNoYW5nZVR5
        cGU6ICJhZGQiIH0pOwoKICAgICAgICBjaGFuZ2Uuc3luYygpOwogICAgICB9
        CiAgICB9CgogICAgZGVsZXRlIHRoaXMuX2NoYW5nZXNUb1N5bmNba2V5XTsK
        ICB9KQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCiAgQG1vZHVs
        ZSBlbWJlci1kYXRhCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBF
        bWJlci5zZXQsIHNldFByb3BlcnRpZXMgPSBFbWJlci5zZXRQcm9wZXJ0aWVz
        Owp2YXIgZm9yRWFjaCA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5mb3JFYWNo
        OwoKZnVuY3Rpb24gYXN5bmNIYXNNYW55KHR5cGUsIG9wdGlvbnMsIG1ldGEp
        IHsKICByZXR1cm4gRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oa2V5LCB2YWx1
        ZSkgewogICAgdmFyIHJlc29sdmVyID0gRW1iZXIuUlNWUC5kZWZlcigpOwoK
        ICAgIHZhciByZWxhdGlvbnNoaXAgPSBidWlsZFJlbGF0aW9uc2hpcCh0aGlz
        LCBrZXksIG9wdGlvbnMsIGZ1bmN0aW9uKHN0b3JlLCBkYXRhKSB7CiAgICAg
        IHZhciBsaW5rID0gZGF0YS5saW5rcyAmJiBkYXRhLmxpbmtzW2tleV07Cgog
        ICAgICBpZiAobGluaykgewogICAgICAgIHJldHVybiBzdG9yZS5maW5kSGFz
        TWFueSh0aGlzLCBsaW5rLCBtZXRhLCByZXNvbHZlcik7CiAgICAgIH0gZWxz
        ZSB7CiAgICAgICAgcmV0dXJuIHN0b3JlLmZpbmRNYW55KHRoaXMsIGRhdGFb
        a2V5XSwgbWV0YS50eXBlLCByZXNvbHZlcik7CiAgICAgIH0KICAgIH0pOwoK
        ICAgIHZhciBwcm9taXNlID0gcmVzb2x2ZXIucHJvbWlzZS50aGVuKGZ1bmN0
        aW9uKCkgewogICAgICByZXR1cm4gcmVsYXRpb25zaGlwOwogICAgfSk7Cgog
        ICAgcmV0dXJuIERTLlByb21pc2VBcnJheS5jcmVhdGUoeyBwcm9taXNlOiBw
        cm9taXNlIH0pOwogIH0pLnByb3BlcnR5KCdkYXRhJykubWV0YShtZXRhKTsK
        fQoKZnVuY3Rpb24gYnVpbGRSZWxhdGlvbnNoaXAocmVjb3JkLCBrZXksIG9w
        dGlvbnMsIGNhbGxiYWNrKSB7CiAgdmFyIHJlbHMgPSByZWNvcmQuX3JlbGF0
        aW9uc2hpcHM7CgogIGlmIChyZWxzW2tleV0pIHsgcmV0dXJuIHJlbHNba2V5
        XTsgfQoKICB2YXIgZGF0YSA9IGdldChyZWNvcmQsICdkYXRhJyksCiAgICAg
        IHN0b3JlID0gZ2V0KHJlY29yZCwgJ3N0b3JlJyk7CgogIHZhciByZWxhdGlv
        bnNoaXAgPSByZWxzW2tleV0gPSBjYWxsYmFjay5jYWxsKHJlY29yZCwgc3Rv
        cmUsIGRhdGEpOwoKICByZXR1cm4gc2V0UHJvcGVydGllcyhyZWxhdGlvbnNo
        aXAsIHsKICAgIG93bmVyOiByZWNvcmQsIG5hbWU6IGtleSwgaXNQb2x5bW9y
        cGhpYzogb3B0aW9ucy5wb2x5bW9ycGhpYwogIH0pOwp9CgpmdW5jdGlvbiBo
        YXNSZWxhdGlvbnNoaXAodHlwZSwgb3B0aW9ucykgewogIG9wdGlvbnMgPSBv
        cHRpb25zIHx8IHt9OwoKICB2YXIgbWV0YSA9IHsgdHlwZTogdHlwZSwgaXNS
        ZWxhdGlvbnNoaXA6IHRydWUsIG9wdGlvbnM6IG9wdGlvbnMsIGtpbmQ6ICdo
        YXNNYW55JyB9OwoKICBpZiAob3B0aW9ucy5hc3luYykgewogICAgcmV0dXJu
        IGFzeW5jSGFzTWFueSh0eXBlLCBvcHRpb25zLCBtZXRhKTsKICB9CgogIHJl
        dHVybiBFbWJlci5jb21wdXRlZChmdW5jdGlvbihrZXksIHZhbHVlKSB7CiAg
        ICByZXR1cm4gYnVpbGRSZWxhdGlvbnNoaXAodGhpcywga2V5LCBvcHRpb25z
        LCBmdW5jdGlvbihzdG9yZSwgZGF0YSkgewogICAgICB2YXIgcmVjb3JkcyA9
        IGRhdGFba2V5XTsKICAgICAgRW1iZXIuYXNzZXJ0KCJZb3UgbG9va2VkIHVw
        IHRoZSAnIiArIGtleSArICInIHJlbGF0aW9uc2hpcCBvbiAnIiArIHRoaXMg
        KyAiJyBidXQgc29tZSBvZiB0aGUgYXNzb2NpYXRlZCByZWNvcmRzIHdlcmUg
        bm90IGxvYWRlZC4gRWl0aGVyIG1ha2Ugc3VyZSB0aGV5IGFyZSBhbGwgbG9h
        ZGVkIHRvZ2V0aGVyIHdpdGggdGhlIHBhcmVudCByZWNvcmQsIG9yIHNwZWNp
        ZnkgdGhhdCB0aGUgcmVsYXRpb25zaGlwIGlzIGFzeW5jIChgRFMuYXR0cih7
        IGFzeW5jOiB0cnVlIH0pYCkiLCBFbWJlci5BKHJlY29yZHMpLmV2ZXJ5UHJv
        cGVydHkoJ2lzRW1wdHknLCBmYWxzZSkpOwogICAgICByZXR1cm4gc3RvcmUu
        ZmluZE1hbnkodGhpcywgZGF0YVtrZXldLCBtZXRhLnR5cGUpOwogICAgfSk7
        CiAgfSkucHJvcGVydHkoJ2RhdGEnKS5tZXRhKG1ldGEpOwp9CgpEUy5oYXNN
        YW55ID0gZnVuY3Rpb24odHlwZSwgb3B0aW9ucykgewogIEVtYmVyLmFzc2Vy
        dCgiVGhlIHR5cGUgcGFzc2VkIHRvIERTLmhhc01hbnkgbXVzdCBiZSBkZWZp
        bmVkIiwgISF0eXBlKTsKICByZXR1cm4gaGFzUmVsYXRpb25zaGlwKHR5cGUs
        IG9wdGlvbnMpOwp9OwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewp2YXIgZ2V0
        ID0gRW1iZXIuZ2V0LCBzZXQgPSBFbWJlci5zZXQ7CgovKioKICBAbW9kdWxl
        IGVtYmVyLWRhdGEKKi8KCi8qCiAgVGhpcyBmaWxlIGRlZmluZXMgc2V2ZXJh
        bCBleHRlbnNpb25zIHRvIHRoZSBiYXNlIGBEUy5Nb2RlbGAgY2xhc3MgdGhh
        dAogIGFkZCBzdXBwb3J0IGZvciBvbmUtdG8tbWFueSByZWxhdGlvbnNoaXBz
        LgoqLwoKLyoqCiAgQGNsYXNzIE1vZGVsCiAgQG5hbWVzcGFjZSBEUwoqLwpE
        Uy5Nb2RlbC5yZW9wZW4oewoKICAvKioKICAgIFRoaXMgRW1iZXIuanMgaG9v
        ayBhbGxvd3MgYW4gb2JqZWN0IHRvIGJlIG5vdGlmaWVkIHdoZW4gYSBwcm9w
        ZXJ0eQogICAgaXMgZGVmaW5lZC4KCiAgICBJbiB0aGlzIGNhc2UsIHdlIHVz
        ZSBpdCB0byBiZSBub3RpZmllZCB3aGVuIGFuIEVtYmVyIERhdGEgdXNlciBk
        ZWZpbmVzIGEKICAgIGJlbG9uZ3MtdG8gcmVsYXRpb25zaGlwLiBJbiB0aGF0
        IGNhc2UsIHdlIG5lZWQgdG8gc2V0IHVwIG9ic2VydmVycyBmb3IKICAgIGVh
        Y2ggb25lLCBhbGxvd2luZyB1cyB0byB0cmFjayByZWxhdGlvbnNoaXAgY2hh
        bmdlcyBhbmQgYXV0b21hdGljYWxseQogICAgcmVmbGVjdCBjaGFuZ2VzIGlu
        IHRoZSBpbnZlcnNlIGhhcy1tYW55IGFycmF5LgoKICAgIFRoaXMgaG9vayBw
        YXNzZXMgdGhlIGNsYXNzIGJlaW5nIHNldCB1cCwgYXMgd2VsbCBhcyB0aGUg
        a2V5IGFuZCB2YWx1ZQogICAgYmVpbmcgZGVmaW5lZC4gU28sIGZvciBleGFt
        cGxlLCB3aGVuIHRoZSB1c2VyIGRvZXMgdGhpczoKCiAgICAgIERTLk1vZGVs
        LmV4dGVuZCh7CiAgICAgICAgcGFyZW50OiBEUy5iZWxvbmdzVG8oQXBwLlVz
        ZXIpCiAgICAgIH0pOwoKICAgIFRoaXMgaG9vayB3b3VsZCBiZSBjYWxsZWQg
        d2l0aCAicGFyZW50IiBhcyB0aGUga2V5IGFuZCB0aGUgY29tcHV0ZWQKICAg
        IHByb3BlcnR5IHJldHVybmVkIGJ5IGBEUy5iZWxvbmdzVG9gIGFzIHRoZSB2
        YWx1ZS4KCiAgICBAbWV0aG9kIGRpZERlZmluZVByb3BlcnR5CiAgICBAcGFy
        YW0gcHJvdG8KICAgIEBwYXJhbSBrZXkKICAgIEBwYXJhbSB2YWx1ZQogICov
        CiAgZGlkRGVmaW5lUHJvcGVydHk6IGZ1bmN0aW9uKHByb3RvLCBrZXksIHZh
        bHVlKSB7CiAgICAvLyBDaGVjayBpZiB0aGUgdmFsdWUgYmVpbmcgc2V0IGlz
        IGEgY29tcHV0ZWQgcHJvcGVydHkuCiAgICBpZiAodmFsdWUgaW5zdGFuY2Vv
        ZiBFbWJlci5EZXNjcmlwdG9yKSB7CgogICAgICAvLyBJZiBpdCBpcywgZ2V0
        IHRoZSBtZXRhZGF0YSBmb3IgdGhlIHJlbGF0aW9uc2hpcC4gVGhpcyBpcwog
        ICAgICAvLyBwb3B1bGF0ZWQgYnkgdGhlIGBEUy5iZWxvbmdzVG9gIGhlbHBl
        ciB3aGVuIGl0IGlzIGNyZWF0aW5nCiAgICAgIC8vIHRoZSBjb21wdXRlZCBw
        cm9wZXJ0eS4KICAgICAgdmFyIG1ldGEgPSB2YWx1ZS5tZXRhKCk7CgogICAg
        ICBpZiAobWV0YS5pc1JlbGF0aW9uc2hpcCAmJiBtZXRhLmtpbmQgPT09ICdi
        ZWxvbmdzVG8nKSB7CiAgICAgICAgRW1iZXIuYWRkT2JzZXJ2ZXIocHJvdG8s
        IGtleSwgbnVsbCwgJ2JlbG9uZ3NUb0RpZENoYW5nZScpOwogICAgICAgIEVt
        YmVyLmFkZEJlZm9yZU9ic2VydmVyKHByb3RvLCBrZXksIG51bGwsICdiZWxv
        bmdzVG9XaWxsQ2hhbmdlJyk7CiAgICAgIH0KCiAgICAgIG1ldGEucGFyZW50
        VHlwZSA9IHByb3RvLmNvbnN0cnVjdG9yOwogICAgfQogIH0KfSk7CgovKgog
        IFRoZXNlIERTLk1vZGVsIGV4dGVuc2lvbnMgYWRkIGNsYXNzIG1ldGhvZHMg
        dGhhdCBwcm92aWRlIHJlbGF0aW9uc2hpcAogIGludHJvc3BlY3Rpb24gYWJp
        bGl0aWVzIGFib3V0IHJlbGF0aW9uc2hpcHMuCgogIEEgbm90ZSBhYm91dCB0
        aGUgY29tcHV0ZWQgcHJvcGVydGllcyBjb250YWluZWQgaGVyZToKCiAgKipU
        aGVzZSBwcm9wZXJ0aWVzIGFyZSBlZmZlY3RpdmVseSBzZWFsZWQgb25jZSBj
        YWxsZWQgZm9yIHRoZSBmaXJzdCB0aW1lLioqCiAgVG8gYXZvaWQgcmVwZWF0
        ZWRseSBkb2luZyBleHBlbnNpdmUgaXRlcmF0aW9uIG92ZXIgYSBtb2RlbCdz
        IGZpZWxkcywgdGhlc2UKICB2YWx1ZXMgYXJlIGNvbXB1dGVkIG9uY2UgYW5k
        IHRoZW4gY2FjaGVkIGZvciB0aGUgcmVtYWluZGVyIG9mIHRoZSBydW50aW1l
        IG9mCiAgeW91ciBhcHBsaWNhdGlvbi4KCiAgSWYgeW91ciBhcHBsaWNhdGlv
        biBuZWVkcyB0byBtb2RpZnkgYSBjbGFzcyBhZnRlciBpdHMgaW5pdGlhbCBk
        ZWZpbml0aW9uCiAgKGZvciBleGFtcGxlLCB1c2luZyBgcmVvcGVuKClgIHRv
        IGFkZCBhZGRpdGlvbmFsIGF0dHJpYnV0ZXMpLCBtYWtlIHN1cmUgeW91CiAg
        ZG8gaXQgYmVmb3JlIHVzaW5nIHlvdXIgbW9kZWwgd2l0aCB0aGUgc3RvcmUs
        IHdoaWNoIHVzZXMgdGhlc2UgcHJvcGVydGllcwogIGV4dGVuc2l2ZWx5Lgoq
        LwoKRFMuTW9kZWwucmVvcGVuQ2xhc3MoewogIC8qKgogICAgRm9yIGEgZ2l2
        ZW4gcmVsYXRpb25zaGlwIG5hbWUsIHJldHVybnMgdGhlIG1vZGVsIHR5cGUg
        b2YgdGhlIHJlbGF0aW9uc2hpcC4KCiAgICBGb3IgZXhhbXBsZSwgaWYgeW91
        IGRlZmluZSBhIG1vZGVsIGxpa2UgdGhpczoKCiAgICAgICAgQXBwLlBvc3Qg
        PSBEUy5Nb2RlbC5leHRlbmQoewogICAgICAgICAgY29tbWVudHM6IERTLmhh
        c01hbnkoQXBwLkNvbW1lbnQpCiAgICAgICAgfSk7CgogICAgQ2FsbGluZyBg
        QXBwLlBvc3QudHlwZUZvclJlbGF0aW9uc2hpcCgnY29tbWVudHMnKWAgd2ls
        bCByZXR1cm4gYEFwcC5Db21tZW50YC4KCiAgICBAbWV0aG9kIHR5cGVGb3JS
        ZWxhdGlvbnNoaXAKICAgIEBzdGF0aWMKICAgIEBwYXJhbSB7U3RyaW5nfSBu
        YW1lIHRoZSBuYW1lIG9mIHRoZSByZWxhdGlvbnNoaXAKICAgIEByZXR1cm4g
        e3N1YmNsYXNzIG9mIERTLk1vZGVsfSB0aGUgdHlwZSBvZiB0aGUgcmVsYXRp
        b25zaGlwLCBvciB1bmRlZmluZWQKICAqLwogIHR5cGVGb3JSZWxhdGlvbnNo
        aXA6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciByZWxhdGlvbnNoaXAgPSBn
        ZXQodGhpcywgJ3JlbGF0aW9uc2hpcHNCeU5hbWUnKS5nZXQobmFtZSk7CiAg
        ICByZXR1cm4gcmVsYXRpb25zaGlwICYmIHJlbGF0aW9uc2hpcC50eXBlOwog
        IH0sCgogIGludmVyc2VGb3I6IGZ1bmN0aW9uKG5hbWUpIHsKICAgIHZhciBp
        bnZlcnNlVHlwZSA9IHRoaXMudHlwZUZvclJlbGF0aW9uc2hpcChuYW1lKTsK
        CiAgICBpZiAoIWludmVyc2VUeXBlKSB7IHJldHVybiBudWxsOyB9CgogICAg
        dmFyIG9wdGlvbnMgPSB0aGlzLm1ldGFGb3JQcm9wZXJ0eShuYW1lKS5vcHRp
        b25zOwoKICAgIGlmIChvcHRpb25zLmludmVyc2UgPT09IG51bGwpIHsgcmV0
        dXJuIG51bGw7IH0KICAgIAogICAgdmFyIGludmVyc2VOYW1lLCBpbnZlcnNl
        S2luZDsKCiAgICBpZiAob3B0aW9ucy5pbnZlcnNlKSB7CiAgICAgIGludmVy
        c2VOYW1lID0gb3B0aW9ucy5pbnZlcnNlOwogICAgICBpbnZlcnNlS2luZCA9
        IEVtYmVyLmdldChpbnZlcnNlVHlwZSwgJ3JlbGF0aW9uc2hpcHNCeU5hbWUn
        KS5nZXQoaW52ZXJzZU5hbWUpLmtpbmQ7CiAgICB9IGVsc2UgewogICAgICB2
        YXIgcG9zc2libGVSZWxhdGlvbnNoaXBzID0gZmluZFBvc3NpYmxlSW52ZXJz
        ZXModGhpcywgaW52ZXJzZVR5cGUpOwoKICAgICAgaWYgKHBvc3NpYmxlUmVs
        YXRpb25zaGlwcy5sZW5ndGggPT09IDApIHsgcmV0dXJuIG51bGw7IH0KCiAg
        ICAgIEVtYmVyLmFzc2VydCgiWW91IGRlZmluZWQgdGhlICciICsgbmFtZSAr
        ICInIHJlbGF0aW9uc2hpcCBvbiAiICsgdGhpcyArICIsIGJ1dCBtdWx0aXBs
        ZSBwb3NzaWJsZSBpbnZlcnNlIHJlbGF0aW9uc2hpcHMgb2YgdHlwZSAiICsg
        dGhpcyArICIgd2VyZSBmb3VuZCBvbiAiICsgaW52ZXJzZVR5cGUgKyAiLiIs
        IHBvc3NpYmxlUmVsYXRpb25zaGlwcy5sZW5ndGggPT09IDEpOwoKICAgICAg
        aW52ZXJzZU5hbWUgPSBwb3NzaWJsZVJlbGF0aW9uc2hpcHNbMF0ubmFtZTsK
        ICAgICAgaW52ZXJzZUtpbmQgPSBwb3NzaWJsZVJlbGF0aW9uc2hpcHNbMF0u
        a2luZDsKICAgIH0KCiAgICBmdW5jdGlvbiBmaW5kUG9zc2libGVJbnZlcnNl
        cyh0eXBlLCBpbnZlcnNlVHlwZSwgcG9zc2libGVSZWxhdGlvbnNoaXBzKSB7
        CiAgICAgIHBvc3NpYmxlUmVsYXRpb25zaGlwcyA9IHBvc3NpYmxlUmVsYXRp
        b25zaGlwcyB8fCBbXTsKCiAgICAgIHZhciByZWxhdGlvbnNoaXBNYXAgPSBn
        ZXQoaW52ZXJzZVR5cGUsICdyZWxhdGlvbnNoaXBzJyk7CiAgICAgIGlmICgh
        cmVsYXRpb25zaGlwTWFwKSB7IHJldHVybjsgfQoKICAgICAgdmFyIHJlbGF0
        aW9uc2hpcHMgPSByZWxhdGlvbnNoaXBNYXAuZ2V0KHR5cGUpOwogICAgICBp
        ZiAocmVsYXRpb25zaGlwcykgewogICAgICAgIHBvc3NpYmxlUmVsYXRpb25z
        aGlwcy5wdXNoLmFwcGx5KHBvc3NpYmxlUmVsYXRpb25zaGlwcywgcmVsYXRp
        b25zaGlwTWFwLmdldCh0eXBlKSk7CiAgICAgIH0KCiAgICAgIGlmICh0eXBl
        LnN1cGVyY2xhc3MpIHsKICAgICAgICBmaW5kUG9zc2libGVJbnZlcnNlcyh0
        eXBlLnN1cGVyY2xhc3MsIGludmVyc2VUeXBlLCBwb3NzaWJsZVJlbGF0aW9u
        c2hpcHMpOwogICAgICB9CgogICAgICByZXR1cm4gcG9zc2libGVSZWxhdGlv
        bnNoaXBzOwogICAgfQoKICAgIHJldHVybiB7CiAgICAgIHR5cGU6IGludmVy
        c2VUeXBlLAogICAgICBuYW1lOiBpbnZlcnNlTmFtZSwKICAgICAga2luZDog
        aW52ZXJzZUtpbmQKICAgIH07CiAgfSwKCiAgLyoqCiAgICBUaGUgbW9kZWwn
        cyByZWxhdGlvbnNoaXBzIGFzIGEgbWFwLCBrZXllZCBvbiB0aGUgdHlwZSBv
        ZiB0aGUKICAgIHJlbGF0aW9uc2hpcC4gVGhlIHZhbHVlIG9mIGVhY2ggZW50
        cnkgaXMgYW4gYXJyYXkgY29udGFpbmluZyBhIGRlc2NyaXB0b3IKICAgIGZv
        ciBlYWNoIHJlbGF0aW9uc2hpcCB3aXRoIHRoYXQgdHlwZSwgZGVzY3JpYmlu
        ZyB0aGUgbmFtZSBvZiB0aGUgcmVsYXRpb25zaGlwCiAgICBhcyB3ZWxsIGFz
        IHRoZSB0eXBlLgoKICAgIEZvciBleGFtcGxlLCBnaXZlbiB0aGUgZm9sbG93
        aW5nIG1vZGVsIGRlZmluaXRpb246CgogICAgICAgIEFwcC5CbG9nID0gRFMu
        TW9kZWwuZXh0ZW5kKHsKICAgICAgICAgIHVzZXJzOiBEUy5oYXNNYW55KEFw
        cC5Vc2VyKSwKICAgICAgICAgIG93bmVyOiBEUy5iZWxvbmdzVG8oQXBwLlVz
        ZXIpLAogICAgICAgICAgcG9zdHM6IERTLmhhc01hbnkoQXBwLlBvc3QpCiAg
        ICAgICAgfSk7CgogICAgVGhpcyBjb21wdXRlZCBwcm9wZXJ0eSB3b3VsZCBy
        ZXR1cm4gYSBtYXAgZGVzY3JpYmluZyB0aGVzZQogICAgcmVsYXRpb25zaGlw
        cywgbGlrZSB0aGlzOgoKICAgICAgICB2YXIgcmVsYXRpb25zaGlwcyA9IEVt
        YmVyLmdldChBcHAuQmxvZywgJ3JlbGF0aW9uc2hpcHMnKTsKICAgICAgICBy
        ZWxhdGlvbnNoaXBzLmdldChBcHAuVXNlcik7CiAgICAgICAgLy89PiBbIHsg
        bmFtZTogJ3VzZXJzJywga2luZDogJ2hhc01hbnknIH0sCiAgICAgICAgLy8g
        ICAgIHsgbmFtZTogJ293bmVyJywga2luZDogJ2JlbG9uZ3NUbycgfSBdCiAg
        ICAgICAgcmVsYXRpb25zaGlwcy5nZXQoQXBwLlBvc3QpOwogICAgICAgIC8v
        PT4gWyB7IG5hbWU6ICdwb3N0cycsIGtpbmQ6ICdoYXNNYW55JyB9IF0KCiAg
        ICBAcHJvcGVydHkgcmVsYXRpb25zaGlwcwogICAgQHN0YXRpYwogICAgQHR5
        cGUgRW1iZXIuTWFwCiAgICBAcmVhZE9ubHkKICAqLwogIHJlbGF0aW9uc2hp
        cHM6IEVtYmVyLmNvbXB1dGVkKGZ1bmN0aW9uKCkgewogICAgdmFyIG1hcCA9
        IG5ldyBFbWJlci5NYXBXaXRoRGVmYXVsdCh7CiAgICAgIGRlZmF1bHRWYWx1
        ZTogZnVuY3Rpb24oKSB7IHJldHVybiBbXTsgfQogICAgfSk7CgogICAgLy8g
        TG9vcCB0aHJvdWdoIGVhY2ggY29tcHV0ZWQgcHJvcGVydHkgb24gdGhlIGNs
        YXNzCiAgICB0aGlzLmVhY2hDb21wdXRlZFByb3BlcnR5KGZ1bmN0aW9uKG5h
        bWUsIG1ldGEpIHsKCiAgICAgIC8vIElmIHRoZSBjb21wdXRlZCBwcm9wZXJ0
        eSBpcyBhIHJlbGF0aW9uc2hpcCwgYWRkCiAgICAgIC8vIGl0IHRvIHRoZSBt
        YXAuCiAgICAgIGlmIChtZXRhLmlzUmVsYXRpb25zaGlwKSB7CiAgICAgICAg
        aWYgKHR5cGVvZiBtZXRhLnR5cGUgPT09ICdzdHJpbmcnKSB7CiAgICAgICAg
        ICBtZXRhLnR5cGUgPSBFbWJlci5nZXQoRW1iZXIubG9va3VwLCBtZXRhLnR5
        cGUpOwogICAgICAgIH0KCiAgICAgICAgdmFyIHJlbGF0aW9uc2hpcHNGb3JU
        eXBlID0gbWFwLmdldChtZXRhLnR5cGUpOwoKICAgICAgICByZWxhdGlvbnNo
        aXBzRm9yVHlwZS5wdXNoKHsgbmFtZTogbmFtZSwga2luZDogbWV0YS5raW5k
        IH0pOwogICAgICB9CiAgICB9KTsKCiAgICByZXR1cm4gbWFwOwogIH0pLAoK
        ICAvKioKICAgIEEgaGFzaCBjb250YWluaW5nIGxpc3RzIG9mIHRoZSBtb2Rl
        bCdzIHJlbGF0aW9uc2hpcHMsIGdyb3VwZWQKICAgIGJ5IHRoZSByZWxhdGlv
        bnNoaXAga2luZC4gRm9yIGV4YW1wbGUsIGdpdmVuIGEgbW9kZWwgd2l0aCB0
        aGlzCiAgICBkZWZpbml0aW9uOgoKICAgICAgICBBcHAuQmxvZyA9IERTLk1v
        ZGVsLmV4dGVuZCh7CiAgICAgICAgICB1c2VyczogRFMuaGFzTWFueShBcHAu
        VXNlciksCiAgICAgICAgICBvd25lcjogRFMuYmVsb25nc1RvKEFwcC5Vc2Vy
        KSwKCiAgICAgICAgICBwb3N0czogRFMuaGFzTWFueShBcHAuUG9zdCkKICAg
        ICAgICB9KTsKCiAgICBUaGlzIHByb3BlcnR5IHdvdWxkIGNvbnRhaW4gdGhl
        IGZvbGxvd2luZzoKCiAgICAgICB2YXIgcmVsYXRpb25zaGlwTmFtZXMgPSBF
        bWJlci5nZXQoQXBwLkJsb2csICdyZWxhdGlvbnNoaXBOYW1lcycpOwogICAg
        ICAgcmVsYXRpb25zaGlwTmFtZXMuaGFzTWFueTsKICAgICAgIC8vPT4gWyd1
        c2VycycsICdwb3N0cyddCiAgICAgICByZWxhdGlvbnNoaXBOYW1lcy5iZWxv
        bmdzVG87CiAgICAgICAvLz0+IFsnb3duZXInXQoKICAgIEBwcm9wZXJ0eSBy
        ZWxhdGlvbnNoaXBOYW1lcwogICAgQHN0YXRpYwogICAgQHR5cGUgT2JqZWN0
        CiAgICBAcmVhZE9ubHkKICAqLwogIHJlbGF0aW9uc2hpcE5hbWVzOiBFbWJl
        ci5jb21wdXRlZChmdW5jdGlvbigpIHsKICAgIHZhciBuYW1lcyA9IHsgaGFz
        TWFueTogW10sIGJlbG9uZ3NUbzogW10gfTsKCiAgICB0aGlzLmVhY2hDb21w
        dXRlZFByb3BlcnR5KGZ1bmN0aW9uKG5hbWUsIG1ldGEpIHsKICAgICAgaWYg
        KG1ldGEuaXNSZWxhdGlvbnNoaXApIHsKICAgICAgICBuYW1lc1ttZXRhLmtp
        bmRdLnB1c2gobmFtZSk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJldHVybiBu
        YW1lczsKICB9KSwKCiAgLyoqCiAgICBBbiBhcnJheSBvZiB0eXBlcyBkaXJl
        Y3RseSByZWxhdGVkIHRvIGEgbW9kZWwuIEVhY2ggdHlwZSB3aWxsIGJlCiAg
        ICBpbmNsdWRlZCBvbmNlLCByZWdhcmRsZXNzIG9mIHRoZSBudW1iZXIgb2Yg
        cmVsYXRpb25zaGlwcyBpdCBoYXMgd2l0aAogICAgdGhlIG1vZGVsLgoKICAg
        IEZvciBleGFtcGxlLCBnaXZlbiBhIG1vZGVsIHdpdGggdGhpcyBkZWZpbml0
        aW9uOgoKICAgICAgICBBcHAuQmxvZyA9IERTLk1vZGVsLmV4dGVuZCh7CiAg
        ICAgICAgICB1c2VyczogRFMuaGFzTWFueShBcHAuVXNlciksCiAgICAgICAg
        ICBvd25lcjogRFMuYmVsb25nc1RvKEFwcC5Vc2VyKSwKICAgICAgICAgIHBv
        c3RzOiBEUy5oYXNNYW55KEFwcC5Qb3N0KQogICAgICAgIH0pOwoKICAgIFRo
        aXMgcHJvcGVydHkgd291bGQgY29udGFpbiB0aGUgZm9sbG93aW5nOgoKICAg
        ICAgIHZhciByZWxhdGVkVHlwZXMgPSBFbWJlci5nZXQoQXBwLkJsb2csICdy
        ZWxhdGVkVHlwZXMnKTsKICAgICAgIC8vPT4gWyBBcHAuVXNlciwgQXBwLlBv
        c3QgXQoKICAgIEBwcm9wZXJ0eSByZWxhdGVkVHlwZXMKICAgIEBzdGF0aWMK
        ICAgIEB0eXBlIEVtYmVyLkFycmF5CiAgICBAcmVhZE9ubHkKICAqLwogIHJl
        bGF0ZWRUeXBlczogRW1iZXIuY29tcHV0ZWQoZnVuY3Rpb24oKSB7CiAgICB2
        YXIgdHlwZSwKICAgICAgICB0eXBlcyA9IEVtYmVyLkEoKTsKCiAgICAvLyBM
        b29wIHRocm91Z2ggZWFjaCBjb21wdXRlZCBwcm9wZXJ0eSBvbiB0aGUgY2xh
        c3MsCiAgICAvLyBhbmQgY3JlYXRlIGFuIGFycmF5IG9mIHRoZSB1bmlxdWUg
        dHlwZXMgaW52b2x2ZWQKICAgIC8vIGluIHJlbGF0aW9uc2hpcHMKICAgIHRo
        aXMuZWFjaENvbXB1dGVkUHJvcGVydHkoZnVuY3Rpb24obmFtZSwgbWV0YSkg
        ewogICAgICBpZiAobWV0YS5pc1JlbGF0aW9uc2hpcCkgewogICAgICAgIHR5
        cGUgPSBtZXRhLnR5cGU7CgogICAgICAgIGlmICh0eXBlb2YgdHlwZSA9PT0g
        J3N0cmluZycpIHsKICAgICAgICAgIHR5cGUgPSBnZXQodGhpcywgdHlwZSwg
        ZmFsc2UpIHx8IGdldChFbWJlci5sb29rdXAsIHR5cGUpOwogICAgICAgIH0K
        CiAgICAgICAgRW1iZXIuYXNzZXJ0KCJZb3Ugc3BlY2lmaWVkIGEgaGFzTWFu
        eSAoIiArIG1ldGEudHlwZSArICIpIG9uICIgKyBtZXRhLnBhcmVudFR5cGUg
        KyAiIGJ1dCAiICsgbWV0YS50eXBlICsgIiB3YXMgbm90IGZvdW5kLiIsICB0
        eXBlKTsKCiAgICAgICAgaWYgKCF0eXBlcy5jb250YWlucyh0eXBlKSkgewog
        ICAgICAgICAgRW1iZXIuYXNzZXJ0KCJUcnlpbmcgdG8gc2lkZWxvYWQgIiAr
        IG5hbWUgKyAiIG9uICIgKyB0aGlzLnRvU3RyaW5nKCkgKyAiIGJ1dCB0aGUg
        dHlwZSBkb2Vzbid0IGV4aXN0LiIsICEhdHlwZSk7CiAgICAgICAgICB0eXBl
        cy5wdXNoKHR5cGUpOwogICAgICAgIH0KICAgICAgfQogICAgfSk7CgogICAg
        cmV0dXJuIHR5cGVzOwogIH0pLAoKICAvKioKICAgIEEgbWFwIHdob3NlIGtl
        eXMgYXJlIHRoZSByZWxhdGlvbnNoaXBzIG9mIGEgbW9kZWwgYW5kIHdob3Nl
        IHZhbHVlcyBhcmUKICAgIHJlbGF0aW9uc2hpcCBkZXNjcmlwdG9ycy4KCiAg
        ICBGb3IgZXhhbXBsZSwgZ2l2ZW4gYSBtb2RlbCB3aXRoIHRoaXMKICAgIGRl
        ZmluaXRpb246CgogICAgICAgIEFwcC5CbG9nID0gRFMuTW9kZWwuZXh0ZW5k
        KHsKICAgICAgICAgIHVzZXJzOiBEUy5oYXNNYW55KEFwcC5Vc2VyKSwKICAg
        ICAgICAgIG93bmVyOiBEUy5iZWxvbmdzVG8oQXBwLlVzZXIpLAoKICAgICAg
        ICAgIHBvc3RzOiBEUy5oYXNNYW55KEFwcC5Qb3N0KQogICAgICAgIH0pOwoK
        ICAgIFRoaXMgcHJvcGVydHkgd291bGQgY29udGFpbiB0aGUgZm9sbG93aW5n
        OgoKICAgICAgIHZhciByZWxhdGlvbnNoaXBzQnlOYW1lID0gRW1iZXIuZ2V0
        KEFwcC5CbG9nLCAncmVsYXRpb25zaGlwc0J5TmFtZScpOwogICAgICAgcmVs
        YXRpb25zaGlwc0J5TmFtZS5nZXQoJ3VzZXJzJyk7CiAgICAgICAvLz0+IHsg
        a2V5OiAndXNlcnMnLCBraW5kOiAnaGFzTWFueScsIHR5cGU6IEFwcC5Vc2Vy
        IH0KICAgICAgIHJlbGF0aW9uc2hpcHNCeU5hbWUuZ2V0KCdvd25lcicpOwog
        ICAgICAgLy89PiB7IGtleTogJ293bmVyJywga2luZDogJ2JlbG9uZ3NUbycs
        IHR5cGU6IEFwcC5Vc2VyIH0KCiAgICBAcHJvcGVydHkgcmVsYXRpb25zaGlw
        c0J5TmFtZQogICAgQHN0YXRpYwogICAgQHR5cGUgRW1iZXIuTWFwCiAgICBA
        cmVhZE9ubHkKICAqLwogIHJlbGF0aW9uc2hpcHNCeU5hbWU6IEVtYmVyLmNv
        bXB1dGVkKGZ1bmN0aW9uKCkgewogICAgdmFyIG1hcCA9IEVtYmVyLk1hcC5j
        cmVhdGUoKSwgdHlwZTsKCiAgICB0aGlzLmVhY2hDb21wdXRlZFByb3BlcnR5
        KGZ1bmN0aW9uKG5hbWUsIG1ldGEpIHsKICAgICAgaWYgKG1ldGEuaXNSZWxh
        dGlvbnNoaXApIHsKICAgICAgICBtZXRhLmtleSA9IG5hbWU7CiAgICAgICAg
        dHlwZSA9IG1ldGEudHlwZTsKCiAgICAgICAgaWYgKHR5cGVvZiB0eXBlID09
        PSAnc3RyaW5nJykgewogICAgICAgICAgbWV0YS50eXBlID0gdGhpcy5zdG9y
        ZS5tb2RlbEZvcih0eXBlKTsKICAgICAgICB9CgogICAgICAgIG1hcC5zZXQo
        bmFtZSwgbWV0YSk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJldHVybiBtYXA7
        CiAgfSksCgogIC8qKgogICAgQSBtYXAgd2hvc2Uga2V5cyBhcmUgdGhlIGZp
        ZWxkcyBvZiB0aGUgbW9kZWwgYW5kIHdob3NlIHZhbHVlcyBhcmUgc3RyaW5n
        cwogICAgZGVzY3JpYmluZyB0aGUga2luZCBvZiB0aGUgZmllbGQuIEEgbW9k
        ZWwncyBmaWVsZHMgYXJlIHRoZSB1bmlvbiBvZiBhbGwgb2YgaXRzCiAgICBh
        dHRyaWJ1dGVzIGFuZCByZWxhdGlvbnNoaXBzLgoKICAgIEZvciBleGFtcGxl
        OgoKICAgICAgICBBcHAuQmxvZyA9IERTLk1vZGVsLmV4dGVuZCh7CiAgICAg
        ICAgICB1c2VyczogRFMuaGFzTWFueShBcHAuVXNlciksCiAgICAgICAgICBv
        d25lcjogRFMuYmVsb25nc1RvKEFwcC5Vc2VyKSwKCiAgICAgICAgICBwb3N0
        czogRFMuaGFzTWFueShBcHAuUG9zdCksCgogICAgICAgICAgdGl0bGU6IERT
        LmF0dHIoJ3N0cmluZycpCiAgICAgICAgfSk7CgogICAgICAgIHZhciBmaWVs
        ZHMgPSBFbWJlci5nZXQoQXBwLkJsb2csICdmaWVsZHMnKTsKICAgICAgICBm
        aWVsZHMuZm9yRWFjaChmdW5jdGlvbihmaWVsZCwga2luZCkgewogICAgICAg
        ICAgY29uc29sZS5sb2coZmllbGQsIGtpbmQpOwogICAgICAgIH0pOwoKICAg
        ICAgICAvLyBwcmludHM6CiAgICAgICAgLy8gdXNlcnMsIGhhc01hbnkKICAg
        ICAgICAvLyBvd25lciwgYmVsb25nc1RvCiAgICAgICAgLy8gcG9zdHMsIGhh
        c01hbnkKICAgICAgICAvLyB0aXRsZSwgYXR0cmlidXRlCgogICAgQHByb3Bl
        cnR5IGZpZWxkcwogICAgQHN0YXRpYwogICAgQHR5cGUgRW1iZXIuTWFwCiAg
        ICBAcmVhZE9ubHkKICAqLwogIGZpZWxkczogRW1iZXIuY29tcHV0ZWQoZnVu
        Y3Rpb24oKSB7CiAgICB2YXIgbWFwID0gRW1iZXIuTWFwLmNyZWF0ZSgpOwoK
        ICAgIHRoaXMuZWFjaENvbXB1dGVkUHJvcGVydHkoZnVuY3Rpb24obmFtZSwg
        bWV0YSkgewogICAgICBpZiAobWV0YS5pc1JlbGF0aW9uc2hpcCkgewogICAg
        ICAgIG1hcC5zZXQobmFtZSwgbWV0YS5raW5kKTsKICAgICAgfSBlbHNlIGlm
        IChtZXRhLmlzQXR0cmlidXRlKSB7CiAgICAgICAgbWFwLnNldChuYW1lLCAn
        YXR0cmlidXRlJyk7CiAgICAgIH0KICAgIH0pOwoKICAgIHJldHVybiBtYXA7
        CiAgfSksCgogIC8qKgogICAgR2l2ZW4gYSBjYWxsYmFjaywgaXRlcmF0ZXMg
        b3ZlciBlYWNoIG9mIHRoZSByZWxhdGlvbnNoaXBzIGluIHRoZSBtb2RlbCwK
        ICAgIGludm9raW5nIHRoZSBjYWxsYmFjayB3aXRoIHRoZSBuYW1lIG9mIGVh
        Y2ggcmVsYXRpb25zaGlwIGFuZCBpdHMgcmVsYXRpb25zaGlwCiAgICBkZXNj
        cmlwdG9yLgoKICAgIEBtZXRob2QgZWFjaFJlbGF0aW9uc2hpcAogICAgQHN0
        YXRpYwogICAgQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2sgdGhlIGNhbGxi
        YWNrIHRvIGludm9rZQogICAgQHBhcmFtIHthbnl9IGJpbmRpbmcgdGhlIHZh
        bHVlIHRvIHdoaWNoIHRoZSBjYWxsYmFjaydzIGB0aGlzYCBzaG91bGQgYmUg
        Ym91bmQKICAqLwogIGVhY2hSZWxhdGlvbnNoaXA6IGZ1bmN0aW9uKGNhbGxi
        YWNrLCBiaW5kaW5nKSB7CiAgICBnZXQodGhpcywgJ3JlbGF0aW9uc2hpcHNC
        eU5hbWUnKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUsIHJlbGF0aW9uc2hpcCkg
        ewogICAgICBjYWxsYmFjay5jYWxsKGJpbmRpbmcsIG5hbWUsIHJlbGF0aW9u
        c2hpcCk7CiAgICB9KTsKICB9LAoKICAvKioKICAgIEdpdmVuIGEgY2FsbGJh
        Y2ssIGl0ZXJhdGVzIG92ZXIgZWFjaCBvZiB0aGUgdHlwZXMgcmVsYXRlZCB0
        byBhIG1vZGVsLAogICAgaW52b2tpbmcgdGhlIGNhbGxiYWNrIHdpdGggdGhl
        IHJlbGF0ZWQgdHlwZSdzIGNsYXNzLiBFYWNoIHR5cGUgd2lsbCBiZQogICAg
        cmV0dXJuZWQganVzdCBvbmNlLCByZWdhcmRsZXNzIG9mIGhvdyBtYW55IGRp
        ZmZlcmVudCByZWxhdGlvbnNoaXBzIGl0IGhhcwogICAgd2l0aCBhIG1vZGVs
        LgoKICAgIEBtZXRob2QgZWFjaFJlbGF0ZWRUeXBlCiAgICBAc3RhdGljCiAg
        ICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayB0aGUgY2FsbGJhY2sgdG8g
        aW52b2tlCiAgICBAcGFyYW0ge2FueX0gYmluZGluZyB0aGUgdmFsdWUgdG8g
        d2hpY2ggdGhlIGNhbGxiYWNrJ3MgYHRoaXNgIHNob3VsZCBiZSBib3VuZAog
        ICovCiAgZWFjaFJlbGF0ZWRUeXBlOiBmdW5jdGlvbihjYWxsYmFjaywgYmlu
        ZGluZykgewogICAgZ2V0KHRoaXMsICdyZWxhdGVkVHlwZXMnKS5mb3JFYWNo
        KGZ1bmN0aW9uKHR5cGUpIHsKICAgICAgY2FsbGJhY2suY2FsbChiaW5kaW5n
        LCB0eXBlKTsKICAgIH0pOwogIH0KfSk7CgpEUy5Nb2RlbC5yZW9wZW4oewog
        IC8qKgogICAgR2l2ZW4gYSBjYWxsYmFjaywgaXRlcmF0ZXMgb3ZlciBlYWNo
        IG9mIHRoZSByZWxhdGlvbnNoaXBzIGluIHRoZSBtb2RlbCwKICAgIGludm9r
        aW5nIHRoZSBjYWxsYmFjayB3aXRoIHRoZSBuYW1lIG9mIGVhY2ggcmVsYXRp
        b25zaGlwIGFuZCBpdHMgcmVsYXRpb25zaGlwCiAgICBkZXNjcmlwdG9yLgoK
        ICAgIEBtZXRob2QgZWFjaFJlbGF0aW9uc2hpcAogICAgQHBhcmFtIHtGdW5j
        dGlvbn0gY2FsbGJhY2sgdGhlIGNhbGxiYWNrIHRvIGludm9rZQogICAgQHBh
        cmFtIHthbnl9IGJpbmRpbmcgdGhlIHZhbHVlIHRvIHdoaWNoIHRoZSBjYWxs
        YmFjaydzIGB0aGlzYCBzaG91bGQgYmUgYm91bmQKICAqLwogIGVhY2hSZWxh
        dGlvbnNoaXA6IGZ1bmN0aW9uKGNhbGxiYWNrLCBiaW5kaW5nKSB7CiAgICB0
        aGlzLmNvbnN0cnVjdG9yLmVhY2hSZWxhdGlvbnNoaXAoY2FsbGJhY2ssIGJp
        bmRpbmcpOwogIH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rpb24oKSB7Ci8qKgog
        IEBtb2R1bGUgZW1iZXItZGF0YQoqLwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkg
        ewovKioKICBAbW9kdWxlIGVtYmVyLWRhdGEKKi8KCnZhciBnZXQgPSBFbWJl
        ci5nZXQsIHNldCA9IEVtYmVyLnNldDsKdmFyIG9uY2UgPSBFbWJlci5ydW4u
        b25jZTsKdmFyIGZvckVhY2ggPSBFbWJlci5FbnVtZXJhYmxlVXRpbHMuZm9y
        RWFjaDsKCi8qKgogIEBjbGFzcyBSZWNvcmRBcnJheU1hbmFnZXIKICBAbmFt
        ZXNwYWNlIERTCiAgQHByaXZhdGUKICBAZXh0ZW5kcyBFbWJlci5PYmplY3QK
        Ki8KRFMuUmVjb3JkQXJyYXlNYW5hZ2VyID0gRW1iZXIuT2JqZWN0LmV4dGVu
        ZCh7CiAgaW5pdDogZnVuY3Rpb24oKSB7CiAgICB0aGlzLmZpbHRlcmVkUmVj
        b3JkQXJyYXlzID0gRW1iZXIuTWFwV2l0aERlZmF1bHQuY3JlYXRlKHsKICAg
        ICAgZGVmYXVsdFZhbHVlOiBmdW5jdGlvbigpIHsgcmV0dXJuIFtdOyB9CiAg
        ICB9KTsKCiAgICB0aGlzLmNoYW5nZWRSZWNvcmRzID0gW107CiAgfSwKCiAg
        cmVjb3JkRGlkQ2hhbmdlOiBmdW5jdGlvbihyZWNvcmQpIHsKICAgIHRoaXMu
        Y2hhbmdlZFJlY29yZHMucHVzaChyZWNvcmQpOwogICAgb25jZSh0aGlzLCB0
        aGlzLnVwZGF0ZVJlY29yZEFycmF5cyk7CiAgfSwKCiAgcmVjb3JkQXJyYXlz
        Rm9yUmVjb3JkOiBmdW5jdGlvbihyZWNvcmQpIHsKICAgIHJlY29yZC5fcmVj
        b3JkQXJyYXlzID0gcmVjb3JkLl9yZWNvcmRBcnJheXMgfHwgRW1iZXIuT3Jk
        ZXJlZFNldC5jcmVhdGUoKTsKICAgIHJldHVybiByZWNvcmQuX3JlY29yZEFy
        cmF5czsKICB9LAoKICAvKioKICAgIFRoaXMgbWV0aG9kIGlzIGludm9rZWQg
        d2hlbmV2ZXIgZGF0YSBpcyBsb2FkZWQgaW50byB0aGUgc3RvcmUKICAgIGJ5
        IHRoZSBhZGFwdGVyIG9yIHVwZGF0ZWQgYnkgdGhlIGFkYXB0ZXIsIG9yIHdo
        ZW4gYW4gYXR0cmlidXRlCiAgICBjaGFuZ2VzIG9uIGEgcmVjb3JkLgoKICAg
        IEl0IHVwZGF0ZXMgYWxsIGZpbHRlcnMgdGhhdCBhIHJlY29yZCBiZWxvbmdz
        IHRvLgoKICAgIFRvIGF2b2lkIHRocmFzaGluZywgaXQgb25seSBydW5zIG9u
        Y2UgcGVyIHJ1biBsb29wIHBlciByZWNvcmQuCgogICAgQG1ldGhvZCB1cGRh
        dGVSZWNvcmRBcnJheXMKICAgIEBwYXJhbSB7Q2xhc3N9IHR5cGUKICAgIEBw
        YXJhbSB7TnVtYmVyfFN0cmluZ30gY2xpZW50SWQKICAqLwogIHVwZGF0ZVJl
        Y29yZEFycmF5czogZnVuY3Rpb24oKSB7CiAgICBmb3JFYWNoKHRoaXMuY2hh
        bmdlZFJlY29yZHMsIGZ1bmN0aW9uKHJlY29yZCkgewogICAgICB2YXIgdHlw
        ZSA9IHJlY29yZC5jb25zdHJ1Y3RvciwKICAgICAgICAgIHJlY29yZEFycmF5
        cyA9IHRoaXMuZmlsdGVyZWRSZWNvcmRBcnJheXMuZ2V0KHR5cGUpLAogICAg
        ICAgICAgZmlsdGVyOwoKICAgICAgZm9yRWFjaChyZWNvcmRBcnJheXMsIGZ1
        bmN0aW9uKGFycmF5KSB7CiAgICAgICAgZmlsdGVyID0gZ2V0KGFycmF5LCAn
        ZmlsdGVyRnVuY3Rpb24nKTsKICAgICAgICB0aGlzLnVwZGF0ZVJlY29yZEFy
        cmF5KGFycmF5LCBmaWx0ZXIsIHR5cGUsIHJlY29yZCk7CiAgICAgIH0sIHRo
        aXMpOwoKICAgICAgLy8gbG9vcCB0aHJvdWdoIGFsbCBtYW55QXJyYXlzIGNv
        bnRhaW5pbmcgYW4gdW5sb2FkZWQgY29weSBvZiB0aGlzCiAgICAgIC8vIGNs
        aWVudElkIGFuZCBub3RpZnkgdGhlbSB0aGF0IHRoZSByZWNvcmQgd2FzIGxv
        YWRlZC4KICAgICAgdmFyIG1hbnlBcnJheXMgPSByZWNvcmQuX2xvYWRpbmdS
        ZWNvcmRBcnJheXM7CgogICAgICBpZiAobWFueUFycmF5cykgewogICAgICAg
        IGZvciAodmFyIGk9MCwgbD1tYW55QXJyYXlzLmxlbmd0aDsgaTxsOyBpKysp
        IHsKICAgICAgICAgIG1hbnlBcnJheXNbaV0ubG9hZGVkUmVjb3JkKCk7CiAg
        ICAgICAgfQoKICAgICAgICByZWNvcmQuX2xvYWRpbmdSZWNvcmRBcnJheXMg
        PSBbXTsKICAgICAgfQogICAgfSwgdGhpcyk7CgogICAgdGhpcy5jaGFuZ2Vk
        UmVjb3JkcyA9IFtdOwogIH0sCgogIC8qKgogICAgVXBkYXRlIGFuIGluZGl2
        aWR1YWwgZmlsdGVyLgoKICAgIEBtZXRob2QgdXBkYXRlUmVjb3JkQXJyYXkK
        ICAgIEBwYXJhbSB7RFMuRmlsdGVyZWRSZWNvcmRBcnJheX0gYXJyYXkKICAg
        IEBwYXJhbSB7RnVuY3Rpb259IGZpbHRlcgogICAgQHBhcmFtIHtDbGFzc30g
        dHlwZQogICAgQHBhcmFtIHtOdW1iZXJ8U3RyaW5nfSBjbGllbnRJZAogICov
        CiAgdXBkYXRlUmVjb3JkQXJyYXk6IGZ1bmN0aW9uKGFycmF5LCBmaWx0ZXIs
        IHR5cGUsIHJlY29yZCkgewogICAgdmFyIHNob3VsZEJlSW5BcnJheTsKCiAg
        ICBpZiAoIWZpbHRlcikgewogICAgICBzaG91bGRCZUluQXJyYXkgPSB0cnVl
        OwogICAgfSBlbHNlIHsKICAgICAgc2hvdWxkQmVJbkFycmF5ID0gZmlsdGVy
        KHJlY29yZCk7CiAgICB9CgogICAgdmFyIHJlY29yZEFycmF5cyA9IHRoaXMu
        cmVjb3JkQXJyYXlzRm9yUmVjb3JkKHJlY29yZCk7CgogICAgaWYgKHNob3Vs
        ZEJlSW5BcnJheSkgewogICAgICByZWNvcmRBcnJheXMuYWRkKGFycmF5KTsK
        ICAgICAgYXJyYXkuYWRkUmVjb3JkKHJlY29yZCk7CiAgICB9IGVsc2UgaWYg
        KCFzaG91bGRCZUluQXJyYXkpIHsKICAgICAgcmVjb3JkQXJyYXlzLnJlbW92
        ZShhcnJheSk7CiAgICAgIGFycmF5LnJlbW92ZVJlY29yZChyZWNvcmQpOwog
        ICAgfQogIH0sCgogIC8qKgogICAgV2hlbiBhIHJlY29yZCBpcyBkZWxldGVk
        LCBpdCBpcyByZW1vdmVkIGZyb20gYWxsIGl0cwogICAgcmVjb3JkIGFycmF5
        cy4KCiAgICBAbWV0aG9kIHJlbW92ZQogICAgQHBhcmFtIHtEUy5Nb2RlbH0g
        cmVjb3JkCiAgKi8KICByZW1vdmU6IGZ1bmN0aW9uKHJlY29yZCkgewogICAg
        dmFyIHJlY29yZEFycmF5cyA9IHJlY29yZC5fcmVjb3JkQXJyYXlzOwoKICAg
        IGlmICghcmVjb3JkQXJyYXlzKSB7IHJldHVybjsgfQoKICAgIGZvckVhY2go
        cmVjb3JkQXJyYXlzLCBmdW5jdGlvbihhcnJheSkgewogICAgICBhcnJheS5y
        ZW1vdmVSZWNvcmQocmVjb3JkKTsKICAgIH0pOwogIH0sCgogIC8qKgogICAg
        VGhpcyBtZXRob2QgaXMgaW52b2tlZCBpZiB0aGUgYGZpbHRlckZ1bmN0aW9u
        YCBwcm9wZXJ0eSBpcwogICAgY2hhbmdlZCBvbiBhIGBEUy5GaWx0ZXJlZFJl
        Y29yZEFycmF5YC4KCiAgICBJdCBlc3NlbnRpYWxseSByZS1ydW5zIHRoZSBm
        aWx0ZXIgZnJvbSBzY3JhdGNoLiBUaGlzIHNhbWUKICAgIG1ldGhvZCBpcyBp
        bnZva2VkIHdoZW4gdGhlIGZpbHRlciBpcyBjcmVhdGVkIGluIHRoIGZpcnN0
        IHBsYWNlLgoKICAgIEBtZXRob2QgdXBkYXRlRmlsdGVyCiAgICBAcGFyYW0g
        YXJyYXkKICAgIEBwYXJhbSB0eXBlCiAgICBAcGFyYW0gZmlsdGVyCiAgKi8K
        ICB1cGRhdGVGaWx0ZXI6IGZ1bmN0aW9uKGFycmF5LCB0eXBlLCBmaWx0ZXIp
        IHsKICAgIHZhciB0eXBlTWFwID0gdGhpcy5zdG9yZS50eXBlTWFwRm9yKHR5
        cGUpLAogICAgICAgIHJlY29yZHMgPSB0eXBlTWFwLnJlY29yZHMsIHJlY29y
        ZDsKCiAgICBmb3IgKHZhciBpPTAsIGw9cmVjb3Jkcy5sZW5ndGg7IGk8bDsg
        aSsrKSB7CiAgICAgIHJlY29yZCA9IHJlY29yZHNbaV07CgogICAgICBpZiAo
        IWdldChyZWNvcmQsICdpc0RlbGV0ZWQnKSAmJiAhZ2V0KHJlY29yZCwgJ2lz
        RW1wdHknKSkgewogICAgICAgIHRoaXMudXBkYXRlUmVjb3JkQXJyYXkoYXJy
        YXksIGZpbHRlciwgdHlwZSwgcmVjb3JkKTsKICAgICAgfQogICAgfQogIH0s
        CgogIC8qKgogICAgQ3JlYXRlIGEgYERTLk1hbnlBcnJheWAgZm9yIGEgdHlw
        ZSBhbmQgbGlzdCBvZiByZWNvcmQgcmVmZXJlbmNlcywgYW5kIGluZGV4CiAg
        ICB0aGUgYE1hbnlBcnJheWAgdW5kZXIgZWFjaCByZWZlcmVuY2UuIFRoaXMg
        YWxsb3dzIHVzIHRvIGVmZmljaWVudGx5IHJlbW92ZQogICAgcmVjb3JkcyBm
        cm9tIGBNYW55QXJyYXlgcyB3aGVuIHRoZXkgYXJlIGRlbGV0ZWQuCgogICAg
        QG1ldGhvZCBjcmVhdGVNYW55QXJyYXkKICAgIEBwYXJhbSB7Q2xhc3N9IHR5
        cGUKICAgIEBwYXJhbSB7QXJyYXl9IHJlZmVyZW5jZXMKICAgIEByZXR1cm4g
        e0RTLk1hbnlBcnJheX0KICAqLwogIGNyZWF0ZU1hbnlBcnJheTogZnVuY3Rp
        b24odHlwZSwgcmVjb3JkcykgewogICAgdmFyIG1hbnlBcnJheSA9IERTLk1h
        bnlBcnJheS5jcmVhdGUoewogICAgICB0eXBlOiB0eXBlLAogICAgICBjb250
        ZW50OiByZWNvcmRzLAogICAgICBzdG9yZTogdGhpcy5zdG9yZQogICAgfSk7
        CgogICAgZm9yRWFjaChyZWNvcmRzLCBmdW5jdGlvbihyZWNvcmQpIHsKICAg
        ICAgdmFyIGFycmF5cyA9IHRoaXMucmVjb3JkQXJyYXlzRm9yUmVjb3JkKHJl
        Y29yZCk7CiAgICAgIGFycmF5cy5hZGQobWFueUFycmF5KTsKICAgIH0sIHRo
        aXMpOwoKICAgIHJldHVybiBtYW55QXJyYXk7CiAgfSwKCiAgLyoqCiAgICBS
        ZWdpc3RlciBhIFJlY29yZEFycmF5IGZvciBhIGdpdmVuIHR5cGUgdG8gYmUg
        YmFja2VkIGJ5CiAgICBhIGZpbHRlciBmdW5jdGlvbi4gVGhpcyB3aWxsIGNh
        dXNlIHRoZSBhcnJheSB0byB1cGRhdGUKICAgIGF1dG9tYXRpY2FsbHkgd2hl
        biByZWNvcmRzIG9mIHRoYXQgdHlwZSBjaGFuZ2UgYXR0cmlidXRlCiAgICB2
        YWx1ZXMgb3Igc3RhdGVzLgoKICAgIEBtZXRob2QgcmVnaXN0ZXJGaWx0ZXJl
        ZFJlY29yZEFycmF5CiAgICBAcGFyYW0ge0RTLlJlY29yZEFycmF5fSBhcnJh
        eQogICAgQHBhcmFtIHtDbGFzc30gdHlwZQogICAgQHBhcmFtIHtGdW5jdGlv
        bn0gZmlsdGVyCiAgKi8KICByZWdpc3RlckZpbHRlcmVkUmVjb3JkQXJyYXk6
        IGZ1bmN0aW9uKGFycmF5LCB0eXBlLCBmaWx0ZXIpIHsKICAgIHZhciByZWNv
        cmRBcnJheXMgPSB0aGlzLmZpbHRlcmVkUmVjb3JkQXJyYXlzLmdldCh0eXBl
        KTsKICAgIHJlY29yZEFycmF5cy5wdXNoKGFycmF5KTsKCiAgICB0aGlzLnVw
        ZGF0ZUZpbHRlcihhcnJheSwgdHlwZSwgZmlsdGVyKTsKICB9LAoKICAvLyBJ
        bnRlcm5hbGx5LCB3ZSBtYWludGFpbiBhIG1hcCBvZiBhbGwgdW5sb2FkZWQg
        SURzIHJlcXVlc3RlZCBieQogIC8vIGEgTWFueUFycmF5LiBBcyB0aGUgYWRh
        cHRlciBsb2FkcyBkYXRhIGludG8gdGhlIHN0b3JlLCB0aGUKICAvLyBzdG9y
        ZSBub3RpZmllcyBhbnkgaW50ZXJlc3RlZCBNYW55QXJyYXlzLiBXaGVuIHRo
        ZSBNYW55QXJyYXkncwogIC8vIHRvdGFsIG51bWJlciBvZiBsb2FkaW5nIHJl
        Y29yZHMgZHJvcHMgdG8gemVybywgaXQgYmVjb21lcwogIC8vIGBpc0xvYWRl
        ZGAgYW5kIGZpcmVzIGEgYGRpZExvYWRgIGV2ZW50LgogIHJlZ2lzdGVyV2Fp
        dGluZ1JlY29yZEFycmF5OiBmdW5jdGlvbihyZWNvcmQsIGFycmF5KSB7CiAg
        ICB2YXIgbG9hZGluZ1JlY29yZEFycmF5cyA9IHJlY29yZC5fbG9hZGluZ1Jl
        Y29yZEFycmF5cyB8fCBbXTsKICAgIGxvYWRpbmdSZWNvcmRBcnJheXMucHVz
        aChhcnJheSk7CiAgICByZWNvcmQuX2xvYWRpbmdSZWNvcmRBcnJheXMgPSBs
        b2FkaW5nUmVjb3JkQXJyYXlzOwogIH0KfSk7Cgp9KSgpOwoKCgooZnVuY3Rp
        b24oKSB7Ci8qKgogIEBtb2R1bGUgZW1iZXItZGF0YQoqLwoKdmFyIGdldCA9
        IEVtYmVyLmdldCwgc2V0ID0gRW1iZXIuc2V0LCBtZXJnZSA9IEVtYmVyLm1l
        cmdlOwp2YXIgZm9yRWFjaCA9IEVtYmVyLkVudW1lcmFibGVVdGlscy5mb3JF
        YWNoOwp2YXIgcmVzb2x2ZSA9IEVtYmVyLlJTVlAucmVzb2x2ZTsKCnZhciBl
        cnJvclByb3BzID0gWydkZXNjcmlwdGlvbicsICdmaWxlTmFtZScsICdsaW5l
        TnVtYmVyJywgJ21lc3NhZ2UnLCAnbmFtZScsICdudW1iZXInLCAnc3RhY2sn
        XTsKCkRTLkludmFsaWRFcnJvciA9IGZ1bmN0aW9uKGVycm9ycykgewogIHZh
        ciB0bXAgPSBFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IuY2FsbCh0aGlz
        LCAiVGhlIGJhY2tlbmQgcmVqZWN0ZWQgdGhlIGNvbW1pdCBiZWNhdXNlIGl0
        IHdhcyBpbnZhbGlkOiAiICsgRW1iZXIuaW5zcGVjdChlcnJvcnMpKTsKICB0
        aGlzLmVycm9ycyA9IGVycm9yczsKCiAgZm9yICh2YXIgaT0wLCBsPWVycm9y
        UHJvcHMubGVuZ3RoOyBpPGw7IGkrKykgewogICAgdGhpc1tlcnJvclByb3Bz
        W2ldXSA9IHRtcFtlcnJvclByb3BzW2ldXTsKICB9Cn07CkRTLkludmFsaWRF
        cnJvci5wcm90b3R5cGUgPSBFbWJlci5jcmVhdGUoRXJyb3IucHJvdG90eXBl
        KTsKCmZ1bmN0aW9uIGlzVGhlbmFibGUob2JqZWN0KSB7CiAgcmV0dXJuIG9i
        amVjdCAmJiB0eXBlb2Ygb2JqZWN0LnRoZW4gPT09ICdmdW5jdGlvbic7Cn0K
        Ci8vIFNpbXBsZSBkaXNwYXRjaGVyIHRvIHN1cHBvcnQgb3ZlcnJpZGluZyB0
        aGUgYWxpYXNlZAovLyBtZXRob2QgaW4gc3ViY2xhc3Nlcy4KZnVuY3Rpb24g
        YWxpYXNNZXRob2QobWV0aG9kTmFtZSkgewogIHJldHVybiBmdW5jdGlvbigp
        IHsKICAgIHJldHVybiB0aGlzW21ldGhvZE5hbWVdLmFwcGx5KHRoaXMsIGFy
        Z3VtZW50cyk7CiAgfTsKfQoKLyoqCiAgQW4gYWRhcHRlciBpcyBhbiBvYmpl
        Y3QgdGhhdCByZWNlaXZlcyByZXF1ZXN0cyBmcm9tIGEgc3RvcmUgYW5kCiAg
        dHJhbnNsYXRlcyB0aGVtIGludG8gdGhlIGFwcHJvcHJpYXRlIGFjdGlvbiB0
        byB0YWtlIGFnYWluc3QgeW91cgogIHBlcnNpc3RlbmNlIGxheWVyLiBUaGUg
        cGVyc2lzdGVuY2UgbGF5ZXIgaXMgdXN1YWxseSBhbiBIVFRQIEFQSSwgYnV0
        IG1heQogIGJlIGFueXRoaW5nLCBzdWNoIGFzIHRoZSBicm93c2VyJ3MgbG9j
        YWwgc3RvcmFnZS4KCiAgIyMjIENyZWF0aW5nIGFuIEFkYXB0ZXIKCiAgRmly
        c3QsIGNyZWF0ZSBhIG5ldyBzdWJjbGFzcyBvZiBgRFMuQWRhcHRlcmA6Cgog
        ICAgICBBcHAuTXlBZGFwdGVyID0gRFMuQWRhcHRlci5leHRlbmQoewogICAg
        ICAgIC8vIC4uLnlvdXIgY29kZSBoZXJlCiAgICAgIH0pOwoKICBUbyB0ZWxs
        IHlvdXIgc3RvcmUgd2hpY2ggYWRhcHRlciB0byB1c2UsIHNldCBpdHMgYGFk
        YXB0ZXJgIHByb3BlcnR5OgoKICAgICAgQXBwLnN0b3JlID0gRFMuU3RvcmUu
        Y3JlYXRlKHsKICAgICAgICBhZGFwdGVyOiBBcHAuTXlBZGFwdGVyLmNyZWF0
        ZSgpCiAgICAgIH0pOwoKICBgRFMuQWRhcHRlcmAgaXMgYW4gYWJzdHJhY3Qg
        YmFzZSBjbGFzcyB0aGF0IHlvdSBzaG91bGQgb3ZlcnJpZGUgaW4geW91cgog
        IGFwcGxpY2F0aW9uIHRvIGN1c3RvbWl6ZSBpdCBmb3IgeW91ciBiYWNrZW5k
        LiBUaGUgbWluaW11bSBzZXQgb2YgbWV0aG9kcwogIHRoYXQgeW91IHNob3Vs
        ZCBpbXBsZW1lbnQgaXM6CgogICAgKiBgZmluZCgpYAogICAgKiBgY3JlYXRl
        UmVjb3JkKClgCiAgICAqIGB1cGRhdGVSZWNvcmQoKWAKICAgICogYGRlbGV0
        ZVJlY29yZCgpYAoKICBUbyBpbXByb3ZlIHRoZSBuZXR3b3JrIHBlcmZvcm1h
        bmNlIG9mIHlvdXIgYXBwbGljYXRpb24sIHlvdSBjYW4gb3B0aW1pemUKICB5
        b3VyIGFkYXB0ZXIgYnkgb3ZlcnJpZGluZyB0aGVzZSBsb3dlci1sZXZlbCBt
        ZXRob2RzOgoKICAgICogYGZpbmRNYW55KClgCiAgICAqIGBjcmVhdGVSZWNv
        cmRzKClgCiAgICAqIGB1cGRhdGVSZWNvcmRzKClgCiAgICAqIGBkZWxldGVS
        ZWNvcmRzKClgCiAgICAqIGBjb21taXQoKWAKCiAgRm9yIGFuIGV4YW1wbGUg
        aW1wbGVtZW50YXRpb24sIHNlZSBgRFMuUmVzdEFkYXB0ZXJgLCB0aGUKICBp
        bmNsdWRlZCBSRVNUIGFkYXB0ZXIuCgogIEBjbGFzcyBBZGFwdGVyCiAgQG5h
        bWVzcGFjZSBEUwogIEBleHRlbmRzIEVtYmVyLk9iamVjdAogIEB1c2VzIERT
        Ll9NYXBwYWJsZQoqLwoKRFMuQWRhcHRlciA9IEVtYmVyLk9iamVjdC5leHRl
        bmQoRFMuX01hcHBhYmxlLCB7CgogIC8qKgogICAgVGhlIGBmaW5kKClgIG1l
        dGhvZCBpcyBpbnZva2VkIHdoZW4gdGhlIHN0b3JlIGlzIGFza2VkIGZvciBh
        IHJlY29yZCB0aGF0CiAgICBoYXMgbm90IHByZXZpb3VzbHkgYmVlbiBsb2Fk
        ZWQuIEluIHJlc3BvbnNlIHRvIGBmaW5kKClgIGJlaW5nIGNhbGxlZCwgeW91
        CiAgICBzaG91bGQgcXVlcnkgeW91ciBwZXJzaXN0ZW5jZSBsYXllciBmb3Ig
        YSByZWNvcmQgd2l0aCB0aGUgZ2l2ZW4gSUQuIE9uY2UKICAgIGZvdW5kLCB5
        b3UgY2FuIGFzeW5jaHJvbm91c2x5IGNhbGwgdGhlIHN0b3JlJ3MgYGxvYWQo
        KWAgbWV0aG9kIHRvIGxvYWQKICAgIHRoZSByZWNvcmQuCgogICAgSGVyZSBp
        cyBhbiBleGFtcGxlIGBmaW5kYCBpbXBsZW1lbnRhdGlvbjoKCiAgICAgICAg
        ZmluZDogZnVuY3Rpb24oc3RvcmUsIHR5cGUsIGlkKSB7CiAgICAgICAgICB2
        YXIgdXJsID0gdHlwZS51cmw7CiAgICAgICAgICB1cmwgPSB1cmwuZm10KGlk
        KTsKCiAgICAgICAgICBqUXVlcnkuZ2V0SlNPTih1cmwsIGZ1bmN0aW9uKGRh
        dGEpIHsKICAgICAgICAgICAgICAvLyBkYXRhIGlzIGEgaGFzaCBvZiBrZXkv
        dmFsdWUgcGFpcnMuIElmIHlvdXIgc2VydmVyIHJldHVybnMgYQogICAgICAg
        ICAgICAgIC8vIHJvb3QsIHNpbXBseSBkbyBzb21ldGhpbmcgbGlrZToKICAg
        ICAgICAgICAgICAvLyBzdG9yZS5sb2FkKHR5cGUsIGlkLCBkYXRhLnBlcnNv
        bikKICAgICAgICAgICAgICBzdG9yZS5sb2FkKHR5cGUsIGlkLCBkYXRhKTsK
        ICAgICAgICAgIH0pOwogICAgICAgIH0KCiAgICBAbWV0aG9kIGZpbmQKICAq
        LwogIGZpbmQ6IEVtYmVyLnJlcXVpcmVkKEZ1bmN0aW9uKSwKCiAgLyoqCiAg
        ICBPcHRpb25hbAoKICAgIEBtZXRob2QgZmluZEFsbAogICAgQHBhcmFtICBz
        dG9yZQogICAgQHBhcmFtICB0eXBlCiAgICBAcGFyYW0gIHNpbmNlCiAgKi8K
        ICBmaW5kQWxsOiBudWxsLAoKICAvKioKICAgIE9wdGlvbmFsCgogICAgQG1l
        dGhvZCBmaW5kUXVlcnkKICAgIEBwYXJhbSAgc3RvcmUKICAgIEBwYXJhbSAg
        dHlwZQogICAgQHBhcmFtICBxdWVyeQogICAgQHBhcmFtICByZWNvcmRBcnJh
        eQogICovCiAgZmluZFF1ZXJ5OiBudWxsLAoKICAvKioKICAgIElmIHRoZSBn
        bG9iYWxseSB1bmlxdWUgSURzIGZvciB5b3VyIHJlY29yZHMgc2hvdWxkIGJl
        IGdlbmVyYXRlZCBvbiB0aGUgY2xpZW50LAogICAgaW1wbGVtZW50IHRoZSBg
        Z2VuZXJhdGVJZEZvclJlY29yZCgpYCBtZXRob2QuIFRoaXMgbWV0aG9kIHdp
        bGwgYmUgaW52b2tlZAogICAgZWFjaCB0aW1lIHlvdSBjcmVhdGUgYSBuZXcg
        cmVjb3JkLCBhbmQgdGhlIHZhbHVlIHJldHVybmVkIGZyb20gaXQgd2lsbCBi
        ZQogICAgYXNzaWduZWQgdG8gdGhlIHJlY29yZCdzIGBwcmltYXJ5S2V5YC4K
        CiAgICBNb3N0IHRyYWRpdGlvbmFsIFJFU1QtbGlrZSBIVFRQIEFQSXMgd2ls
        bCBub3QgdXNlIHRoaXMgbWV0aG9kLiBJbnN0ZWFkLCB0aGUgSUQKICAgIG9m
        IHRoZSByZWNvcmQgd2lsbCBiZSBzZXQgYnkgdGhlIHNlcnZlciwgYW5kIHlv
        dXIgYWRhcHRlciB3aWxsIHVwZGF0ZSB0aGUgc3RvcmUKICAgIHdpdGggdGhl
        IG5ldyBJRCB3aGVuIGl0IGNhbGxzIGBkaWRDcmVhdGVSZWNvcmQoKWAuIE9u
        bHkgaW1wbGVtZW50IHRoaXMgbWV0aG9kIGlmCiAgICB5b3UgaW50ZW5kIHRv
        IGdlbmVyYXRlIHJlY29yZCBJRHMgb24gdGhlIGNsaWVudC1zaWRlLgoKICAg
        IFRoZSBgZ2VuZXJhdGVJZEZvclJlY29yZCgpYCBtZXRob2Qgd2lsbCBiZSBp
        bnZva2VkIHdpdGggdGhlIHJlcXVlc3Rpbmcgc3RvcmUgYXMKICAgIHRoZSBm
        aXJzdCBwYXJhbWV0ZXIgYW5kIHRoZSBuZXdseSBjcmVhdGVkIHJlY29yZCBh
        cyB0aGUgc2Vjb25kIHBhcmFtZXRlcjoKCiAgICAgICAgZ2VuZXJhdGVJZEZv
        clJlY29yZDogZnVuY3Rpb24oc3RvcmUsIHJlY29yZCkgewogICAgICAgICAg
        dmFyIHV1aWQgPSBBcHAuZ2VuZXJhdGVVVUlEV2l0aFN0YXRpc3RpY2FsbHlM
        b3dPZGRzT2ZDb2xsaXNpb24oKTsKICAgICAgICAgIHJldHVybiB1dWlkOwog
        ICAgICAgIH0KCiAgICBAbWV0aG9kIGdlbmVyYXRlSWRGb3JSZWNvcmQKICAg
        IEBwYXJhbSB7RFMuU3RvcmV9IHN0b3JlCiAgICBAcGFyYW0ge0RTLk1vZGVs
        fSByZWNvcmQKICAqLwogIGdlbmVyYXRlSWRGb3JSZWNvcmQ6IG51bGwsCgog
        IC8qKgogICAgUHJveGllcyB0byB0aGUgc2VyaWFsaXplcidzIGBzZXJpYWxp
        emVgIG1ldGhvZC4KCiAgICBAbWV0aG9kIHNlcmlhbGl6ZQogICAgQHBhcmFt
        IHtEUy5Nb2RlbH0gcmVjb3JkCiAgICBAcGFyYW0ge09iamVjdH0gICBvcHRp
        b25zCiAgKi8KICBzZXJpYWxpemU6IGZ1bmN0aW9uKHJlY29yZCwgb3B0aW9u
        cykgewogICAgcmV0dXJuIGdldChyZWNvcmQsICdzdG9yZScpLnNlcmlhbGl6
        ZXJGb3IocmVjb3JkLmNvbnN0cnVjdG9yLnR5cGVLZXkpLnNlcmlhbGl6ZShy
        ZWNvcmQsIG9wdGlvbnMpOwogIH0sCgogIC8qKgogICAgSW1wbGVtZW50IHRo
        aXMgbWV0aG9kIGluIGEgc3ViY2xhc3MgdG8gaGFuZGxlIHRoZSBjcmVhdGlv
        biBvZgogICAgbmV3IHJlY29yZHMuCgogICAgU2VyaWFsaXplcyB0aGUgcmVj
        b3JkIGFuZCBzZW5kIGl0IHRvIHRoZSBzZXJ2ZXIuCgogICAgVGhpcyBpbXBs
        ZW1lbnRhdGlvbiBzaG91bGQgY2FsbCB0aGUgYWRhcHRlcidzIGBkaWRDcmVh
        dGVSZWNvcmRgCiAgICBtZXRob2Qgb24gc3VjY2VzcyBvciBgZGlkRXJyb3Jg
        IG1ldGhvZCBvbiBmYWlsdXJlLgoKICAgIEBtZXRob2QgY3JlYXRlUmVjb3Jk
        CiAgICBAcHJvcGVydHkge0RTLlN0b3JlfSBzdG9yZQogICAgQHByb3BlcnR5
        IHtzdWJjbGFzcyBvZiBEUy5Nb2RlbH0gdHlwZSAgIHRoZSBEUy5Nb2RlbCBj
        bGFzcyBvZiB0aGUgcmVjb3JkCiAgICBAcHJvcGVydHkge0RTLk1vZGVsfSBy
        ZWNvcmQKICAqLwogIGNyZWF0ZVJlY29yZDogRW1iZXIucmVxdWlyZWQoRnVu
        Y3Rpb24pLAoKICAvKioKICAgIEltcGxlbWVudCB0aGlzIG1ldGhvZCBpbiBh
        IHN1YmNsYXNzIHRvIGhhbmRsZSB0aGUgdXBkYXRpbmcgb2YKICAgIGEgcmVj
        b3JkLgoKICAgIFNlcmlhbGl6ZXMgdGhlIHJlY29yZCB1cGRhdGUgYW5kIHNl
        bmQgaXQgdG8gdGhlIHNlcnZlci4KCiAgICBAbWV0aG9kIHVwZGF0ZVJlY29y
        ZAogICAgQHByb3BlcnR5IHtEUy5TdG9yZX0gc3RvcmUKICAgIEBwcm9wZXJ0
        eSB7c3ViY2xhc3Mgb2YgRFMuTW9kZWx9IHR5cGUgICB0aGUgRFMuTW9kZWwg
        Y2xhc3Mgb2YgdGhlIHJlY29yZAogICAgQHByb3BlcnR5IHtEUy5Nb2RlbH0g
        cmVjb3JkCiAgKi8KICB1cGRhdGVSZWNvcmQ6IEVtYmVyLnJlcXVpcmVkKEZ1
        bmN0aW9uKSwKCiAgLyoqCiAgICBJbXBsZW1lbnQgdGhpcyBtZXRob2QgaW4g
        YSBzdWJjbGFzcyB0byBoYW5kbGUgdGhlIGRlbGV0aW9uIG9mCiAgICBhIHJl
        Y29yZC4KCiAgICBTZW5kcyBhIGRlbGV0ZSByZXF1ZXN0IGZvciB0aGUgcmVj
        b3JkIHRvIHRoZSBzZXJ2ZXIuCgogICAgQG1ldGhvZCBkZWxldGVSZWNvcmQK
        ICAgIEBwcm9wZXJ0eSB7RFMuU3RvcmV9IHN0b3JlCiAgICBAcHJvcGVydHkg
        e3N1YmNsYXNzIG9mIERTLk1vZGVsfSB0eXBlICAgdGhlIERTLk1vZGVsIGNs
        YXNzIG9mIHRoZSByZWNvcmQKICAgIEBwcm9wZXJ0eSB7RFMuTW9kZWx9IHJl
        Y29yZAogICovCiAgZGVsZXRlUmVjb3JkOiBFbWJlci5yZXF1aXJlZChGdW5j
        dGlvbiksCgogIC8qKgogICAgRmluZCBtdWx0aXBsZSByZWNvcmRzIGF0IG9u
        Y2UuCgogICAgQnkgZGVmYXVsdCwgaXQgbG9vcHMgb3ZlciB0aGUgcHJvdmlk
        ZWQgaWRzIGFuZCBjYWxscyBgZmluZGAgb24gZWFjaC4KICAgIE1heSBiZSBv
        dmVyd3JpdHRlbiB0byBpbXByb3ZlIHBlcmZvcm1hbmNlIGFuZCByZWR1Y2Ug
        dGhlIG51bWJlciBvZgogICAgc2VydmVyIHJlcXVlc3RzLgoKICAgIEBtZXRo
        b2QgZmluZE1hbnkKICAgIEBwcm9wZXJ0eSB7RFMuU3RvcmV9IHN0b3JlCiAg
        ICBAcHJvcGVydHkge3N1YmNsYXNzIG9mIERTLk1vZGVsfSB0eXBlICAgdGhl
        IERTLk1vZGVsIGNsYXNzIG9mIHRoZSByZWNvcmRzCiAgICBAcHJvcGVydHkg
        e0FycmF5fSAgICBpZHMKICAqLwogIGZpbmRNYW55OiBmdW5jdGlvbihzdG9y
        ZSwgdHlwZSwgaWRzKSB7CiAgICB2YXIgcHJvbWlzZXMgPSBpZHMubWFwKGZ1
        bmN0aW9uKGlkKSB7CiAgICAgIHJldHVybiB0aGlzLmZpbmQoc3RvcmUsIHR5
        cGUsIGlkKTsKICAgIH0sIHRoaXMpOwoKICAgIHJldHVybiBFbWJlci5SU1ZQ
        LmFsbChwcm9taXNlcyk7CiAgfQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigp
        IHsKLyoqCiAgQG1vZHVsZSBlbWJlci1kYXRhCiovCgp2YXIgZ2V0ID0gRW1i
        ZXIuZ2V0LCBmbXQgPSBFbWJlci5TdHJpbmcuZm10LAogICAgaW5kZXhPZiA9
        IEVtYmVyLkVudW1lcmFibGVVdGlscy5pbmRleE9mOwoKdmFyIGNvdW50ZXIg
        PSAwOwoKLyoqCiAgYERTLkZpeHR1cmVBZGFwdGVyYCBpcyBhbiBhZGFwdGVy
        IHRoYXQgbG9hZHMgcmVjb3JkcyBmcm9tIG1lbW9yeS4KICBJdHMgcHJpbWFy
        aWx5IHVzZWQgZm9yIGRldmVsb3BtZW50IGFuZCB0ZXN0aW5nLiBZb3UgY2Fu
        IGFsc28gdXNlCiAgYERTLkZpeHR1cmVBZGFwdGVyYCB3aGlsZSB3b3JraW5n
        IG9uIHRoZSBBUEkgYnV0IGFyZSBub3QgcmVhZHkgdG8KICBpbnRlZ3JhdGUg
        eWV0LiBJdCBpcyBhIGZ1bGx5IGZ1bmN0aW9uaW5nIGFkYXB0ZXIuIEFsbCBD
        UlVEIG1ldGhvZHMKICBhcmUgaW1wbGVtZW50ZWQuIFlvdSBjYW4gYWxzbyBp
        bXBsZW1lbnQgcXVlcnkgbG9naWMgdGhhdCBhIHJlbW90ZQogIHN5c3RlbSB3
        b3VsZCBkby4gSXRzIHBvc3NpYmxlIHRvIGRvIGRldmVsb3AgeW91ciBlbnRp
        cmUgYXBwbGljYXRpb24KICB3aXRoIGBEUy5GaXh0dXJlQWRhcHRlcmAuCgog
        IEBjbGFzcyBGaXh0dXJlQWRhcHRlcgogIEBuYW1lc3BhY2UgRFMKICBAZXh0
        ZW5kcyBEUy5BZGFwdGVyCiovCkRTLkZpeHR1cmVBZGFwdGVyID0gRFMuQWRh
        cHRlci5leHRlbmQoewogIC8vIGJ5IGRlZmF1bHQsIGZpeHR1cmVzIGFyZSBh
        bHJlYWR5IGluIG5vcm1hbGl6ZWQgZm9ybQogIHNlcmlhbGl6ZXI6IG51bGws
        CgogIHNpbXVsYXRlUmVtb3RlUmVzcG9uc2U6IHRydWUsCgogIGxhdGVuY3k6
        IDUwLAoKICAvKioKICAgIEltcGxlbWVudCB0aGlzIG1ldGhvZCBpbiBvcmRl
        ciB0byBwcm92aWRlIGRhdGEgYXNzb2NpYXRlZCB3aXRoIGEgdHlwZQoKICAg
        IEBtZXRob2QgZml4dHVyZXNGb3JUeXBlCiAgICBAcGFyYW0gIHR5cGUKICAq
        LwogIGZpeHR1cmVzRm9yVHlwZTogZnVuY3Rpb24odHlwZSkgewogICAgaWYg
        KHR5cGUuRklYVFVSRVMpIHsKICAgICAgdmFyIGZpeHR1cmVzID0gRW1iZXIu
        QSh0eXBlLkZJWFRVUkVTKTsKICAgICAgcmV0dXJuIGZpeHR1cmVzLm1hcChm
        dW5jdGlvbihmaXh0dXJlKXsKICAgICAgICB2YXIgZml4dHVyZUlkVHlwZSA9
        IHR5cGVvZiBmaXh0dXJlLmlkOwogICAgICAgIGlmKGZpeHR1cmVJZFR5cGUg
        IT09ICJudW1iZXIiICYmIGZpeHR1cmVJZFR5cGUgIT09ICJzdHJpbmciKXsK
        ICAgICAgICAgIHRocm93IG5ldyBFcnJvcihmbXQoJ3RoZSBpZCBwcm9wZXJ0
        eSBtdXN0IGJlIGRlZmluZWQgYXMgYSBudW1iZXIgb3Igc3RyaW5nIGZvciBm
        aXh0dXJlICVAJywgW2ZpeHR1cmVdKSk7CiAgICAgICAgfQogICAgICAgIGZp
        eHR1cmUuaWQgPSBmaXh0dXJlLmlkICsgJyc7CiAgICAgICAgcmV0dXJuIGZp
        eHR1cmU7CiAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIG51bGw7CiAgfSwK
        CiAgLyoqCiAgICBJbXBsZW1lbnQgdGhpcyBtZXRob2QgaW4gb3JkZXIgdG8g
        cXVlcnkgZml4dHVyZXMgZGF0YQoKICAgIEBtZXRob2QgcXVlcnlGaXh0dXJl
        cwogICAgQHBhcmFtICBmaXh0dXJlCiAgICBAcGFyYW0gIHF1ZXJ5CiAgICBA
        cGFyYW0gIHR5cGUKICAqLwogIHF1ZXJ5Rml4dHVyZXM6IGZ1bmN0aW9uKGZp
        eHR1cmVzLCBxdWVyeSwgdHlwZSkgewogICAgRW1iZXIuYXNzZXJ0KCdOb3Qg
        aW1wbGVtZW50ZWQ6IFlvdSBtdXN0IG92ZXJyaWRlIHRoZSBEUy5GaXh0dXJl
        QWRhcHRlcjo6cXVlcnlGaXh0dXJlcyBtZXRob2QgdG8gc3VwcG9ydCBxdWVy
        eWluZyB0aGUgZml4dHVyZSBzdG9yZS4nKTsKICB9LAoKICAvKioKICAgIEBt
        ZXRob2QgdXBkYXRlRml4dHVyZXMKICAgIEBwYXJhbSAgdHlwZQogICAgQHBh
        cmFtICBmaXh0dXJlCiAgKi8KICB1cGRhdGVGaXh0dXJlczogZnVuY3Rpb24o
        dHlwZSwgZml4dHVyZSkgewogICAgaWYoIXR5cGUuRklYVFVSRVMpIHsKICAg
        ICAgdHlwZS5GSVhUVVJFUyA9IFtdOwogICAgfQoKICAgIHZhciBmaXh0dXJl
        cyA9IHR5cGUuRklYVFVSRVM7CgogICAgdGhpcy5kZWxldGVMb2FkZWRGaXh0
        dXJlKHR5cGUsIGZpeHR1cmUpOwoKICAgIGZpeHR1cmVzLnB1c2goZml4dHVy
        ZSk7CiAgfSwKCiAgLyoqCiAgICBJbXBsZW1lbnQgdGhpcyBtZXRob2QgaW4g
        b3JkZXIgdG8gcHJvdmlkZSBwcm92aWRlIGpzb24gZm9yIENSVUQgbWV0aG9k
        cwoKICAgIEBtZXRob2QgbW9ja0pTT04KICAgIEBwYXJhbSAgdHlwZQogICAg
        QHBhcmFtICByZWNvcmQKICAqLwogIG1vY2tKU09OOiBmdW5jdGlvbihzdG9y
        ZSwgdHlwZSwgcmVjb3JkKSB7CiAgICByZXR1cm4gc3RvcmUuc2VyaWFsaXpl
        ckZvcih0eXBlKS5zZXJpYWxpemUocmVjb3JkLCB7IGluY2x1ZGVJZDogdHJ1
        ZSB9KTsKICB9LAoKICAvKioKICAgIEBtZXRob2QgZ2VuZXJhdGVJZEZvclJl
        Y29yZAogICAgQHBhcmFtICBzdG9yZQogICAgQHBhcmFtICByZWNvcmQKICAq
        LwogIGdlbmVyYXRlSWRGb3JSZWNvcmQ6IGZ1bmN0aW9uKHN0b3JlKSB7CiAg
        ICByZXR1cm4gY291bnRlcisrOwogIH0sCgogIC8qKgogICAgQG1ldGhvZCBm
        aW5kCiAgICBAcGFyYW0gIHN0b3JlCiAgICBAcGFyYW0gIHR5cGUKICAgIEBw
        YXJhbSAgaWQKICAqLwogIGZpbmQ6IGZ1bmN0aW9uKHN0b3JlLCB0eXBlLCBp
        ZCkgewogICAgdmFyIGZpeHR1cmVzID0gdGhpcy5maXh0dXJlc0ZvclR5cGUo
        dHlwZSksCiAgICAgICAgZml4dHVyZTsKCiAgICBFbWJlci53YXJuKCJVbmFi
        bGUgdG8gZmluZCBmaXh0dXJlcyBmb3IgbW9kZWwgdHlwZSAiICsgdHlwZS50
        b1N0cmluZygpLCBmaXh0dXJlcyk7CgogICAgaWYgKGZpeHR1cmVzKSB7CiAg
        ICAgIGZpeHR1cmUgPSBFbWJlci5BKGZpeHR1cmVzKS5maW5kUHJvcGVydHko
        J2lkJywgaWQpOwogICAgfQoKICAgIGlmIChmaXh0dXJlKSB7CiAgICAgIHJl
        dHVybiB0aGlzLnNpbXVsYXRlUmVtb3RlQ2FsbChmdW5jdGlvbigpIHsKICAg
        ICAgICByZXR1cm4gZml4dHVyZTsKICAgICAgfSwgdGhpcyk7CiAgICB9CiAg
        fSwKCiAgLyoqCiAgICBAbWV0aG9kIGZpbmRNYW55CiAgICBAcGFyYW0gIHN0
        b3JlCiAgICBAcGFyYW0gIHR5cGUKICAgIEBwYXJhbSAgaWRzCiAgKi8KICBm
        aW5kTWFueTogZnVuY3Rpb24oc3RvcmUsIHR5cGUsIGlkcykgewogICAgdmFy
        IGZpeHR1cmVzID0gdGhpcy5maXh0dXJlc0ZvclR5cGUodHlwZSk7CgogICAg
        RW1iZXIuYXNzZXJ0KCJVbmFibGUgdG8gZmluZCBmaXh0dXJlcyBmb3IgbW9k
        ZWwgdHlwZSAiK3R5cGUudG9TdHJpbmcoKSwgISFmaXh0dXJlcyk7CgogICAg
        aWYgKGZpeHR1cmVzKSB7CiAgICAgIGZpeHR1cmVzID0gZml4dHVyZXMuZmls
        dGVyKGZ1bmN0aW9uKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaW5kZXhPZihp
        ZHMsIGl0ZW0uaWQpICE9PSAtMTsKICAgICAgfSk7CiAgICB9CgogICAgaWYg
        KGZpeHR1cmVzKSB7CiAgICAgIHJldHVybiB0aGlzLnNpbXVsYXRlUmVtb3Rl
        Q2FsbChmdW5jdGlvbigpIHsKICAgICAgICByZXR1cm4gZml4dHVyZXM7CiAg
        ICAgIH0sIHRoaXMpOwogICAgfQogIH0sCgogIC8qKgogICAgQG1ldGhvZCBm
        aW5kQWxsCiAgICBAcGFyYW0gIHN0b3JlCiAgICBAcGFyYW0gIHR5cGUKICAq
        LwogIGZpbmRBbGw6IGZ1bmN0aW9uKHN0b3JlLCB0eXBlKSB7CiAgICB2YXIg
        Zml4dHVyZXMgPSB0aGlzLmZpeHR1cmVzRm9yVHlwZSh0eXBlKTsKCiAgICBF
        bWJlci5hc3NlcnQoIlVuYWJsZSB0byBmaW5kIGZpeHR1cmVzIGZvciBtb2Rl
        bCB0eXBlICIrdHlwZS50b1N0cmluZygpLCAhIWZpeHR1cmVzKTsKCiAgICBy
        ZXR1cm4gdGhpcy5zaW11bGF0ZVJlbW90ZUNhbGwoZnVuY3Rpb24oKSB7CiAg
        ICAgIHJldHVybiBmaXh0dXJlczsKICAgIH0sIHRoaXMpOwogIH0sCgogIC8q
        KgogICAgQG1ldGhvZCBmaW5kUXVlcnkKICAgIEBwYXJhbSAgc3RvcmUKICAg
        IEBwYXJhbSAgdHlwZQogICAgQHBhcmFtICBxdWVyeQogICAgQHBhcmFtICBh
        cnJheQogICovCiAgZmluZFF1ZXJ5OiBmdW5jdGlvbihzdG9yZSwgdHlwZSwg
        cXVlcnksIGFycmF5KSB7CiAgICB2YXIgZml4dHVyZXMgPSB0aGlzLmZpeHR1
        cmVzRm9yVHlwZSh0eXBlKTsKCiAgICBFbWJlci5hc3NlcnQoIlVuYWJsZSB0
        byBmaW5kIGZpeHR1cmVzIGZvciBtb2RlbCB0eXBlICIrdHlwZS50b1N0cmlu
        ZygpLCAhIWZpeHR1cmVzKTsKCiAgICBmaXh0dXJlcyA9IHRoaXMucXVlcnlG
        aXh0dXJlcyhmaXh0dXJlcywgcXVlcnksIHR5cGUpOwoKICAgIGlmIChmaXh0
        dXJlcykgewogICAgICByZXR1cm4gdGhpcy5zaW11bGF0ZVJlbW90ZUNhbGwo
        ZnVuY3Rpb24oKSB7CiAgICAgICAgcmV0dXJuIGZpeHR1cmVzOwogICAgICB9
        LCB0aGlzKTsKICAgIH0KICB9LAoKICAvKioKICAgIEBtZXRob2QgY3JlYXRl
        UmVjb3JkCiAgICBAcGFyYW0gIHN0b3JlCiAgICBAcGFyYW0gIHR5cGUKICAg
        IEBwYXJhbSAgcmVjb3JkCiAgKi8KICBjcmVhdGVSZWNvcmQ6IGZ1bmN0aW9u
        KHN0b3JlLCB0eXBlLCByZWNvcmQpIHsKICAgIHZhciBmaXh0dXJlID0gdGhp
        cy5tb2NrSlNPTihzdG9yZSwgdHlwZSwgcmVjb3JkKTsKCiAgICB0aGlzLnVw
        ZGF0ZUZpeHR1cmVzKHR5cGUsIGZpeHR1cmUpOwoKICAgIHJldHVybiB0aGlz
        LnNpbXVsYXRlUmVtb3RlQ2FsbChmdW5jdGlvbigpIHsKICAgICAgcmV0dXJu
        IGZpeHR1cmU7CiAgICB9LCB0aGlzKTsKICB9LAoKICAvKioKICAgIEBtZXRo
        b2QgdXBkYXRlUmVjb3JkCiAgICBAcGFyYW0gIHN0b3JlCiAgICBAcGFyYW0g
        IHR5cGUKICAgIEBwYXJhbSAgcmVjb3JkCiAgKi8KICB1cGRhdGVSZWNvcmQ6
        IGZ1bmN0aW9uKHN0b3JlLCB0eXBlLCByZWNvcmQpIHsKICAgIHZhciBmaXh0
        dXJlID0gdGhpcy5tb2NrSlNPTihzdG9yZSwgdHlwZSwgcmVjb3JkKTsKCiAg
        ICB0aGlzLnVwZGF0ZUZpeHR1cmVzKHR5cGUsIGZpeHR1cmUpOwoKICAgIHJl
        dHVybiB0aGlzLnNpbXVsYXRlUmVtb3RlQ2FsbChmdW5jdGlvbigpIHsKICAg
        ICAgcmV0dXJuIGZpeHR1cmU7CiAgICB9LCB0aGlzKTsKICB9LAoKICAvKioK
        ICAgIEBtZXRob2QgZGVsZXRlUmVjb3JkCiAgICBAcGFyYW0gIHN0b3JlCiAg
        ICBAcGFyYW0gIHR5cGUKICAgIEBwYXJhbSAgcmVjb3JkCiAgKi8KICBkZWxl
        dGVSZWNvcmQ6IGZ1bmN0aW9uKHN0b3JlLCB0eXBlLCByZWNvcmQpIHsKICAg
        IHZhciBmaXh0dXJlID0gdGhpcy5tb2NrSlNPTihzdG9yZSwgdHlwZSwgcmVj
        b3JkKTsKCiAgICB0aGlzLmRlbGV0ZUxvYWRlZEZpeHR1cmUodHlwZSwgZml4
        dHVyZSk7CgogICAgcmV0dXJuIHRoaXMuc2ltdWxhdGVSZW1vdGVDYWxsKGZ1
        bmN0aW9uKCkgewogICAgICAvLyBubyBwYXlsb2FkIGluIGEgZGVsZXRpb24K
        ICAgICAgcmV0dXJuIG51bGw7CiAgICB9KTsKICB9LAoKICAvKgogICAgQG1l
        dGhvZCBkZWxldGVMb2FkZWRGaXh0dXJlCiAgICBAcHJpdmF0ZQogICAgQHBh
        cmFtIHR5cGUKICAgIEBwYXJhbSByZWNvcmQKICAqLwogIGRlbGV0ZUxvYWRl
        ZEZpeHR1cmU6IGZ1bmN0aW9uKHR5cGUsIHJlY29yZCkgewogICAgdmFyIGV4
        aXN0aW5nRml4dHVyZSA9IHRoaXMuZmluZEV4aXN0aW5nRml4dHVyZSh0eXBl
        LCByZWNvcmQpOwoKICAgIGlmKGV4aXN0aW5nRml4dHVyZSkgewogICAgICB2
        YXIgaW5kZXggPSBpbmRleE9mKHR5cGUuRklYVFVSRVMsIGV4aXN0aW5nRml4
        dHVyZSk7CiAgICAgIHR5cGUuRklYVFVSRVMuc3BsaWNlKGluZGV4LCAxKTsK
        ICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfSwKCiAgLyoKICAgIEBtZXRo
        b2QgZmluZEV4aXN0aW5nRml4dHVyZQogICAgQHByaXZhdGUKICAgIEBwYXJh
        bSB0eXBlCiAgICBAcGFyYW0gcmVjb3JkCiAgKi8KICBmaW5kRXhpc3RpbmdG
        aXh0dXJlOiBmdW5jdGlvbih0eXBlLCByZWNvcmQpIHsKICAgIHZhciBmaXh0
        dXJlcyA9IHRoaXMuZml4dHVyZXNGb3JUeXBlKHR5cGUpOwogICAgdmFyIGlk
        ID0gZ2V0KHJlY29yZCwgJ2lkJyk7CgogICAgcmV0dXJuIHRoaXMuZmluZEZp
        eHR1cmVCeUlkKGZpeHR1cmVzLCBpZCk7CiAgfSwKCiAgLyoKICAgIEBtZXRo
        b2QgZmluZEZpeHR1cmVCeUlkCiAgICBAcHJpdmF0ZQogICAgQHBhcmFtIHR5
        cGUKICAgIEBwYXJhbSByZWNvcmQKICAqLwogIGZpbmRGaXh0dXJlQnlJZDog
        ZnVuY3Rpb24oZml4dHVyZXMsIGlkKSB7CiAgICByZXR1cm4gRW1iZXIuQShm
        aXh0dXJlcykuZmluZChmdW5jdGlvbihyKSB7CiAgICAgIGlmKCcnK2dldChy
        LCAnaWQnKSA9PT0gJycraWQpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAg
        ICAgfSBlbHNlIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAg
        IH0pOwogIH0sCgogIC8qCiAgICBAbWV0aG9kIHNpbXVsYXRlUmVtb3RlQ2Fs
        bAogICAgQHByaXZhdGUKICAgIEBwYXJhbSBjYWxsYmFjawogICAgQHBhcmFt
        IGNvbnRleHQKICAqLwogIHNpbXVsYXRlUmVtb3RlQ2FsbDogZnVuY3Rpb24o
        Y2FsbGJhY2ssIGNvbnRleHQpIHsKICAgIHZhciBhZGFwdGVyID0gdGhpczsK
        CiAgICByZXR1cm4gbmV3IEVtYmVyLlJTVlAuUHJvbWlzZShmdW5jdGlvbihy
        ZXNvbHZlKSB7CiAgICAgIGlmIChnZXQoYWRhcHRlciwgJ3NpbXVsYXRlUmVt
        b3RlUmVzcG9uc2UnKSkgewogICAgICAgIC8vIFNjaGVkdWxlIHdpdGggc2V0
        VGltZW91dAogICAgICAgIEVtYmVyLnJ1bi5sYXRlcihmdW5jdGlvbigpIHsK
        ICAgICAgICAgIHJlc29sdmUoY2FsbGJhY2suY2FsbChjb250ZXh0KSk7CiAg
        ICAgICAgfSwgZ2V0KGFkYXB0ZXIsICdsYXRlbmN5JykpOwogICAgICB9IGVs
        c2UgewogICAgICAgIC8vIEFzeW5jaHJvbm91cywgYnV0IGF0IHRoZSBvZiB0
        aGUgcnVubG9vcCB3aXRoIHplcm8gbGF0ZW5jeQogICAgICAgIEVtYmVyLnJ1
        bi5vbmNlKGZ1bmN0aW9uKCkgewogICAgICAgICAgcmVzb2x2ZShjYWxsYmFj
        ay5jYWxsKGNvbnRleHQpKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSk7
        CiAgfQp9KTsKCn0pKCk7CgoKCihmdW5jdGlvbigpIHsKLyoqCiAgQG1vZHVs
        ZSBlbWJlci1kYXRhCiovCgp2YXIgZ2V0ID0gRW1iZXIuZ2V0LCBzZXQgPSBF
        bWJlci5zZXQ7CgpEUy5yZWplY3Rpb25IYW5kbGVyID0gZnVuY3Rpb24ocmVh
        c29uKSB7CiAgRW1iZXIuTG9nZ2VyLmFzc2VydChbcmVhc29uLCByZWFzb24u
        bWVzc2FnZSwgcmVhc29uLnN0YWNrXSk7CgogIHRocm93IHJlYXNvbjsKfTsK
        CmZ1bmN0aW9uIGNvZXJjZUlkKGlkKSB7CiAgcmV0dXJuIGlkID09IG51bGwg
        PyBudWxsIDogaWQrJyc7Cn0KCkRTLlJFU1RTZXJpYWxpemVyID0gRFMuSlNP
        TlNlcmlhbGl6ZXIuZXh0ZW5kKHsKICAvKioKICAgIE5vcm1hbGl6ZXMgYSBw
        YXJ0IG9mIHRoZSBKU09OIHBheWxvYWQgcmV0dXJuZWQgYnkKICAgIHRoZSBz
        ZXJ2ZXIuIFlvdSBzaG91bGQgb3ZlcnJpZGUgdGhpcyBtZXRob2QsIG11bmdl
        IHRoZSBoYXNoCiAgICBhbmQgY2FsbCBzdXBlciBpZiB5b3UgaGF2ZSBnZW5l
        cmljIG5vcm1hbGl6YXRpb24gdG8gZG8uCgogICAgSXQgdGFrZXMgdGhlIHR5
        cGUgb2YgdGhlIHJlY29yZCB0aGF0IGlzIGJlaW5nIG5vcm1hbGl6ZWQKICAg
        IChhcyBhIERTLk1vZGVsIGNsYXNzKSwgdGhlIHByb3BlcnR5IHdoZXJlIHRo
        ZSBoYXNoIHdhcwogICAgb3JpZ2luYWxseSBmb3VuZCwgYW5kIHRoZSBoYXNo
        IHRvIG5vcm1hbGl6ZS4KCiAgICBGb3IgZXhhbXBsZSwgaWYgeW91IGhhdmUg
        YSBwYXlsb2FkIHRoYXQgbG9va3MgbGlrZSB0aGlzOgoKICAgIGBgYGpzCiAg
        ICB7CiAgICAgICJwb3N0IjogewogICAgICAgICJpZCI6IDEsCiAgICAgICAg
        InRpdGxlIjogIlJhaWxzIGlzIG9tYWthc2UiLAogICAgICAgICJjb21tZW50
        cyI6IFsgMSwgMiBdCiAgICAgIH0sCiAgICAgICJjb21tZW50cyI6IFt7CiAg
        ICAgICAgImlkIjogMSwKICAgICAgICAiYm9keSI6ICJGSVJTVCIKICAgICAg
        fSwgewogICAgICAgICJpZCI6IDIsCiAgICAgICAgImJvZHkiOiAiUmFpbHMg
        aXMgdW5hZ2kiCiAgICAgIH1dCiAgICB9CiAgICBgYGAKCiAgICBUaGUgYG5v
        cm1hbGl6ZWAgbWV0aG9kIHdpbGwgYmUgY2FsbGVkIHRocmVlIHRpbWVzOgoK
        ICAgICogV2l0aCBgQXBwLlBvc3RgLCBgInBvc3RzImAgYW5kIGB7IGlkOiAx
        LCB0aXRsZTogIlJhaWxzIGlzIG9tYWthc2UiLCAuLi4gfWAKICAgICogV2l0
        aCBgQXBwLkNvbW1lbnRgLCBgImNvbW1lbnRzImAgYW5kIGB7IGlkOiAxLCBi
        b2R5OiAiRklSU1QiIH1gCiAgICAqIFdpdGggYEFwcC5Db21tZW50YCwgYCJj
        b21tZW50cyJgIGFuZCBgeyBpZDogMiwgYm9keTogIlJhaWxzIGlzIHVuYWdp
        IiB9YAoKICAgIFlvdSBjYW4gdXNlIHRoaXMgbWV0aG9kLCBmb3IgZXhhbXBs
        ZSwgdG8gbm9ybWFsaXplIHVuZGVyc2NvcmVkIGtleXMgdG8gY2FtZWxpemVk
        CiAgICBvciBvdGhlciBnZW5lcmFsLXB1cnBvc2Ugbm9ybWFsaXphdGlvbnMu
        CgogICAgSWYgeW91IHdhbnQgdG8gZG8gbm9ybWFsaXphdGlvbnMgc3BlY2lm
        aWMgdG8gc29tZSBwYXJ0IG9mIHRoZSBwYXlsb2FkLCB5b3UKICAgIGNhbiBz
        cGVjaWZ5IHRob3NlIHVuZGVyIGBub3JtYWxpemVIYXNoYC4KCiAgICBGb3Ig
        ZXhhbXBsZSwgaWYgdGhlIGBJRHNgIHVuZGVyIGAiY29tbWVudHMiYCBhcmUg
        cHJvdmlkZWQgYXMgYF9pZGAgaW5zdGVhZCBvZgogICAgYGlkYCwgeW91IGNh
        biBzcGVjaWZ5IGhvdyB0byBub3JtYWxpemUganVzdCB0aGUgY29tbWVudHM6
        CgogICAgYGBganMKICAgIEFwcC5Qb3N0U2VyaWFsaXplciA9IERTLlJFU1RT
        ZXJpYWxpemVyLmV4dGVuZCh7CiAgICAgIG5vcm1hbGl6ZUhhc2g6IHsKICAg
        ICAgICBjb21tZW50czogZnVuY3Rpb24oaGFzaCkgewogICAgICAgICAgaGFz
        aC5pZCA9IGhhc2guX2lkOwogICAgICAgICAgZGVsZXRlIGhhc2guX2lkOwog
        ICAgICAgICAgcmV0dXJuIGhhc2g7CiAgICAgICAgfQogICAgICB9CiAgICB9
        KTsKICAgIGBgYAoKICAgIFRoZSBrZXkgdW5kZXIgYG5vcm1hbGl6ZUhhc2hg
        IGlzIGp1c3QgdGhlIG9yaWdpbmFsIGtleSB0aGF0IHdhcyBpbiB0aGUgb3Jp
        Z2luYWwKICAgIHBheWxvYWQuCgogICAgQG1ldGhvZCBub3JtYWxpemUKICAg
        IEBwYXJhbSB7c3ViY2xhc3Mgb2YgRFMuTW9kZWx9IHR5cGUKICAgIEBwYXJh
        bSB7U3RyaW5nfSBwcm9wCiAgICBAcGFyYW0ge09iamVjdH0gaGFzaAogICAg
        QHJldHVybnMgT2JqZWN0CiAgKi8KICBub3JtYWxpemU6IGZ1bmN0aW9uKHR5
        cGUsIHByb3AsIGhhc2gpIHsKICAgIHRoaXMubm9ybWFsaXplSWQoaGFzaCk7
        CiAgICB0aGlzLm5vcm1hbGl6ZUF0dHJpYnV0ZXMoaGFzaCk7CgogICAgaWYg
        KHRoaXMubm9ybWFsaXplSGFzaCAmJiB0aGlzLm5vcm1hbGl6ZUhhc2hbcHJv
        cF0pIHsKICAgICAgcmV0dXJuIHRoaXMubm9ybWFsaXplSGFzaFtwcm9wXSho
        YXNoKTsKICAgIH0KCiAgICByZXR1cm4gaGFzaDsKICB9LAoKICAvKioKICAg
        IEBtZXRob2Qgbm9ybWFsaXplSWQKICAgIEBwcml2YXRlCiAgKi8KICBub3Jt
        YWxpemVJZDogZnVuY3Rpb24oaGFzaCkgewogICAgdmFyIHByaW1hcnlLZXkg
        PSBnZXQodGhpcywgJ3ByaW1hcnlLZXknKTsKCiAgICBpZiAocHJpbWFyeUtl
        eSA9PT0gJ2lkJykgeyByZXR1cm47IH0KCiAgICBoYXNoLmlkID0gaGFzaFtw
        cmltYXJ5S2V5XTsKICAgIGRlbGV0ZSBoYXNoW3ByaW1hcnlLZXldOwogIH0s
        CgogIC8qKgogICAgQG1ldGhvZCBub3JtYWxpemVBdHRyaWJ1dGVzCiAgICBA
        cHJpdmF0ZQogICovCiAgbm9ybWFsaXplQXR0cmlidXRlczogZnVuY3Rpb24o
        aGFzaCkgewogICAgdmFyIGF0dHJzID0gZ2V0KHRoaXMsICdhdHRycycpOwoK
        ICAgIGlmICghYXR0cnMpIHsgcmV0dXJuOyB9CgogICAgZm9yICh2YXIga2V5
        IGluIGF0dHJzKSB7CiAgICAgIHZhciBwYXlsb2FkS2V5ID0gYXR0cnNba2V5
        XTsKCiAgICAgIGhhc2hba2V5XSA9IGhhc2hbcGF5bG9hZEtleV07CiAgICAg
        IGRlbGV0ZSBoYXNoW3BheWxvYWRLZXldOwogICAgfQogIH0sCgogIC8qKgog
        ICAgQ2FsbGVkIHdoZW4gdGhlIHNlcnZlciBoYXMgcmV0dXJuZWQgYSBwYXls
        b2FkIHJlcHJlc2VudGluZwogICAgYSBzaW5nbGUgcmVjb3JkLCBzdWNoIGFz
        IGluIHJlc3BvbnNlIHRvIGEgYGZpbmRgIG9yIGBzYXZlYC4KCiAgICBJdCBp
        cyB5b3VyIG9wcG9ydHVuaXR5IHRvIGNsZWFuIHVwIHRoZSBzZXJ2ZXIncyBy
        ZXNwb25zZSBpbnRvIHRoZSBub3JtYWxpemVkCiAgICBmb3JtIGV4cGVjdGVk
        IGJ5IEVtYmVyIERhdGEuCgogICAgSWYgeW91IHdhbnQsIHlvdSBjYW4ganVz
        dCByZXN0cnVjdHVyZSB0aGUgdG9wLWxldmVsIG9mIHlvdXIgcGF5bG9hZCwg
        YW5kCiAgICBkbyBtb3JlIGZpbmUtZ3JhaW5lZCBub3JtYWxpemF0aW9uIGlu
        IHRoZSBgbm9ybWFsaXplYCBtZXRob2QuCgogICAgRm9yIGV4YW1wbGUsIGlm
        IHlvdSBoYXZlIGEgcGF5bG9hZCBsaWtlIHRoaXMgaW4gcmVzcG9uc2UgdG8g
        YSByZXF1ZXN0IGZvcgogICAgcG9zdCAxOgoKICAgIGBgYGpzCiAgICB7CiAg
        ICAgICJpZCI6IDEsCiAgICAgICJ0aXRsZSI6ICJSYWlscyBpcyBvbWFrYXNl
        IiwKCiAgICAgICJfZW1iZWRkZWQiOiB7CiAgICAgICAgImNvbW1lbnQiOiBb
        ewogICAgICAgICAgIl9pZCI6IDEsCiAgICAgICAgICAiY29tbWVudF90aXRs
        ZSI6ICJGSVJTVCIKICAgICAgICB9LCB7CiAgICAgICAgICAiX2lkIjogMiwK
        ICAgICAgICAgICJjb21tZW50X3RpdGxlIjogIlJhaWxzIGlzIHVuYWdpIgog
        ICAgICAgIH1dCiAgICAgIH0KICAgIH0KICAgIGBgYAoKICAgIFlvdSBjb3Vs
        ZCBpbXBsZW1lbnQgYSBzZXJpYWxpemVyIHRoYXQgbG9va3MgbGlrZSB0aGlz
        IHRvIGdldCB5b3VyIHBheWxvYWQKICAgIGludG8gc2hhcGU6CgogICAgYGBg
        anMKICAgIEFwcC5Qb3N0U2VyaWFsaXplciA9IERTLlJFU1RTZXJpYWxpemVy
        LmV4dGVuZCh7CiAgICAgIC8vIEZpcnN0LCByZXN0cnVjdHVyZSB0aGUgdG9w
        LWxldmVsIHNvIGl0J3Mgb3JnYW5pemVkIGJ5IHR5cGUKICAgICAgZXh0cmFj
        dFNpbmdsZTogZnVuY3Rpb24oc3RvcmUsIHR5cGUsIHBheWxvYWQsIGlkLCBy
        ZXF1ZXN0VHlwZSkgewogICAgICAgIHZhciBjb21tZW50cyA9IHBheWxvYWQu
        X2VtYmVkZGVkLmNvbW1lbnQ7CiAgICAgICAgZGVsZXRlIHBheWxvYWQuX2Vt
        YmVkZGVkOwoKICAgICAgICBwYXlsb2FkID0geyBjb21tZW50czogY29tbWVu
        dHMsIHBvc3Q6IHBheWxvYWQgfTsKICAgICAgICByZXR1cm4gdGhpcy5fc3Vw
        ZXIoc3RvcmUsIHR5cGUsIHBheWxvYWQsIGlkLCByZXF1ZXN0VHlwZSk7CiAg
        ICAgIH0sCgogICAgICBub3JtYWxpemVIYXNoOiB7CiAgICAgICAgLy8gTmV4
        dCwgbm9ybWFsaXplIGluZGl2aWR1YWwgY29tbWVudHMsIHdoaWNoIChhZnRl
        ciBgZXh0cmFjdGApCiAgICAgICAgLy8gYXJlIG5vdyBsb2NhdGVkIHVuZGVy
        IGBjb21tZW50c2AKICAgICAgICBjb21tZW50czogZnVuY3Rpb24oaGFzaCkg
        ewogICAgICAgICAgaGFzaC5pZCA9IGhhc2guX2lkOwogICAgICAgICAgaGFz
        aC50aXRsZSA9IGhhc2guY29tbWVudF90aXRsZTsKICAgICAgICAgIGRlbGV0
        ZSBoYXNoLl9pZDsKICAgICAgICAgIGRlbGV0ZSBoYXNoLmNvbW1lbnRfdGl0
        bGU7CiAgICAgICAgICByZXR1cm4gaGFzaDsKICAgICAgICB9CiAgICAgIH0K
        ICAgIH0pCiAgICBgYGAKCiAgICBXaGVuIHlvdSBjYWxsIHN1cGVyIGZyb20g
        eW91ciBvd24gaW1wbGVtZW50YXRpb24gb2YgYGV4dHJhY3RTaW5nbGVgLCB0
        aGUKICAgIGJ1aWx0LWluIGltcGxlbWVudGF0aW9uIHdpbGwgZmluZCB0aGUg
        cHJpbWFyeSByZWNvcmQgaW4geW91ciBub3JtYWxpemVkCiAgICBwYXlsb2Fk
        IGFuZCBwdXNoIHRoZSByZW1haW5pbmcgcmVjb3JkcyBpbnRvIHRoZSBzdG9y
        ZS4KCiAgICBUaGUgcHJpbWFyeSByZWNvcmQgaXMgdGhlIHNpbmdsZSBoYXNo
        IGZvdW5kIHVuZGVyIGBwb3N0YCBvciB0aGUgZmlyc3QKICAgIGVsZW1lbnQg
        b2YgdGhlIGBwb3N0c2AgYXJyYXkuCgogICAgVGhlIHByaW1hcnkgcmVjb3Jk
        IGhhcyBzcGVjaWFsIG1lYW5pbmcgd2hlbiB0aGUgcmVjb3JkIGlzIGJlaW5n
        IGNyZWF0ZWQKICAgIGZvciB0aGUgZmlyc3QgdGltZSBvciB1cGRhdGVkIChg
        Y3JlYXRlUmVjb3JkYCBvciBgdXBkYXRlUmVjb3JkYCkuIEluCiAgICBwYXJ0
        aWN1bGFyLCBpdCB3aWxsIHVwZGF0ZSB0aGUgcHJvcGVydGllcyBvZiB0aGUg
        cmVjb3JkIHRoYXQgd2FzIHNhdmVkLgoKICAgIEBwYXJhbSB7RFMuU3RvcmV9
        IHN0b3JlCiAgICBAcGFyYW0ge3N1YmNsYXNzIG9mIERTLk1vZGVsfSB0eXBl
        CiAgICBAcGFyYW0ge09iamVjdH0gcGF5bG9hZAogICAgQHBhcmFtIHtTdHJp
        bmd9IGlkCiAgICBAcGFyYW0geydmaW5kJ3wnY3JlYXRlUmVjb3JkJ3wndXBk
        YXRlUmVjb3JkJ3wnZGVsZXRlUmVjb3JkJ30gcmVxdWVzdFR5cGUKICAgIEBy
        ZXR1cm5zIE9iamVjdCB0aGUgcHJpbWFyeSByZXNwb25zZSB0byB0aGUgb3Jp
        Z2luYWwgcmVxdWVzdAogICovCiAgZXh0cmFjdFNpbmdsZTogZnVuY3Rpb24o
        c3RvcmUsIHByaW1hcnlUeXBlLCBwYXlsb2FkLCByZWNvcmRJZCwgcmVxdWVz
        dFR5cGUpIHsKICAgIHZhciBwcmltYXJ5VHlwZU5hbWUgPSBwcmltYXJ5VHlw
        ZS50eXBlS2V5LAogICAgICAgIHByaW1hcnlSZWNvcmQ7CgogICAgZm9yICh2
        YXIgcHJvcCBpbiBwYXlsb2FkKSB7CiAgICAgIC8vIGxlZ2FjeSBzdXBwb3J0
        IGZvciBzaW5ndWxhciBuYW1lcwogICAgICBpZiAocHJvcCA9PT0gcHJpbWFy
        eVR5cGVOYW1lKSB7CiAgICAgICAgcHJpbWFyeVJlY29yZCA9IHRoaXMubm9y
        bWFsaXplKHByaW1hcnlUeXBlLCBwcm9wLCBwYXlsb2FkW3Byb3BdKTsKICAg
        ICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgdmFyIHR5cGVOYW1lID0g
        dGhpcy5zaW5ndWxhcml6ZShwcm9wKSwKICAgICAgICAgIHR5cGUgPSBzdG9y
        ZS5tb2RlbEZvcih0eXBlTmFtZSk7CgogICAgICAvKmpzaGludCBsb29wZnVu
        Yzp0cnVlKi8KICAgICAgcGF5bG9hZFtwcm9wXS5mb3JFYWNoKGZ1bmN0aW9u
        KGhhc2gpIHsKICAgICAgICBoYXNoID0gdGhpcy5ub3JtYWxpemUodHlwZSwg
        cHJvcCwgaGFzaCk7CgogICAgICAgIHZhciBpc0ZpcnN0Q3JlYXRlZFJlY29y
        ZCA9IHR5cGVOYW1lID09PSBwcmltYXJ5VHlwZU5hbWUgJiYgIXJlY29yZElk
        ICYmICFwcmltYXJ5UmVjb3JkLAogICAgICAgICAgICBpc1VwZGF0ZWRSZWNv
        cmQgPSB0eXBlTmFtZSA9PT0gcHJpbWFyeVR5cGVOYW1lICYmIGNvZXJjZUlk
        KGhhc2guaWQpID09PSByZWNvcmRJZDsKCiAgICAgICAgLy8gZmluZCB0aGUg
        cHJpbWFyeSByZWNvcmQuCiAgICAgICAgLy8KICAgICAgICAvLyBJdCdzIGVp
        dGhlcjoKICAgICAgICAvLyAqIHRoZSByZWNvcmQgd2l0aCB0aGUgc2FtZSBJ
        RCBhcyB0aGUgb3JpZ2luYWwgcmVxdWVzdAogICAgICAgIC8vICogaW4gdGhl
        IGNhc2Ugb2YgYSBuZXdseSBjcmVhdGVkIHJlY29yZCB0aGF0IGRpZG4ndCBo
        YXZlIGFuIElELCB0aGUgZmlyc3QKICAgICAgICAvLyAgIHJlY29yZCBpbiB0
        aGUgQXJyYXkKICAgICAgICBpZiAoaXNGaXJzdENyZWF0ZWRSZWNvcmQgfHwg
        aXNVcGRhdGVkUmVjb3JkKSB7CiAgICAgICAgICBwcmltYXJ5UmVjb3JkID0g
        aGFzaDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgc3RvcmUucHVzaCh0
        eXBlTmFtZSwgaGFzaCk7CiAgICAgICAgfQogICAgICB9LCB0aGlzKTsKICAg
        IH0KCiAgICByZXR1cm4gcHJpbWFyeVJlY29yZDsKICB9LAoKICAvKioKICAg
        IENhbGxlZCB3aGVuIHRoZSBzZXJ2ZXIgaGFzIHJldHVybmVkIGEgcGF5bG9h
        ZCByZXByZXNlbnRpbmcKICAgIG11bHRpcGxlIHJlY29yZHMsIHN1Y2ggYXMg
        aW4gcmVzcG9uc2UgdG8gYSBgZmluZEFsbGAgb3IgYGZpbmRRdWVyeWAuCgog
        ICAgSXQgaXMgeW91ciBvcHBvcnR1bml0eSB0byBjbGVhbiB1cCB0aGUgc2Vy
        dmVyJ3MgcmVzcG9uc2UgaW50byB0aGUgbm9ybWFsaXplZAogICAgZm9ybSBl
        eHBlY3RlZCBieSBFbWJlciBEYXRhLgoKICAgIElmIHlvdSB3YW50LCB5b3Ug
        Y2FuIGp1c3QgcmVzdHJ1Y3R1cmUgdGhlIHRvcC1sZXZlbCBvZiB5b3VyIHBh
        eWxvYWQsIGFuZAogICAgZG8gbW9yZSBmaW5lLWdyYWluZWQgbm9ybWFsaXph
        dGlvbiBpbiB0aGUgYG5vcm1hbGl6ZWAgbWV0aG9kLgoKICAgIEZvciBleGFt
        cGxlLCBpZiB5b3UgaGF2ZSBhIHBheWxvYWQgbGlrZSB0aGlzIGluIHJlc3Bv
        bnNlIHRvIGEgcmVxdWVzdCBmb3IKICAgIGFsbCBwb3N0czoKCiAgICBgYGBq
        cwogICAgewogICAgICAiX2VtYmVkZGVkIjogewogICAgICAgICJwb3N0Ijog
        W3sKICAgICAgICAgICJpZCI6IDEsCiAgICAgICAgICAidGl0bGUiOiAiUmFp
        bHMgaXMgb21ha2FzZSIKICAgICAgICB9LCB7CiAgICAgICAgICAiaWQiOiAy
        LAogICAgICAgICAgInRpdGxlIjogIlRoZSBQYXJsZXkgTGV0dGVyIgogICAg
        ICAgIH1dLAogICAgICAgICJjb21tZW50IjogW3sKICAgICAgICAgICJfaWQi
        OiAxLAogICAgICAgICAgImNvbW1lbnRfdGl0bGUiOiAiUmFpbHMgaXMgdW5h
        Z2kiCiAgICAgICAgICAicG9zdF9pZCI6IDEKICAgICAgICB9LCB7CiAgICAg
        ICAgICAiX2lkIjogMiwKICAgICAgICAgICJjb21tZW50X3RpdGxlIjogIkRv
        bid0IHRyZWFkIG9uIG1lIiwKICAgICAgICAgICJwb3N0X2lkIjogMgogICAg
        ICAgIH1dCiAgICAgIH0KICAgIH0KICAgIGBgYAoKICAgIFlvdSBjb3VsZCBp
        bXBsZW1lbnQgYSBzZXJpYWxpemVyIHRoYXQgbG9va3MgbGlrZSB0aGlzIHRv
        IGdldCB5b3VyIHBheWxvYWQKICAgIGludG8gc2hhcGU6CgogICAgYGBganMK
        ICAgIEFwcC5Qb3N0U2VyaWFsaXplciA9IERTLlJFU1RTZXJpYWxpemVyLmV4
        dGVuZCh7CiAgICAgIC8vIEZpcnN0LCByZXN0cnVjdHVyZSB0aGUgdG9wLWxl
        dmVsIHNvIGl0J3Mgb3JnYW5pemVkIGJ5IHR5cGUKICAgICAgLy8gYW5kIHRo
        ZSBjb21tZW50cyBhcmUgbGlzdGVkIHVuZGVyIGEgcG9zdCdzIGBjb21tZW50
        c2Aga2V5LgogICAgICBleHRyYWN0QXJyYXk6IGZ1bmN0aW9uKHN0b3JlLCB0
        eXBlLCBwYXlsb2FkLCBpZCwgcmVxdWVzdFR5cGUpIHsKICAgICAgICB2YXIg
        cG9zdHMgPSBwYXlsb2FkLl9lbWJlZGRlZC5wb3N0OwogICAgICAgIHZhciBj
        b21tZW50cyA9IFtdOwogICAgICAgIHZhciBwb3N0Q2FjaGUgPSB7fTsKCiAg
        ICAgICAgcG9zdHMuZm9yRWFjaChmdW5jdGlvbihwb3N0KSB7CiAgICAgICAg
        ICBwb3N0LmNvbW1lbnRzID0gW107CiAgICAgICAgICBwb3N0Q2FjaGVbcG9z
        dC5pZF0gPSBwb3N0OwogICAgICAgIH0pOwoKICAgICAgICBwYXlsb2FkLl9l
        bWJlZGRlZC5jb21tZW50LmZvckVhY2goZnVuY3Rpb24oY29tbWVudCkgewog
        ICAgICAgICAgY29tbWVudHMucHVzaChjb21tZW50KTsKICAgICAgICAgIHBv
        c3RDYWNoZVtjb21tZW50LnBvc3RfaWRdLmNvbW1lbnRzLnB1c2goY29tbWVu
        dCk7CiAgICAgICAgICBkZWxldGUgY29tbWVudC5wb3N0X2lkOwogICAgICAg
        IH0KCiAgICAgICAgcGF5bG9hZCA9IHsgY29tbWVudHM6IGNvbW1lbnRzLCBw
        b3N0czogcGF5bG9hZCB9OwoKICAgICAgICByZXR1cm4gdGhpcy5fc3VwZXIo
        c3RvcmUsIHR5cGUsIHBheWxvYWQsIGlkLCByZXF1ZXN0VHlwZSk7CiAgICAg
        IH0sCgogICAgICBub3JtYWxpemVIYXNoOiB7CiAgICAgICAgLy8gTmV4dCwg
        bm9ybWFsaXplIGluZGl2aWR1YWwgY29tbWVudHMsIHdoaWNoIChhZnRlciBg
        ZXh0cmFjdGApCiAgICAgICAgLy8gYXJlIG5vdyBsb2NhdGVkIHVuZGVyIGBj
        b21tZW50c2AKICAgICAgICBjb21tZW50czogZnVuY3Rpb24oaGFzaCkgewog
        ICAgICAgICAgaGFzaC5pZCA9IGhhc2guX2lkOwogICAgICAgICAgaGFzaC50
        aXRsZSA9IGhhc2guY29tbWVudF90aXRsZTsKICAgICAgICAgIGRlbGV0ZSBo
        YXNoLl9pZDsKICAgICAgICAgIGRlbGV0ZSBoYXNoLmNvbW1lbnRfdGl0bGU7
        CiAgICAgICAgICByZXR1cm4gaGFzaDsKICAgICAgICB9CiAgICAgIH0KICAg
        IH0pCiAgICBgYGAKCiAgICBXaGVuIHlvdSBjYWxsIHN1cGVyIGZyb20geW91
        ciBvd24gaW1wbGVtZW50YXRpb24gb2YgYGV4dHJhY3RBcnJheWAsIHRoZQog
        ICAgYnVpbHQtaW4gaW1wbGVtZW50YXRpb24gd2lsbCBmaW5kIHRoZSBwcmlt
        YXJ5IGFycmF5IGluIHlvdXIgbm9ybWFsaXplZAogICAgcGF5bG9hZCBhbmQg
        cHVzaCB0aGUgcmVtYWluaW5nIHJlY29yZHMgaW50byB0aGUgc3RvcmUuCgog
        ICAgVGhlIHByaW1hcnkgYXJyYXkgaXMgdGhlIGFycmF5IGZvdW5kIHVuZGVy
        IGBwb3N0c2AuCgogICAgVGhlIHByaW1hcnkgcmVjb3JkIGhhcyBzcGVjaWFs
        IG1lYW5pbmcgd2hlbiByZXNwb25kaW5nIHRvIGBmaW5kUXVlcnlgCiAgICBv
        ciBgZmluZEhhc01hbnlgLiBJbiBwYXJ0aWN1bGFyLCB0aGUgcHJpbWFyeSBh
        cnJheSB3aWxsIGJlY29tZSB0aGUKICAgIGxpc3Qgb2YgcmVjb3JkcyBpbiB0
        aGUgcmVjb3JkIGFycmF5IHRoYXQga2lja2VkIG9mZiB0aGUgcmVxdWVzdC4K
        CiAgICBAcGFyYW0ge0RTLlN0b3JlfSBzdG9yZQogICAgQHBhcmFtIHtzdWJj
        bGFzcyBvZiBEUy5Nb2RlbH0gdHlwZQogICAgQHBhcmFtIHtPYmplY3R9IHBh
        eWxvYWQKICAgIEBwYXJhbSB7J2ZpbmRBbGwnfCdmaW5kTWFueSd8J2ZpbmRI
        YXNNYW55J3wnZmluZFF1ZXJ5J30gcmVxdWVzdFR5cGUKICAgIEByZXR1cm5z
        IHtBcnJheTxPYmplY3Q+fSBUaGUgcHJpbWFyeSBhcnJheSB0aGF0IHdhcyBy
        ZXR1cm5lZCBpbiByZXNwb25zZQogICAgICB0byB0aGUgb3JpZ2luYWwgcXVl
        cnkuCiAgKi8KICBleHRyYWN0QXJyYXk6IGZ1bmN0aW9uKHN0b3JlLCBwcmlt
        YXJ5VHlwZSwgcGF5bG9hZCkgewogICAgdmFyIHByaW1hcnlUeXBlTmFtZSA9
        IHByaW1hcnlUeXBlLnR5cGVLZXksCiAgICAgICAgcHJpbWFyeUFycmF5OwoK
        ICAgIGZvciAodmFyIHByb3AgaW4gcGF5bG9hZCkgewogICAgICB2YXIgdHlw
        ZU5hbWUgPSB0aGlzLnNpbmd1bGFyaXplKHByb3ApLAogICAgICAgICAgdHlw
        ZSA9IHN0b3JlLm1vZGVsRm9yKHR5cGVOYW1lKSwKICAgICAgICAgIGlzUHJp
        bWFyeSA9IHR5cGVOYW1lID09PSBwcmltYXJ5VHlwZU5hbWU7CgogICAgICAv
        KmpzaGludCBsb29wZnVuYzp0cnVlKi8KICAgICAgdmFyIG5vcm1hbGl6ZWRB
        cnJheSA9IHBheWxvYWRbcHJvcF0ubWFwKGZ1bmN0aW9uKGhhc2gpIHsKICAg
        ICAgICByZXR1cm4gdGhpcy5ub3JtYWxpemUodHlwZSwgcHJvcCwgaGFzaCk7
        CiAgICAgIH0sIHRoaXMpOwoKICAgICAgaWYgKGlzUHJpbWFyeSkgewogICAg
        ICAgIHByaW1hcnlBcnJheSA9IG5vcm1hbGl6ZWRBcnJheTsKICAgICAgfSBl
        bHNlIHsKICAgICAgICBzdG9yZS5wdXNoTWFueSh0eXBlTmFtZSwgbm9ybWFs
        aXplZEFycmF5KTsKICAgICAgfQogICAgfQoKICAgIHJldHVybiBwcmltYXJ5
        QXJyYXk7CiAgfSwKCiAgLyoqCiAgICBAcHJpdmF0ZQogICAgQG1ldGhvZCBw
        bHVyYWxpemUKICAgIEBwYXJhbSB7U3RyaW5nfSBrZXkKICAqLwogIHBsdXJh
        bGl6ZTogZnVuY3Rpb24oa2V5KSB7CiAgICByZXR1cm4gRW1iZXIuU3RyaW5n
        LnBsdXJhbGl6ZShrZXkpOwogIH0sCgogIC8qKgogICAgQHByaXZhdGUKICAg
        IEBtZXRob2Qgc2luZ3VsYXJpemUKICAgIEBwYXJhbSB7U3RyaW5nfSBrZXkK
        ICAqLwogIHNpbmd1bGFyaXplOiBmdW5jdGlvbihrZXkpIHsKICAgIHJldHVy
        biBFbWJlci5TdHJpbmcuc2luZ3VsYXJpemUoa2V5KTsKICB9LAoKICAvLyBT
        RVJJQUxJWkUKCiAgLyoqCiAgICBDYWxsZWQgd2hlbiBhIHJlY29yZCBpcyBz
        YXZlZCBpbiBvcmRlciB0byBjb252ZXJ0IHRoZQogICAgcmVjb3JkIGludG8g
        SlNPTi4KCiAgICBCeSBkZWZhdWx0LCBpdCBjcmVhdGVzIGEgSlNPTiBvYmpl
        Y3Qgd2l0aCBhIGtleSBmb3IKICAgIGVhY2ggYXR0cmlidXRlIGFuZCBiZWxv
        bmdzVG8gcmVsYXRpb25zaGlwLgoKICAgIEZvciBleGFtcGxlLCBjb25zaWRl
        ciB0aGlzIG1vZGVsOgoKICAgIGBgYGpzCiAgICBBcHAuQ29tbWVudCA9IERT
        Lk1vZGVsLmV4dGVuZCh7CiAgICAgIHRpdGxlOiBEUy5hdHRyKCksCiAgICAg
        IGJvZHk6IERTLmF0dHIoKSwKCiAgICAgIGF1dGhvcjogRFMuYmVsb25nc1Rv
        KCd1c2VyJykKICAgIH0pOwogICAgYGBgCgogICAgVGhlIGRlZmF1bHQgc2Vy
        aWFsaXphdGlvbiB3b3VsZCBjcmVhdGUgYSBKU09OIG9iamVjdCBsaWtlOgoK
        ICAgIGBgYGpzCiAgICB7CiAgICAgICJ0aXRsZSI6ICJSYWlscyBpcyB1bmFn
        aSIsCiAgICAgICJib2R5IjogIlJhaWxzPyBPbWFrYXNlPyBPX08iLAogICAg
        ICAiYXV0aG9yIjogMTIKICAgIH0KICAgIGBgYAoKICAgIEJ5IGRlZmF1bHQs
        IGF0dHJpYnV0ZXMgYXJlIHBhc3NlZCB0aHJvdWdoIGFzLWlzLCB1bmxlc3MK
        ICAgIHlvdSBzcGVjaWZpZWQgYW4gYXR0cmlidXRlIHR5cGUgKGBEUy5hdHRy
        KCdkYXRlJylgKS4gSWYKICAgIHlvdSBzcGVjaWZ5IGEgdHJhbnNmb3JtLCB0
        aGUgSmF2YVNjcmlwdCB2YWx1ZSB3aWxsIGJlCiAgICBzZXJpYWxpemVkIHdo
        ZW4gaW5zZXJ0ZWQgaW50byB0aGUgSlNPTiBoYXNoLgoKICAgIEJ5IGRlZmF1
        bHQsIGJlbG9uZ3MtdG8gcmVsYXRpb25zaGlwcyBhcmUgY29udmVydGVkIGlu
        dG8KICAgIElEcyB3aGVuIGluc2VydGVkIGludG8gdGhlIEpTT04gaGFzaC4K
        CiAgICAjIyBJRHMKCiAgICBgc2VyaWFsaXplYCB0YWtlcyBhbiBvcHRpb25z
        IGhhc2ggd2l0aCBhIHNpbmdsZSBvcHRpb246CiAgICBgaW5jbHVkZUlkYC4g
        SWYgdGhpcyBvcHRpb24gaXMgYHRydWVgLCBgc2VyaWFsaXplYCB3aWxsLAog
        ICAgYnkgZGVmYXVsdCBpbmNsdWRlIHRoZSBJRCBpbiB0aGUgSlNPTiBvYmpl
        Y3QgaXQgYnVpbGRzLgoKICAgIFRoZSBhZGFwdGVyIHBhc3NlcyBpbiBgaW5j
        bHVkZUlkOiB0cnVlYCB3aGVuIHNlcmlhbGl6aW5nCiAgICBhIHJlY29yZCBm
        b3IgYGNyZWF0ZVJlY29yZGAsIGJ1dCBub3QgZm9yIGB1cGRhdGVSZWNvcmRg
        LgoKICAgICMjIEN1c3RvbWl6YXRpb24KCiAgICBZb3VyIHNlcnZlciBtYXkg
        ZXhwZWN0IGEgZGlmZmVyZW50IEpTT04gZm9ybWF0IHRoYW4gdGhlCiAgICBi
        dWlsdC1pbiBzZXJpYWxpemF0aW9uIGZvcm1hdC4KCiAgICBJbiB0aGF0IGNh
        c2UsIHlvdSBjYW4gaW1wbGVtZW50IGBzZXJpYWxpemVgIHlvdXJzZWxmIGFu
        ZAogICAgcmV0dXJuIGEgSlNPTiBoYXNoIG9mIHlvdXIgY2hvb3NpbmcuCgog
        ICAgYGBganMKICAgIEFwcC5Qb3N0U2VyaWFsaXplciA9IERTLlJFU1RTZXJp
        YWxpemVyLmV4dGVuZCh7CiAgICAgIHNlcmlhbGl6ZTogZnVuY3Rpb24ocG9z
        dCwgb3B0aW9ucykgewogICAgICAgIHZhciBqc29uID0gewogICAgICAgICAg
        UE9TVF9UVEw6IHBvc3QuZ2V0KCd0aXRsZScpLAogICAgICAgICAgUE9TVF9C
        RFk6IHBvc3QuZ2V0KCdib2R5JyksCiAgICAgICAgICBQT1NUX0NNUzogcG9z
        dC5nZXQoJ2NvbW1lbnRzJykubWFwUHJvcGVydHkoJ2lkJykKICAgICAgICB9
        CgogICAgICAgIGlmIChvcHRpb25zLmluY2x1ZGVJZCkgewogICAgICAgICAg
        anNvbi5QT1NUX0lEXyA9IHBvc3QuZ2V0KCdpZCcpOwogICAgICAgIH0KCiAg
        ICAgICAgcmV0dXJuIGpzb247CiAgICAgIH0KICAgIH0pOwogICAgYGBgCgog
        ICAgIyMgQ3VzdG9taXppbmcgYW4gQXBwLVdpZGUgU2VyaWFsaXplcgoKICAg
        IElmIHlvdSB3YW50IHRvIGRlZmluZSBhIHNlcmlhbGl6ZXIgZm9yIHlvdXIg
        ZW50aXJlCiAgICBhcHBsaWNhdGlvbiwgeW91J2xsIHByb2JhYmx5IHdhbnQg
        dG8gdXNlIGBlYWNoQXR0cmlidXRlYAogICAgYW5kIGBlYWNoUmVsYXRpb25z
        aGlwYCBvbiB0aGUgcmVjb3JkLgoKICAgIGBgYGpzCiAgICBBcHAuQXBwbGlj
        YXRpb25TZXJpYWxpemVyID0gRFMuUkVTVFNlcmlhbGl6ZXIuZXh0ZW5kKHsK
        ICAgICAgc2VyaWFsaXplOiBmdW5jdGlvbihyZWNvcmQsIG9wdGlvbnMpIHsK
        ICAgICAgICB2YXIganNvbiA9IHt9OwoKICAgICAgICByZWNvcmQuZWFjaEF0
        dHJpYnV0ZShmdW5jdGlvbihuYW1lKSB7CiAgICAgICAgICBqc29uW3NlcnZl
        ckF0dHJpYnV0ZU5hbWUobmFtZSldID0gcmVjb3JkLmdldChuYW1lKTsKICAg
        ICAgICB9KQoKICAgICAgICByZWNvcmQuZWFjaFJlbGF0aW9uc2hpcChmdW5j
        dGlvbihuYW1lLCByZWxhdGlvbnNoaXApIHsKICAgICAgICAgIGlmIChyZWxh
        dGlvbnNoaXAua2luZCA9PT0gJ2hhc01hbnknKSB7CiAgICAgICAgICAgIGpz
        b25bc2VydmVySGFzTWFueU5hbWUobmFtZSldID0gcmVjb3JkLmdldChuYW1l
        KS5tYXBCeSgnaWQnKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKCiAgICAg
        ICAgaWYgKG9wdGlvbnMuaW5jbHVkZUlkKSB7CiAgICAgICAgICBqc29uLklE
        XyA9IHJlY29yZC5nZXQoJ2lkJyk7CiAgICAgICAgfQoKICAgICAgICByZXR1
        cm4ganNvbjsKICAgICAgfQogICAgfSk7CgogICAgZnVuY3Rpb24gc2VydmVy
        QXR0cmlidXRlTmFtZShhdHRyaWJ1dGUpIHsKICAgICAgcmV0dXJuIGF0dHJp
        YnV0ZS51bmRlcnNjb3JlKCkudG9VcHBlckNhc2UoKTsKICAgIH0KCiAgICBm
        dW5jdGlvbiBzZXJ2ZXJIYXNNYW55TmFtZShuYW1lKSB7CiAgICAgIHJldHVy
        biBzZXJ2ZXJBdHRyaWJ1dGVOYW1lKG5hbWUuc2luZ3VsYXJpemUoKSkgKyAi
        X0lEUyI7CiAgICB9CiAgICBgYGAKCiAgICBUaGlzIHNlcmlhbGl6ZXIgd2ls
        bCBnZW5lcmF0ZSBKU09OIHRoYXQgbG9va3MgbGlrZSB0aGlzOgoKICAgIGBg
        YGpzCiAgICB7CiAgICAgICJUSVRMRSI6ICJSYWlscyBpcyBvbWFrYXNlIiwK
        ICAgICAgIkJPRFkiOiAiWWVwLiBPbWFrYXNlLiIsCiAgICAgICJDT01NRU5U
        X0lEUyI6IFsgMSwgMiwgMyBdCiAgICB9CiAgICBgYGAKCiAgICAjIyBUd2Vh
        a2luZyB0aGUgRGVmYXVsdCBKU09OCgogICAgSWYgeW91IGp1c3Qgd2FudCB0
        byBkbyBzb21lIHNtYWxsIHR3ZWFrcyBvbiB0aGUgZGVmYXVsdCBKU09OLAog
        ICAgeW91IGNhbiBjYWxsIHN1cGVyIGZpcnN0IGFuZCBtYWtlIHRoZSB0d2Vh
        a3Mgb24gdGhlIHJldHVybmVkCiAgICBKU09OLgoKICAgIGBgYGpzCiAgICBB
        cHAuUG9zdFNlcmlhbGl6ZXIgPSBEUy5SRVNUU2VyaWFsaXplci5leHRlbmQo
        ewogICAgICBzZXJpYWxpemU6IGZ1bmN0aW9uKHJlY29yZCwgb3B0aW9ucykg
        ewogICAgICAgIHZhciBqc29uID0gdGhpcy5fc3VwZXIocmVjb3JkLCBvcHRp
        b25zKTsKCiAgICAgICAganNvbi5zdWJqZWN0ID0ganNvbi50aXRsZTsKICAg
        ICAgICBkZWxldGUganNvbi50aXRsZTsKCiAgICAgICAgcmV0dXJuIGpzb247
        CiAgICAgIH0KICAgIH0pOwogICAgYGBgCiAgKi8KICBzZXJpYWxpemU6IGZ1
        bmN0aW9uKHJlY29yZCwgb3B0aW9ucykgewogICAgcmV0dXJuIHRoaXMuX3N1
        cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgfQp9KTsKCi8qKgogIFRo
        ZSBSRVNUIGFkYXB0ZXIgYWxsb3dzIHlvdXIgc3RvcmUgdG8gY29tbXVuaWNh
        dGUgd2l0aCBhbiBIVFRQIHNlcnZlciBieQogIHRyYW5zbWl0dGluZyBKU09O
        IHZpYSBYSFIuIE1vc3QgRW1iZXIuanMgYXBwcyB0aGF0IGNvbnN1bWUgYSBK
        U09OIEFQSQogIHNob3VsZCB1c2UgdGhlIFJFU1QgYWRhcHRlci4KCiAgVGhp
        cyBhZGFwdGVyIGlzIGRlc2lnbmVkIGFyb3VuZCB0aGUgaWRlYSB0aGF0IHRo
        ZSBKU09OIGV4Y2hhbmdlZCB3aXRoCiAgdGhlIHNlcnZlciBzaG91bGQgYmUg
        Y29udmVudGlvbmFsLgoKICAjIyBKU09OIFN0cnVjdHVyZQoKICBUaGUgUkVT
        VCBhZGFwdGVyIGV4cGVjdHMgdGhlIEpTT04gcmV0dXJuZWQgZnJvbSB5b3Vy
        IHNlcnZlciB0byBmb2xsb3cKICB0aGVzZSBjb252ZW50aW9ucy4KCiAgIyMj
        IE9iamVjdCBSb290CgogIFRoZSBKU09OIHBheWxvYWQgc2hvdWxkIGJlIGFu
        IG9iamVjdCB0aGF0IGNvbnRhaW5zIHRoZSByZWNvcmQgaW5zaWRlIGEKICBy
        b290IHByb3BlcnR5LiBGb3IgZXhhbXBsZSwgaW4gcmVzcG9uc2UgdG8gYSBg
        R0VUYCByZXF1ZXN0IGZvcgogIGAvcG9zdHMvMWAsIHRoZSBKU09OIHNob3Vs
        ZCBsb29rIGxpa2UgdGhpczoKCiAgYGBganMKICB7CiAgICAicG9zdCI6IHsK
        ICAgICAgdGl0bGU6ICJJJ20gUnVubmluZyB0byBSZWZvcm0gdGhlIFczQydz
        IFRhZyIsCiAgICAgIGF1dGhvcjogIlllaHVkYSBLYXR6IgogICAgfQogIH0K
        ICBgYGAKCiAgIyMjIENvbnZlbnRpb25hbCBOYW1lcwoKICBBdHRyaWJ1dGUg
        bmFtZXMgaW4geW91ciBKU09OIHBheWxvYWQgc2hvdWxkIGJlIHRoZSB1bmRl
        cnNjb3JlZCB2ZXJzaW9ucyBvZgogIHRoZSBhdHRyaWJ1dGVzIGluIHlvdXIg
        RW1iZXIuanMgbW9kZWxzLgoKICBGb3IgZXhhbXBsZSwgaWYgeW91IGhhdmUg
        YSBgUGVyc29uYCBtb2RlbDoKCiAgYGBganMKICBBcHAuUGVyc29uID0gRFMu
        TW9kZWwuZXh0ZW5kKHsKICAgIGZpcnN0TmFtZTogRFMuYXR0cignc3RyaW5n
        JyksCiAgICBsYXN0TmFtZTogRFMuYXR0cignc3RyaW5nJyksCiAgICBvY2N1
        cGF0aW9uOiBEUy5hdHRyKCdzdHJpbmcnKQogIH0pOwogIGBgYAoKICBUaGUg
        SlNPTiByZXR1cm5lZCBzaG91bGQgbG9vayBsaWtlIHRoaXM6CgogIGBgYGpz
        CiAgewogICAgInBlcnNvbiI6IHsKICAgICAgImZpcnN0X25hbWUiOiAiQmFy
        YWNrIiwKICAgICAgImxhc3RfbmFtZSI6ICJPYmFtYSIsCiAgICAgICJvY2N1
        cGF0aW9uIjogIlByZXNpZGVudCIKICAgIH0KICB9CiAgYGBgCgogICMjIEN1
        c3RvbWl6YXRpb24KCiAgIyMjIEVuZHBvaW50IHBhdGggY3VzdG9taXphdGlv
        bgoKICBFbmRwb2ludCBwYXRocyBjYW4gYmUgcHJlZml4ZWQgd2l0aCBhIGBu
        YW1lc3BhY2VgIGJ5IHNldHRpbmcgdGhlIG5hbWVzcGFjZQogIHByb3BlcnR5
        IG9uIHRoZSBhZGFwdGVyOgoKICBgYGBqcwogIERTLlJFU1RBZGFwdGVyLnJl
        b3Blbih7CiAgICBuYW1lc3BhY2U6ICdhcGkvMScKICB9KTsKICBgYGAKICBS
        ZXF1ZXN0cyBmb3IgYEFwcC5QZXJzb25gIHdvdWxkIG5vdyB0YXJnZXQgYC9h
        cGkvMS9wZW9wbGUvMWAuCgogICMjIyBIb3N0IGN1c3RvbWl6YXRpb24KCiAg
        QW4gYWRhcHRlciBjYW4gdGFyZ2V0IG90aGVyIGhvc3RzIGJ5IHNldHRpbmcg
        dGhlIGB1cmxgIHByb3BlcnR5LgoKICBgYGBqcwogIERTLlJFU1RBZGFwdGVy
        LnJlb3Blbih7CiAgICB1cmw6ICdodHRwczovL2FwaS5leGFtcGxlLmNvbScK
        ICB9KTsKICBgYGAKCiAgIyMjIEhlYWRlcnMgY3VzdG9taXphdGlvbgoKICBT
        b21lIEFQSXMgcmVxdWlyZSBIVFRQIGhlYWRlcnMsIGVnIHRvIHByb3ZpZGUg
        YW4gQVBJIGtleS4gQW4gYXJyYXkgb2YKICBoZWFkZXJzIGNhbiBiZSBhZGRl
        ZCB0byB0aGUgYWRhcHRlciB3aGljaCBhcmUgcGFzc2VkIHdpdGggZXZlcnkg
        cmVxdWVzdDoKCiAgYGBganMKICBEUy5SRVNUQWRhcHRlci5yZW9wZW4oewog
        ICAgaGVhZGVyczogewogICAgICAiQVBJX0tFWSI6ICJzZWNyZXQga2V5IiwK
        ICAgICAgIkFOT1RIRVJfSEVBREVSIjogImFzZHNhZGEiCiAgICB9CiAgfSk7
        CiAgYGBgCgogIEBjbGFzcyBSRVNUQWRhcHRlcgogIEBjb25zdHJ1Y3Rvcgog
        IEBuYW1lc3BhY2UgRFMKICBAZXh0ZW5kcyBEUy5BZGFwdGVyCiovCkRTLlJF
        U1RBZGFwdGVyID0gRFMuQWRhcHRlci5leHRlbmQoewogIGRlZmF1bHRTZXJp
        YWxpemVyOiAnX3Jlc3QnLAoKICAvKioKICAgIENhbGxlZCBieSB0aGUgc3Rv
        cmUgaW4gb3JkZXIgdG8gZmV0Y2ggdGhlIEpTT04gZm9yIGEgZ2l2ZW4KICAg
        IHR5cGUgYW5kIElELgoKICAgIEl0IG1ha2VzIGFuIEFqYXggcmVxdWVzdCB0
        byBhIFVSTCBjb21wdXRlZCBieSBgYnVpbGRVUkxgLCBhbmQgcmV0dXJucyBh
        CiAgICBwcm9taXNlIGZvciB0aGUgcmVzdWx0aW5nIHBheWxvYWQuCgogICAg
        QG1ldGhvZCBmaW5kCiAgICBAc2VlIFJFU1RBZGFwdGVyL2J1aWxkVVJMCiAg
        ICBAc2VlIFJFU1RBZGFwdGVyL2FqYXgKICAgIEBwYXJhbSB7RFMuU3RvcmV9
        IHN0b3JlCiAgICBAcGFyYW0ge3N1YmNsYXNzIG9mIERTLk1vZGVsfSB0eXBl
        CiAgICBAcGFyYW0ge1N0cmluZ30gaWQKICAgIEByZXR1cm5zIFByb21pc2UK
        ICAqLwogIGZpbmQ6IGZ1bmN0aW9uKHN0b3JlLCB0eXBlLCBpZCkgewogICAg
        cmV0dXJuIHRoaXMuYWpheCh0aGlzLmJ1aWxkVVJMKHR5cGUsIGlkKSwgJ0dF
        VCcpOwogIH0sCgogIC8qKgogICAgQ2FsbGVkIGJ5IHRoZSBzdG9yZSBpbiBv
        cmRlciB0byBmZXRjaCBhIEpTT04gYXJyYXkgZm9yIGFsbAogICAgb2YgdGhl
        IHJlY29yZHMgZm9yIGEgZ2l2ZW4gdHlwZS4KCiAgICBJdCBtYWtlcyBhbiBB
        amF4IHJlcXVlc3QgdG8gYSBVUkwgY29tcHV0ZWQgYnkgYGJ1aWxkVVJMYCwg
        YW5kIHJldHVybnMgYQogICAgcHJvbWlzZSBmb3IgdGhlIHJlc3VsdGluZyBw
        YXlsb2FkLgoKICAgIEBtZXRob2QgZmluZEFsbAogICAgQHNlZSBSRVNUQWRh
        cHRlci9idWlsZFVSTAogICAgQHNlZSBSRVNUQWRhcHRlci9hamF4CiAgICBA
        cGFyYW0ge0RTLlN0b3JlfSBzdG9yZQogICAgQHBhcmFtIHtzdWJjbGFzcyBv
        ZiBEUy5Nb2RlbH0gdHlwZQogICAgQHJldHVybnMgUHJvbWlzZQogICovCiAg
        ZmluZEFsbDogZnVuY3Rpb24oc3RvcmUsIHR5cGUpIHsKICAgIHJldHVybiB0
        aGlzLmFqYXgodGhpcy5idWlsZFVSTCh0eXBlKSwgJ0dFVCcpOwogIH0sCgog
        IC8qKgogICAgQ2FsbGVkIGJ5IHRoZSBzdG9yZSBpbiBvcmRlciB0byBmZXRj
        aCBhIEpTT04gYXJyYXkgZm9yCiAgICB0aGUgcmVjb3JkcyB0aGF0IG1hdGNo
        IGEgcGFydGljdWxhciBxdWVyeS4KCiAgICBUaGUgcXVlcnkgaXMgYSBzaW1w
        bGUgSmF2YVNjcmlwdCBvYmplY3QgdGhhdCB3aWxsIGJlIHBhc3NlZCBkaXJl
        Y3RseQogICAgdG8gdGhlIHNlcnZlciBhcyBwYXJhbWV0ZXJzLgoKICAgIEl0
        IG1ha2VzIGFuIEFqYXggcmVxdWVzdCB0byBhIFVSTCBjb21wdXRlZCBieSBg
        YnVpbGRVUkxgLCBhbmQgcmV0dXJucyBhCiAgICBwcm9taXNlIGZvciB0aGUg
        cmVzdWx0aW5nIHBheWxvYWQuCgogICAgQG1ldGhvZCBmaW5kUXVlcnkKICAg
        IEBzZWUgUkVTVEFkYXB0ZXIvYnVpbGRVUkwKICAgIEBzZWUgUkVTVEFkYXB0
        ZXIvYWpheAogICAgQHBhcmFtIHtEUy5TdG9yZX0gc3RvcmUKICAgIEBwYXJh
        bSB7c3ViY2xhc3Mgb2YgRFMuTW9kZWx9IHR5cGUKICAgIEBwYXJhbSB7T2Jq
        ZWN0fSBxdWVyeQogICAgQHJldHVybnMgUHJvbWlzZQogICovCiAgZmluZFF1
        ZXJ5OiBmdW5jdGlvbihzdG9yZSwgdHlwZSwgcXVlcnkpIHsKICAgIHJldHVy
        biB0aGlzLmFqYXgodGhpcy5idWlsZFVSTCh0eXBlKSwgJ0dFVCcsIHF1ZXJ5
        KTsKICB9LAoKICAvKioKICAgIENhbGxlZCBieSB0aGUgc3RvcmUgaW4gb3Jk
        ZXIgdG8gZmV0Y2ggYSBKU09OIGFycmF5IGZvcgogICAgdGhlIHVubG9hZGVk
        IHJlY29yZHMgaW4gYSBoYXMtbWFueSByZWxhdGlvbnNoaXAgdGhhdCB3ZXJl
        IG9yaWdpbmFsbHkKICAgIHNwZWNpZmllZCBhcyBJRHMuCgogICAgRm9yIGV4
        YW1wbGUsIGlmIHRoZSBvcmlnaW5hbCBwYXlsb2FkIGxvb2tzIGxpa2U6Cgog
        ICAgYGBganMKICAgIHsKICAgICAgImlkIjogMSwKICAgICAgInRpdGxlIjog
        IlJhaWxzIGlzIG9tYWthc2UiLAogICAgICAiY29tbWVudHMiOiBbIDEsIDIs
        IDMgXQogICAgfQogICAgYGBgCgogICAgVGhlIElEcyB3aWxsIGJlIHBhc3Nl
        ZCBhcyBhIFVSTC1lbmNvZGVkIEFycmF5IG9mIElEcywgaW4gdGhpcyBmb3Jt
        OgoKICAgIGBgYAogICAgaWRzW109MSZpZHNbXT0yJmlkc1tdPTMKICAgIGBg
        YAoKICAgIE1hbnkgc2VydmVycywgc3VjaCBhcyBSYWlscyBhbmQgUEhQLCB3
        aWxsIGF1dG9tYXRpY2FsbHkgY29udmVydCB0aGlzCiAgICBpbnRvIGFuIEFy
        cmF5IGZvciB5b3Ugb24gdGhlIHNlcnZlci1zaWRlLiBJZiB5b3Ugd2FudCB0
        byBlbmNvZGUgdGhlCiAgICBJRHMsIGRpZmZlcmVudGx5LCBqdXN0IG92ZXJy
        aWRlIHRoaXMgKG9uZS1saW5lKSBtZXRob2QuCgogICAgSXQgbWFrZXMgYW4g
        QWpheCByZXF1ZXN0IHRvIGEgVVJMIGNvbXB1dGVkIGJ5IGBidWlsZFVSTGAs
        IGFuZCByZXR1cm5zIGEKICAgIHByb21pc2UgZm9yIHRoZSByZXN1bHRpbmcg
        cGF5bG9hZC4KCiAgICBAbWV0aG9kIGZpbmRNYW55CiAgICBAc2VlIFJFU1RB
        ZGFwdGVyL2J1aWxkVVJMCiAgICBAc2VlIFJFU1RBZGFwdGVyL2FqYXgKICAg
        IEBwYXJhbSB7RFMuU3RvcmV9IHN0b3JlCiAgICBAcGFyYW0ge3N1YmNsYXNz
        IG9mIERTLk1vZGVsfSB0eXBlCiAgICBAcGFyYW0ge0FycmF5PFN0cmluZz59
        IGlkcwogICAgQHJldHVybnMgUHJvbWlzZQogICovCiAgZmluZE1hbnk6IGZ1
        bmN0aW9uKHN0b3JlLCB0eXBlLCBpZHMpIHsKICAgIHJldHVybiB0aGlzLmFq
        YXgodGhpcy5idWlsZFVSTCh0eXBlKSwgJ0dFVCcsIHsgaWRzOiBpZHMgfSk7
        CiAgfSwKCiAgLyoqCiAgICBDYWxsZWQgYnkgdGhlIHN0b3JlIGluIG9yZGVy
        IHRvIGZldGNoIGEgSlNPTiBhcnJheSBmb3IKICAgIHRoZSB1bmxvYWRlZCBy
        ZWNvcmRzIGluIGEgaGFzLW1hbnkgcmVsYXRpb25zaGlwIHRoYXQgd2VyZSBv
        cmlnaW5hbGx5CiAgICBzcGVjaWZpZWQgYXMgYSBVUkwgKGluc2lkZSBvZiBg
        bGlua3NgKS4KCiAgICBGb3IgZXhhbXBsZSwgaWYgeW91ciBvcmlnaW5hbCBw
        YXlsb2FkIGxvb2tzIGxpa2UgdGhpczoKCiAgICBgYGBqcwogICAgewogICAg
        ICAicG9zdCI6IHsKICAgICAgICAiaWQiOiAxLAogICAgICAgICJ0aXRsZSI6
        ICJSYWlscyBpcyBvbWFrYXNlIiwKICAgICAgICAibGlua3MiOiB7ICJjb21t
        ZW50cyI6ICIvcG9zdHMvMS9jb21tZW50cyIgfQogICAgICB9CiAgICB9CiAg
        ICBgYGAKCiAgICBUaGlzIG1ldGhvZCB3aWxsIGJlIGNhbGxlZCB3aXRoIHRo
        ZSBwYXJlbnQgcmVjb3JkIGFuZCBgL3Bvc3RzLzEvY29tbWVudHNgLgoKICAg
        IEl0IHdpbGwgbWFrZSBhbiBBamF4IHJlcXVlc3QgdG8gdGhlIG9yaWdpbmFs
        bHkgc3BlY2lmaWVkIFVSTC4KCiAgICBAbWV0aG9kIGZpbmRIYXNNYW55CiAg
        ICBAc2VlIFJFU1RBZGFwdGVyL2J1aWxkVVJMCiAgICBAc2VlIFJFU1RBZGFw
        dGVyL2FqYXgKICAgIEBwYXJhbSB7RFMuU3RvcmV9IHN0b3JlCiAgICBAcGFy
        YW0ge0RTLk1vZGVsfSByZWNvcmQKICAgIEBwYXJhbSB7U3RyaW5nfSB1cmwK
        ICAgIEByZXR1cm5zIFByb21pc2UKICAqLwogIGZpbmRIYXNNYW55OiBmdW5j
        dGlvbihzdG9yZSwgcmVjb3JkLCB1cmwpIHsKICAgIHJldHVybiB0aGlzLmFq
        YXgodXJsLCAnR0VUJyk7CiAgfSwKCiAgLyoqCiAgICBDYWxsZWQgYnkgdGhl
        IHN0b3JlIHdoZW4gYSBuZXdseSBjcmVhdGVkIHJlY29yZCBpcwogICAgYHNh
        dmVgZC4KCiAgICBJdCBzZXJpYWxpemVzIHRoZSByZWNvcmQsIGFuZCBgUE9T
        VGBzIGl0IHRvIGEgVVJMIGdlbmVyYXRlZCBieSBgYnVpbGRVUkxgLgoKICAg
        IFNlZSBgc2VyaWFsaXplYCBmb3IgaW5mb3JtYXRpb24gb24gaG93IHRvIGN1
        c3RvbWl6ZSB0aGUgc2VyaWFsaXplZCBmb3JtCiAgICBvZiBhIHJlY29yZC4K
        CiAgICBAbWV0aG9kIGNyZWF0ZVJlY29yZAogICAgQHNlZSBSRVNUQWRhcHRl
        ci9idWlsZFVSTAogICAgQHNlZSBSRVNUQWRhcHRlci9hamF4CiAgICBAc2Vl
        IFJFU1RBZGFwdGVyL3NlcmlhbGl6ZQogICAgQHBhcmFtIHtEUy5TdG9yZX0g
        c3RvcmUKICAgIEBwYXJhbSB7c3ViY2xhc3Mgb2YgRFMuTW9kZWx9IHR5cGUK
        ICAgIEBwYXJhbSB7RFMuTW9kZWx9IHJlY29yZAogICAgQHJldHVybnMgUHJv
        bWlzZQogICovCiAgY3JlYXRlUmVjb3JkOiBmdW5jdGlvbihzdG9yZSwgdHlw
        ZSwgcmVjb3JkKSB7CiAgICB2YXIgZGF0YSA9IHt9OwogICAgZGF0YVt0eXBl
        LnR5cGVLZXldID0gdGhpcy5zZXJpYWxpemVyRm9yKHR5cGUudHlwZUtleSku
        c2VyaWFsaXplKHJlY29yZCwgeyBpbmNsdWRlSWQ6IHRydWUgfSk7CgogICAg
        cmV0dXJuIHRoaXMuYWpheCh0aGlzLmJ1aWxkVVJMKHR5cGUpLCAiUE9TVCIs
        IHsgZGF0YTogZGF0YSB9KTsKICB9LAoKICAvKioKICAgIENhbGxlZCBieSB0
        aGUgc3RvcmUgd2hlbiBhbiBleGlzdGluZyByZWNvcmQgaXMgYHNhdmVgZC4K
        CiAgICBJdCBzZXJpYWxpemVzIHRoZSByZWNvcmQsIGFuZCBgUE9TVGBzIGl0
        IHRvIGEgVVJMIGdlbmVyYXRlZCBieSBgYnVpbGRVUkxgLgoKICAgIFNlZSBg
        c2VyaWFsaXplYCBmb3IgaW5mb3JtYXRpb24gb24gaG93IHRvIGN1c3RvbWl6
        ZSB0aGUgc2VyaWFsaXplZCBmb3JtCiAgICBvZiBhIHJlY29yZC4KCiAgICBA
        bWV0aG9kIHVwZGF0ZVJlY29yZAogICAgQHNlZSBSRVNUQWRhcHRlci9idWls
        ZFVSTAogICAgQHNlZSBSRVNUQWRhcHRlci9hamF4CiAgICBAc2VlIFJFU1RB
        ZGFwdGVyL3NlcmlhbGl6ZQogICAgQHBhcmFtIHtEUy5TdG9yZX0gc3RvcmUK
        ICAgIEBwYXJhbSB7c3ViY2xhc3Mgb2YgRFMuTW9kZWx9IHR5cGUKICAgIEBw
        YXJhbSB7RFMuTW9kZWx9IHJlY29yZAogICAgQHJldHVybnMgUHJvbWlzZQog
        ICovCiAgdXBkYXRlUmVjb3JkOiBmdW5jdGlvbihzdG9yZSwgdHlwZSwgcmVj
        b3JkKSB7CiAgICB2YXIgZGF0YSA9IHt9OwogICAgZGF0YVt0eXBlLnR5cGVL
        ZXldID0gdGhpcy5zZXJpYWxpemVyRm9yKHR5cGUudHlwZUtleSkuc2VyaWFs
        aXplKHJlY29yZCk7CgogICAgdmFyIGlkID0gZ2V0KHJlY29yZCwgJ2lkJyk7
        CgogICAgcmV0dXJuIHRoaXMuYWpheCh0aGlzLmJ1aWxkVVJMKHR5cGUsIGlk
        KSwgIlBVVCIsIHsgZGF0YTogZGF0YSB9KTsKICB9LAoKICAvKioKICAgIENh
        bGxlZCBieSB0aGUgc3RvcmUgd2hlbiBhbiBkZWxldGVkIHJlY29yZCBpcyBg
        c2F2ZWBkLgoKICAgIEl0IHNlcmlhbGl6ZXMgdGhlIHJlY29yZCwgYW5kIGBQ
        T1NUYHMgaXQgdG8gYSBVUkwgZ2VuZXJhdGVkIGJ5IGBidWlsZFVSTGAuCgog
        ICAgQG1ldGhvZCBkZWxldGVSZWNvcmQKICAgIEBzZWUgUkVTVEFkYXB0ZXIv
        YnVpbGRVUkwKICAgIEBzZWUgUkVTVEFkYXB0ZXIvYWpheAogICAgQHNlZSBS
        RVNUQWRhcHRlci9zZXJpYWxpemUKICAgIEBwYXJhbSB7RFMuU3RvcmV9IHN0
        b3JlCiAgICBAcGFyYW0ge3N1YmNsYXNzIG9mIERTLk1vZGVsfSB0eXBlCiAg
        ICBAcGFyYW0ge0RTLk1vZGVsfSByZWNvcmQKICAgIEByZXR1cm5zIFByb21p
        c2UKICAqLwogIGRlbGV0ZVJlY29yZDogZnVuY3Rpb24oc3RvcmUsIHR5cGUs
        IHJlY29yZCkgewogICAgdmFyIGlkID0gZ2V0KHJlY29yZCwgJ2lkJyk7Cgog
        ICAgcmV0dXJuIHRoaXMuYWpheCh0aGlzLmJ1aWxkVVJMKHR5cGUsIGlkKSwg
        IkRFTEVURSIpOwogIH0sCgogIC8qKgogICAgQnVpbGRzIGEgVVJMIGZvciBh
        IGdpdmVuIHR5cGUgYW5kIG9wdGlvbmFsIElELgoKICAgIEJ5IGRlZmF1bHQs
        IGl0IHBsdXJhbGl6ZXMgdGhlIHR5cGUncyBuYW1lIChmb3IgZXhhbXBsZSwK
        ICAgICdwb3N0JyBiZWNvbWVzICdwb3N0cycgYW5kICdwZXJzb24nIGJlY29t
        ZXMgJ3Blb3BsZScpLgoKICAgIElmIGFuIElEIGlzIHNwZWNpZmllZCwgaXQg
        YWRkcyB0aGUgSUQgdG8gdGhlIHBsdXJhbCBmb3JtCiAgICBvZiB0aGUgdHlw
        ZSwgc2VwYXJhdGVkIGJ5IGEgYC9gLgoKICAgIEBtZXRob2QgYnVpbGRVUkwK
        ICAgIEBwYXJhbSB7c3ViY2xhc3Mgb2YgRFMuTW9kZWx9IHR5cGUKICAgIEBw
        YXJhbSB7U3RyaW5nfSBpZAogICAgQHJldHVybnMgU3RyaW5nCiAgKi8KICBi
        dWlsZFVSTDogZnVuY3Rpb24odHlwZSwgaWQpIHsKICAgIHZhciB1cmwgPSAi
        LyIgKyBFbWJlci5TdHJpbmcucGx1cmFsaXplKHR5cGUudHlwZUtleSk7CiAg
        ICBpZiAoaWQpIHsgdXJsICs9ICIvIiArIGlkOyB9CgogICAgcmV0dXJuIHVy
        bDsKICB9LAoKICBzZXJpYWxpemVyRm9yOiBmdW5jdGlvbih0eXBlKSB7CiAg
        ICAvLyBUaGlzIGxvZ2ljIGhhcyB0byBiZSBrZXB0IGluIHN5bmMgd2l0aCBE
        Uy5TdG9yZSNzZXJpYWxpemVyRm9yCiAgICByZXR1cm4gdGhpcy5jb250YWlu
        ZXIubG9va3VwKCdzZXJpYWxpemVyOicgKyB0eXBlKSB8fAogICAgICAgICAg
        IHRoaXMuY29udGFpbmVyLmxvb2t1cCgnc2VyaWFsaXplcjphcHBsaWNhdGlv
        bicpIHx8CiAgICAgICAgICAgdGhpcy5jb250YWluZXIubG9va3VwKCdzZXJp
        YWxpemVyOl9yZXN0Jyk7CiAgfSwKCgogIC8qKgogICAgVGFrZXMgYSBVUkws
        IGFuIEhUVFAgbWV0aG9kIGFuZCBhIGhhc2ggb2YgZGF0YSwgYW5kIG1ha2Vz
        IGFuCiAgICBIVFRQIHJlcXVlc3QuCgogICAgV2hlbiB0aGUgc2VydmVyIHJl
        c3BvbmRzIHdpdGggYSBwYXlsb2FkLCBFbWJlciBEYXRhIHdpbGwgY2FsbCBp
        bnRvIGBleHRyYWN0U2luZ2xlYAogICAgb3IgYGV4dHJhY3RBcnJheWAgKGRl
        cGVuZGluZyBvbiB3aGV0aGVyIHRoZSBvcmlnaW5hbCBxdWVyeSB3YXMgZm9y
        IG9uZSByZWNvcmQgb3IKICAgIG1hbnkgcmVjb3JkcykuCgogICAgQnkgZGVm
        YXVsdCwgaXQgaGFzIHRoZSBmb2xsb3dpbmcgYmVoYXZpb3I6CgogICAgKiBJ
        dCBzZXRzIHRoZSByZXNwb25zZSBgZGF0YVR5cGVgIHRvIGAianNvbiJgCiAg
        ICAqIElmIHRoZSBIVFRQIG1ldGhvZCBpcyBub3QgYCJHRVQiYCwgaXQgc2V0
        cyB0aGUgYENvbnRlbnQtVHlwZWAgdG8gYmUKICAgICAgYGFwcGxpY2F0aW9u
        L2pzb247IGNoYXJzZXQ9dXRmLThgCiAgICAqIElmIHRoZSBIVFRQIG1ldGhv
        ZCBpcyBub3QgYCJHRVQiYCwgaXQgc3RyaW5naWZpZXMgdGhlIGRhdGEgcGFz
        c2VkIGluLiBUaGUKICAgICAgZGF0YSBpcyB0aGUgc2VyaWFsaXplZCByZWNv
        cmQgaW4gdGhlIGNhc2Ugb2YgYSBzYXZlLgogICAgKiBSZWdpc3RlcnMgc3Vj
        Y2VzcyBhbmQgZmFpbHVyZSBoYW5kbGVycy4KCiAgICBAbWV0aG9kIGFqYXgK
        ICAgIEBwcml2YXRlCiAgICBAcGFyYW0gIHVybAogICAgQHBhcmFtICB0eXBl
        CiAgICBAcGFyYW0gIGhhc2gKICAqLwogIGFqYXg6IGZ1bmN0aW9uKHVybCwg
        dHlwZSwgaGFzaCkgewogICAgdmFyIGFkYXB0ZXIgPSB0aGlzOwoKICAgIHJl
        dHVybiBuZXcgRW1iZXIuUlNWUC5Qcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUs
        IHJlamVjdCkgewogICAgICBoYXNoID0gaGFzaCB8fCB7fTsKICAgICAgaGFz
        aC51cmwgPSB1cmw7CiAgICAgIGhhc2gudHlwZSA9IHR5cGU7CiAgICAgIGhh
        c2guZGF0YVR5cGUgPSAnanNvbic7CiAgICAgIGhhc2guY29udGV4dCA9IGFk
        YXB0ZXI7CgogICAgICBpZiAoaGFzaC5kYXRhICYmIHR5cGUgIT09ICdHRVQn
        KSB7CiAgICAgICAgaGFzaC5jb250ZW50VHlwZSA9ICdhcHBsaWNhdGlvbi9q
        c29uOyBjaGFyc2V0PXV0Zi04JzsKICAgICAgICBoYXNoLmRhdGEgPSBKU09O
        LnN0cmluZ2lmeShoYXNoLmRhdGEpOwogICAgICB9CgogICAgICBpZiAoYWRh
        cHRlci5oZWFkZXJzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB2YXIgaGVh
        ZGVycyA9IGFkYXB0ZXIuaGVhZGVyczsKICAgICAgICBoYXNoLmJlZm9yZVNl
        bmQgPSBmdW5jdGlvbiAoeGhyKSB7CiAgICAgICAgICBFbWJlci5rZXlzKGhl
        YWRlcnMpLmZvckVhY2goZnVuY3Rpb24oa2V5KSB7CiAgICAgICAgICAgIHho
        ci5zZXRSZXF1ZXN0SGVhZGVyKGtleSwgaGVhZGVyc1trZXldKTsKICAgICAg
        ICAgIH0pOwogICAgICAgIH07CiAgICAgIH0KCiAgICAgIGhhc2guc3VjY2Vz
        cyA9IGZ1bmN0aW9uKGpzb24pIHsKICAgICAgICBFbWJlci5ydW4obnVsbCwg
        cmVzb2x2ZSwganNvbik7CiAgICAgIH07CgogICAgICBoYXNoLmVycm9yID0g
        ZnVuY3Rpb24oanFYSFIsIHRleHRTdGF0dXMsIGVycm9yVGhyb3duKSB7CiAg
        ICAgICAgaWYgKGpxWEhSKSB7CiAgICAgICAgICBqcVhIUi50aGVuID0gbnVs
        bDsKICAgICAgICB9CgogICAgICAgIEVtYmVyLnJ1bihudWxsLCByZWplY3Qs
        IGpxWEhSKTsKICAgICAgfTsKCiAgICAgIEVtYmVyLiQuYWpheChoYXNoKTsK
        ICAgIH0pOwogIH0KCn0pOwoKfSkoKTsKCgoKKGZ1bmN0aW9uKCkgewovKioK
        ICBAbW9kdWxlIGVtYmVyLWRhdGEKKi8KCn0pKCk7CgoKCihmdW5jdGlvbigp
        IHsKRFMuTW9kZWwucmVvcGVuKHsKCiAgLyoqCiAgIFByb3ZpZGVzIGluZm8g
        YWJvdXQgdGhlIG1vZGVsIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXMKICAgYnkg
        Z3JvdXBpbmcgdGhlIHByb3BlcnRpZXMgaW50byBtb3JlIHNlbWFudGljIGdy
        b3Vwcy4KCiAgIE1lYW50IHRvIGJlIHVzZWQgYnkgZGVidWdnaW5nIHRvb2xz
        IHN1Y2ggYXMgdGhlIENocm9tZSBFbWJlciBFeHRlbnNpb24uCgogICAtIEdy
        b3VwcyBhbGwgYXR0cmlidXRlcyBpbiAiQXR0cmlidXRlcyIgZ3JvdXAuCiAg
        IC0gR3JvdXBzIGFsbCBiZWxvbmdzVG8gcmVsYXRpb25zaGlwcyBpbiAiQmVs
        b25ncyBUbyIgZ3JvdXAuCiAgIC0gR3JvdXBzIGFsbCBoYXNNYW55IHJlbGF0
        aW9uc2hpcHMgaW4gIkhhcyBNYW55IiBncm91cC4KICAgLSBHcm91cHMgYWxs
        IGZsYWdzIGluICJGbGFncyIgZ3JvdXAuCiAgIC0gRmxhZ3MgcmVsYXRpb25z
        aGlwIENQcyBhcyBleHBlbnNpdmUgcHJvcGVydGllcy4KICAqLwogIF9kZWJ1
        Z0luZm86IGZ1bmN0aW9uKCkgewogICAgdmFyIGF0dHJpYnV0ZXMgPSBbJ2lk
        J10sCiAgICAgICAgcmVsYXRpb25zaGlwcyA9IHsgYmVsb25nc1RvOiBbXSwg
        aGFzTWFueTogW10gfSwKICAgICAgICBleHBlbnNpdmVQcm9wZXJ0aWVzID0g
        W107CgogICAgdGhpcy5lYWNoQXR0cmlidXRlKGZ1bmN0aW9uKG5hbWUsIG1l
        dGEpIHsKICAgICAgYXR0cmlidXRlcy5wdXNoKG5hbWUpOwogICAgfSwgdGhp
        cyk7CgogICAgdGhpcy5lYWNoUmVsYXRpb25zaGlwKGZ1bmN0aW9uKG5hbWUs
        IHJlbGF0aW9uc2hpcCkgewogICAgICByZWxhdGlvbnNoaXBzW3JlbGF0aW9u
        c2hpcC5raW5kXS5wdXNoKG5hbWUpOwogICAgICBleHBlbnNpdmVQcm9wZXJ0
        aWVzLnB1c2gobmFtZSk7CiAgICB9KTsKCiAgICB2YXIgZ3JvdXBzID0gWwog
        ICAgICB7CiAgICAgICAgbmFtZTogJ0F0dHJpYnV0ZXMnLAogICAgICAgIHBy
        b3BlcnRpZXM6IGF0dHJpYnV0ZXMsCiAgICAgICAgZXhwYW5kOiB0cnVlLAog
        ICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogJ0JlbG9uZ3MgVG8nLAog
        ICAgICAgIHByb3BlcnRpZXM6IHJlbGF0aW9uc2hpcHMuYmVsb25nc1RvLAog
        ICAgICAgIGV4cGFuZDogdHJ1ZQogICAgICB9LAogICAgICB7CiAgICAgICAg
        bmFtZTogJ0hhcyBNYW55JywKICAgICAgICBwcm9wZXJ0aWVzOiByZWxhdGlv
        bnNoaXBzLmhhc01hbnksCiAgICAgICAgZXhwYW5kOiB0cnVlCiAgICAgIH0s
        CiAgICAgIHsKICAgICAgICBuYW1lOiAnRmxhZ3MnLAogICAgICAgIHByb3Bl
        cnRpZXM6IFsnaXNMb2FkZWQnLCAnaXNEaXJ0eScsICdpc1NhdmluZycsICdp
        c0RlbGV0ZWQnLCAnaXNFcnJvcicsICdpc05ldycsICdpc1ZhbGlkJ10KICAg
        ICAgfQogICAgXTsKCiAgICByZXR1cm4gewogICAgICBwcm9wZXJ0eUluZm86
        IHsKICAgICAgICAvLyBpbmNsdWRlIGFsbCBvdGhlciBtaXhpbnMgLyBwcm9w
        ZXJ0aWVzIChub3QganVzdCB0aGUgZ3JvdXBlZCBvbmVzKQogICAgICAgIGlu
        Y2x1ZGVPdGhlclByb3BlcnRpZXM6IHRydWUsCiAgICAgICAgZ3JvdXBzOiBn
        cm91cHMsCiAgICAgICAgLy8gZG9uJ3QgcHJlLWNhbGN1bGF0ZSB1bmxlc3Mg
        Y2FjaGVkCiAgICAgICAgZXhwZW5zaXZlUHJvcGVydGllczogZXhwZW5zaXZl
        UHJvcGVydGllcwogICAgICB9CiAgICB9OwogIH0KCn0pOwoKfSkoKTsKCgoK
        KGZ1bmN0aW9uKCkgewovKioKICBAbW9kdWxlIGVtYmVyLWRhdGEKKi8KCn0p
        KCk7CgoKCihmdW5jdGlvbigpIHsKLy9Db3B5cmlnaHQgKEMpIDIwMTEgYnkg
        TGl2aW5nIFNvY2lhbCwgSW5jLgoKLy9QZXJtaXNzaW9uIGlzIGhlcmVieSBn
        cmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5p
        bmcgYSBjb3B5IG9mCi8vdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBk
        b2N1bWVudGF0aW9uIGZpbGVzICh0aGUgIlNvZnR3YXJlIiksIHRvIGRlYWwg
        aW4KLy90aGUgU29mdHdhcmUgd2l0aG91dCByZXN0cmljdGlvbiwgaW5jbHVk
        aW5nIHdpdGhvdXQgbGltaXRhdGlvbiB0aGUgcmlnaHRzIHRvCi8vdXNlLCBj
        b3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJs
        aWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMKLy9vZiB0aGUgU29mdHdhcmUs
        IGFuZCB0byBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBp
        cyBmdXJuaXNoZWQgdG8gZG8KLy9zbywgc3ViamVjdCB0byB0aGUgZm9sbG93
        aW5nIGNvbmRpdGlvbnM6CgovL1RoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNl
        IGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlIGluY2x1ZGVk
        IGluIGFsbAovL2NvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0
        aGUgU29mdHdhcmUuCgovL1RIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMg
        SVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9S
        Ci8vSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUg
        V0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFksCi8vRklUTkVTUyBGT1Ig
        QSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4gSU4g
        Tk8gRVZFTlQgU0hBTEwgVEhFCi8vQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9M
        REVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhF
        UgovL0xJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJB
        Q1QsIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sCi8vT1VUIE9G
        IE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgU09GVFdBUkUgT1IgVEhFIFVT
        RSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUKLy9TT0ZUV0FSRS4KCi8qKgog
        IEVtYmVyIERhdGEKCiAgQG1vZHVsZSBlbWJlci1kYXRhCiAgQG1haW4gZW1i
        ZXItZGF0YQoqLwoKfSkoKTsKCg==
    http_version: 
  recorded_at: Thu, 31 Oct 2013 20:27:17 GMT
- request:
    method: get
    uri: http://builds.emberjs.com/tags/v1.0.0-beta.1/ember-data.min.js
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
  response:
    status:
      code: 200
      message: OK
    headers:
      X-Amz-Id-2:
      - 0/FFNNx15epn9lshCRvlZeANjBy9W7CpQxhj8bW0+IU8nJ2sua5cPYcQykzvDv1O
      X-Amz-Request-Id:
      - 87F638D65B0B3E93
      Date:
      - Thu, 31 Oct 2013 20:27:20 GMT
      Last-Modified:
      - Sun, 01 Sep 2013 07:45:27 GMT
      Etag:
      - '"7066a174c8ef121fbcc734c19087d271"'
      Content-Type:
      - text/javascript
      Content-Length:
      - '4008'
      Server:
      - AmazonS3
    body:
      encoding: ASCII-8BIT
      string: !binary |-
        Ly8gPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
        PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KLy8gUHJvamVjdDog
        ICBFbWJlciBEYXRhCi8vIENvcHlyaWdodDogwqkyMDExLTIwMTIgVGlsZGUg
        SW5jLiBhbmQgY29udHJpYnV0b3JzLgovLyAgICAgICAgICAgIFBvcnRpb25z
        IMKpMjAxMSBMaXZpbmcgU29jaWFsIEluYy4gYW5kIGNvbnRyaWJ1dG9ycy4K
        Ly8gTGljZW5zZTogICBMaWNlbnNlZCB1bmRlciBNSVQgbGljZW5zZSAoc2Vl
        IGxpY2Vuc2UuanMpCi8vID09PT09PT09PT09PT09PT09PT09PT09PT09PT09
        PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
        CgoKCi8vIFZlcnNpb246IHYxLjAuMC1iZXRhLjEKLy8gTGFzdCBjb21taXQ6
        IGNhZmFiOWQgKDIwMTMtMDktMDEgMDA6NDI6MzkgLTA3MDApCgoKIWZ1bmN0
        aW9uKCl7dmFyIGUsaTshZnVuY3Rpb24oKXt2YXIgcj17fSxzPXt9O2U9ZnVu
        Y3Rpb24oZSxpLHMpe3JbZV09e2RlcHM6aSxjYWxsYmFjazpzfX0saT1mdW5j
        dGlvbihlKXtpZihzW2VdKXJldHVybiBzW2VdO3NbZV09e307dmFyIG4sdCx1
        LG8sYTtpZihuPXJbZV0sIW4pdGhyb3cgbmV3IEVycm9yKCJNb2R1bGUgJyIr
        ZSsiJyBub3QgZm91bmQuIik7dD1uLmRlcHMsdT1uLmNhbGxiYWNrLG89W107
        Zm9yKHZhciBsPTAsJD10Lmxlbmd0aDskPmw7bCsrKSJleHBvcnRzIj09PXRb
        bF0/by5wdXNoKGE9e30pOm8ucHVzaChpKHRbbF0pKTt2YXIgYz11LmFwcGx5
        KHRoaXMsbyk7cmV0dXJuIHNbZV09YXx8Y319KCksZnVuY3Rpb24oKXtFbWJl
        ci5TdHJpbmcucGx1cmFsaXplPWZ1bmN0aW9uKGUpe3JldHVybiBFbWJlci5J
        bmZsZWN0b3IuaW5mbGVjdG9yLnBsdXJhbGl6ZShlKX0sRW1iZXIuU3RyaW5n
        LnNpbmd1bGFyaXplPWZ1bmN0aW9uKGUpe3JldHVybiBFbWJlci5JbmZsZWN0
        b3IuaW5mbGVjdG9yLnNpbmd1bGFyaXplKGUpfX0oKSxmdW5jdGlvbigpe2Z1
        bmN0aW9uIGUoZSxpKXtmb3IodmFyIHI9MCxzPWkubGVuZ3RoO3M+cjtyKysp
        ZS51bmNvdW50YWJsZVtpW3JdXT0hMH1mdW5jdGlvbiBpKGUsaSl7Zm9yKHZh
        ciByLHM9MCxuPWkubGVuZ3RoO24+cztzKyspcj1pW3NdLGUuaXJyZWd1bGFy
        W3JbMF1dPXJbMV0sZS5pcnJlZ3VsYXJJbnZlcnNlW3JbMV1dPXJbMF19ZnVu
        Y3Rpb24gcihyKXtyPXJ8fHt9LHIudW5jb3VudGFibGU9ci51bmNvdW50YWJs
        ZXx8e30sci5pcnJlZ3VsYXJQYWlycz1yLmlycmVndWxhclBhaXJzfHx7fTt2
        YXIgcz10aGlzLnJ1bGVzPXtwbHVyYWxzOnIucGx1cmFsc3x8W10sc2luZ3Vs
        YXI6ci5zaW5ndWxhcnx8W10saXJyZWd1bGFyOnt9LGlycmVndWxhckludmVy
        c2U6e30sdW5jb3VudGFibGU6e319O2UocyxyLnVuY291bnRhYmxlKSxpKHMs
        ci5pcnJlZ3VsYXJQYWlycyl9dmFyIHM9L15ccyokLztyLnByb3RvdHlwZT17
        cGx1cmFsaXplOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmluZmxlY3QoZSx0
        aGlzLnJ1bGVzLnBsdXJhbHMpfSxzaW5ndWxhcml6ZTpmdW5jdGlvbihlKXty
        ZXR1cm4gdGhpcy5pbmZsZWN0KGUsdGhpcy5ydWxlcy5zaW5ndWxhcil9LGlu
        ZmxlY3Q6ZnVuY3Rpb24oZSxpKXt2YXIgcixuLHQsdSxvLGEsbCwkLGM7aWYo
        bz1zLnRlc3QoZSkpcmV0dXJuIGU7aWYodT1lLnRvTG93ZXJDYXNlKCksYT10
        aGlzLnJ1bGVzLnVuY291bnRhYmxlW3VdKXJldHVybiBlO2lmKGw9dGhpcy5y
        dWxlcy5pcnJlZ3VsYXJbdV0pcmV0dXJuIGw7aWYoJD10aGlzLnJ1bGVzLmly
        cmVndWxhckludmVyc2VbdV0pcmV0dXJuICQ7Zm9yKHZhciBmPWkubGVuZ3Ro
        LHA9MDtmPnAmJihyPWlbZi0xXSxjPXJbMF0sIWMudGVzdChlKSk7Zi0tKTty
        ZXR1cm4gcj1yfHxbXSxjPXJbMF0sbj1yWzFdLHQ9ZS5yZXBsYWNlKGMsbil9
        fSxFbWJlci5JbmZsZWN0b3I9cn0oKSxmdW5jdGlvbigpe0VtYmVyLkluZmxl
        Y3Rvci5kZWZhdWx0UnVsZXM9e3BsdXJhbHM6W1svJC8sInMiXSxbL3MkL2ks
        InMiXSxbL14oYXh8dGVzdClpcyQvaSwiJDFlcyJdLFsvKG9jdG9wfHZpcil1
        cyQvaSwiJDFpIl0sWy8ob2N0b3B8dmlyKWkkL2ksIiQxaSJdLFsvKGFsaWFz
        fHN0YXR1cykkL2ksIiQxZXMiXSxbLyhidSlzJC9pLCIkMXNlcyJdLFsvKGJ1
        ZmZhbHx0b21hdClvJC9pLCIkMW9lcyJdLFsvKFt0aV0pdW0kL2ksIiQxYSJd
        LFsvKFt0aV0pYSQvaSwiJDFhIl0sWy9zaXMkL2ksInNlcyJdLFsvKD86KFte
        Zl0pZmV8KFtscl0pZikkL2ksIiQxJDJ2ZXMiXSxbLyhoaXZlKSQvaSwiJDFz
        Il0sWy8oW15hZWlvdXldfHF1KXkkL2ksIiQxaWVzIl0sWy8oeHxjaHxzc3xz
        aCkkL2ksIiQxZXMiXSxbLyhtYXRyfHZlcnR8aW5kKSg/Oml4fGV4KSQvaSwi
        JDFpY2VzIl0sWy9eKG18bClvdXNlJC9pLCIkMWljZSJdLFsvXihtfGwpaWNl
        JC9pLCIkMWljZSJdLFsvXihveCkkL2ksIiQxZW4iXSxbL14ob3hlbikkL2ks
        IiQxIl0sWy8ocXVpeikkL2ksIiQxemVzIl1dLHNpbmd1bGFyOltbL3MkL2ks
        IiJdLFsvKHNzKSQvaSwiJDEiXSxbLyhuKWV3cyQvaSwiJDFld3MiXSxbLyhb
        dGldKWEkL2ksIiQxdW0iXSxbLygoYSluYWx5fChiKWF8KGQpaWFnbm98KHAp
        YXJlbnRoZXwocClyb2dub3wocyl5bm9wfCh0KWhlKShzaXN8c2VzKSQvaSwi
        JDFzaXMiXSxbLyheYW5hbHkpKHNpc3xzZXMpJC9pLCIkMXNpcyJdLFsvKFte
        Zl0pdmVzJC9pLCIkMWZlIl0sWy8oaGl2ZSlzJC9pLCIkMSJdLFsvKHRpdmUp
        cyQvaSwiJDEiXSxbLyhbbHJdKXZlcyQvaSwiJDFmIl0sWy8oW15hZWlvdXld
        fHF1KWllcyQvaSwiJDF5Il0sWy8ocyllcmllcyQvaSwiJDFlcmllcyJdLFsv
        KG0pb3ZpZXMkL2ksIiQxb3ZpZSJdLFsvKHh8Y2h8c3N8c2gpZXMkL2ksIiQx
        Il0sWy9eKG18bClpY2UkL2ksIiQxb3VzZSJdLFsvKGJ1cykoZXMpPyQvaSwi
        JDEiXSxbLyhvKWVzJC9pLCIkMSJdLFsvKHNob2UpcyQvaSwiJDEiXSxbLyhj
        cmlzfHRlc3QpKGlzfGVzKSQvaSwiJDFpcyJdLFsvXihhKXhbaWVdcyQvaSwi
        JDF4aXMiXSxbLyhvY3RvcHx2aXIpKHVzfGkpJC9pLCIkMXVzIl0sWy8oYWxp
        YXN8c3RhdHVzKShlcyk/JC9pLCIkMSJdLFsvXihveCllbi9pLCIkMSJdLFsv
        KHZlcnR8aW5kKWljZXMkL2ksIiQxZXgiXSxbLyhtYXRyKWljZXMkL2ksIiQx
        aXgiXSxbLyhxdWl6KXplcyQvaSwiJDEiXSxbLyhkYXRhYmFzZSlzJC9pLCIk
        MSJdXSxpcnJlZ3VsYXJQYWlyczpbWyJwZXJzb24iLCJwZW9wbGUiXSxbIm1h
        biIsIm1lbiJdLFsiY2hpbGQiLCJjaGlsZHJlbiJdLFsic2V4Iiwic2V4ZXMi
        XSxbIm1vdmUiLCJtb3ZlcyJdLFsiY293Iiwia2luZSJdLFsiem9tYmllIiwi
        em9tYmllcyJdXSx1bmNvdW50YWJsZTpbImVxdWlwbWVudCIsImluZm9ybWF0
        aW9uIiwicmljZSIsIm1vbmV5Iiwic3BlY2llcyIsInNlcmllcyIsImZpc2gi
        LCJzaGVlcCIsImplYW5zIiwicG9saWNlIl19fSgpLGZ1bmN0aW9uKCl7RW1i
        ZXIuRVhURU5EX1BST1RPVFlQRVMmJihTdHJpbmcucHJvdG90eXBlLnBsdXJh
        bGl6ZT1mdW5jdGlvbigpe3JldHVybiBFbWJlci5TdHJpbmcucGx1cmFsaXpl
        KHRoaXMpfSxTdHJpbmcucHJvdG90eXBlLnNpbmd1bGFyaXplPWZ1bmN0aW9u
        KCl7cmV0dXJuIEVtYmVyLlN0cmluZy5zaW5ndWxhcml6ZSh0aGlzKX0pfSgp
        LGZ1bmN0aW9uKCl7RW1iZXIuSW5mbGVjdG9yLmluZmxlY3Rvcj1uZXcgRW1i
        ZXIuSW5mbGVjdG9yKEVtYmVyLkluZmxlY3Rvci5kZWZhdWx0UnVsZXMpfSgp
        fSgpLCJ1bmRlZmluZWQiPT10eXBlb2YgbG9jYXRpb258fCJsb2NhbGhvc3Qi
        IT09bG9jYXRpb24uaG9zdG5hbWUmJiIxMjcuMC4wLjEiIT09bG9jYXRpb24u
        aG9zdG5hbWV8fEVtYmVyLkxvZ2dlci53YXJuKCJZb3UgYXJlIHJ1bm5pbmcg
        YSBwcm9kdWN0aW9uIGJ1aWxkIG9mIEVtYmVyIG9uIGxvY2FsaG9zdCBhbmQg
        d29uJ3QgcmVjZWl2ZSBkZXRhaWxlZCBlcnJvciBtZXNzYWdlcy4gSWYgeW91
        IHdhbnQgZnVsbCBlcnJvciBtZXNzYWdlcyBwbGVhc2UgdXNlIHRoZSBub24t
        bWluaWZpZWQgYnVpbGQgcHJvdmlkZWQgb24gdGhlIEVtYmVyIHdlYnNpdGUu
        Iik7
    http_version: 
  recorded_at: Thu, 31 Oct 2013 20:27:18 GMT
- request:
    method: head
    uri: http://builds.emberjs.com/tags/v1.0.0-beta.1/ember-data.debug.js
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
  response:
    status:
      code: 404
      message: Not Found
    headers:
      X-Amz-Error-Code:
      - NoSuchKey
      X-Amz-Error-Message:
      - The specified key does not exist.
      X-Amz-Error-Detail-Key:
      - tags/v1.0.0-beta.1/ember-data.debug.js
      X-Amz-Request-Id:
      - E3ADE66E14296789
      X-Amz-Id-2:
      - kQjBchdyhKd3eb02XAm+ESStHY6mYMcvKa+0BCRXkb6DsW9tgPeM82d0ft3Fg6aJBI+zHKELlVY=
      Transfer-Encoding:
      - chunked
      Date:
      - Sat, 25 Apr 2015 07:28:40 GMT
      Server:
      - AmazonS3
    body:
      encoding: UTF-8
      string: ''
    http_version: 
  recorded_at: Sat, 25 Apr 2015 07:28:41 GMT
- request:
    method: head
    uri: http://builds.emberjs.com/tags/v1.0.0-beta.1/ember-data.js.map
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
  response:
    status:
      code: 404
      message: Not Found
    headers:
      X-Amz-Error-Code:
      - NoSuchKey
      X-Amz-Error-Message:
      - The specified key does not exist.
      X-Amz-Error-Detail-Key:
      - tags/v1.0.0-beta.1/ember-data.js.map
      X-Amz-Request-Id:
      - 0C78D313F6D78DB8
      X-Amz-Id-2:
      - xdfU2tiQIv51CA0riaAfHA4tqWY5JaRJUxMF0/TlVts8+leKr3J7+CmChbUFZPiqEdZOzB1SFeY=
      Transfer-Encoding:
      - chunked
      Date:
      - Sat, 25 Apr 2015 07:28:41 GMT
      Server:
      - AmazonS3
    body:
      encoding: UTF-8
      string: ''
    http_version: 
  recorded_at: Sat, 25 Apr 2015 07:28:42 GMT
- request:
    method: head
    uri: http://builds.emberjs.com/tags/v1.0.0-beta.1/ember-data.js.map
    body:
      encoding: US-ASCII
      string: ''
    headers:
      Accept:
      - "*/*"
      User-Agent:
      - Ruby
  response:
    status:
      code: 404
      message: Not Found
    headers:
      X-Amz-Error-Code:
      - NoSuchKey
      X-Amz-Error-Message:
      - The specified key does not exist.
      X-Amz-Error-Detail-Key:
      - tags/v1.0.0-beta.1/ember-data.js.map
      X-Amz-Request-Id:
      - 0D017660E0D258EB
      X-Amz-Id-2:
      - E0RkjoCI/PFjijnz9/OY1wxYJ30aZImdoI2zoHGLpV4z13ZlmMGmqnlmvkxnGejZICkmLt7qxhI=
      Transfer-Encoding:
      - chunked
      Date:
      - Sat, 25 Apr 2015 07:28:41 GMT
      Server:
      - AmazonS3
    body:
      encoding: UTF-8
      string: ''
    http_version: 
  recorded_at: Sat, 25 Apr 2015 07:28:42 GMT
recorded_with: VCR 2.9.3
